<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: November 11, 2024 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="system">
  
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.2.0" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ruslan Klymentiev" />

  
  
  
    
  
  <meta name="description" content="How to get maximum performance of your A/B test when you have any prior information about users." />

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:4321/tutorial/mab-problem/" />

  
  
  
  
    
    <link rel="stylesheet" href="/css/themes/emerald.min.css" />
  

  
  
    
    <link href="/dist/wc.min.css" rel="stylesheet" />
  

  
  
  

  
    
    <link href="/css/custom.min.15f6624443884362110ae1c63cfb1412c6924eea6b2373b4f708c498d4bf0f66.css" rel="stylesheet" />
  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  
  




































  
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu18111939623654241174.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu8230923372197676942.png" />

  <link rel="canonical" href="http://localhost:4321/tutorial/mab-problem/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="RK" />
  <meta property="og:url" content="http://localhost:4321/tutorial/mab-problem/" />
  <meta property="og:title" content="How to Deal with Multi-Armed Bandit Problem | RK" />
  <meta property="og:description" content="How to get maximum performance of your A/B test when you have any prior information about users." /><meta property="og:image" content="http://localhost:4321/tutorial/mab-problem/featured.jpg" />
    <meta property="twitter:image" content="http://localhost:4321/tutorial/mab-problem/featured.jpg" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2019-04-01T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2019-04-01T00:00:00&#43;00:00">
  

  



  


  <title>How to Deal with Multi-Armed Bandit Problem | RK</title>

  
  
  
  
  
    
    
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(/dist/font/Inter.var.woff2) format(woff2);
    }
  </style>

  

  
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  







<link type="text/css" rel="stylesheet" href="/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css" integrity="sha256-vnZutBkxehTsdp0hbpd5v&#43;jzc3yA54D0ug2vtXpBpII=" />


<script src="/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js" integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script>


<script>window.hbb.pagefind = {"baseUrl":"/"};</script>

<style>
  html.dark {
    --pagefind-ui-primary: #eeeeee;
    --pagefind-ui-text: #eeeeee;
    --pagefind-ui-background: #152028;
    --pagefind-ui-border: #152028;
    --pagefind-ui-tag: #152028;
  }
</style>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    new PagefindUI({
      element: "#search",
      showSubResults: true,
      baseUrl: window.hbb.pagefind.baseUrl,
      bundlePath: window.hbb.pagefind.baseUrl + "pagefind/",
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    let element = document.getElementById('search');
    let trigger = document.getElementById('search_toggle');

    if (trigger) {
      trigger.addEventListener('click', () => {
        element.classList.toggle('hidden');
        element.querySelector("input").value = ""
        element.querySelector("input").focus()

        if (!element.classList.contains('hidden')) {
          let clear_trigger = document.querySelector('.pagefind-ui__search-clear');

          if (clear_trigger && !clear_trigger.hasAttribute('listenerOnClick')) {
            clear_trigger.setAttribute('listenerOnClick', 'true');

            clear_trigger.addEventListener('click', () => {
              element.classList.toggle('hidden');
            });
          }
        }

      });
    }
  });
</script>










  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js" integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="/js/hugo-blox-en.min.js"
    integrity=""
  ></script>

  
  








  
    
      
      <script async defer src="https://buttons.github.io/buttons.js"></script>

      
    
  




</head>

  <body class="dark:bg-hb-dark dark:text-white page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header sticky top-0 z-30">
      
      
      
        
        
        
          <header id="site-header" class="header">
  <nav class="navbar px-3 flex justify-left">
    <div class="order-0 h-100">
      
      <a class="navbar-brand" href="/" title="RK">
        RK
      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Open Menu</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Close Menu</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left
      ">
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/"
        >Home</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/publication/"
        >Publications</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/tutorial/"
        >Tutorials</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/post/"
        >Blog</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/event/"
        >Talks</a
        >
      </li>
      
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">

      
      
      
      <button
        aria-label="search"
        class="text-black hover:text-primary  inline-block px-3 text-xl dark:text-white"
        id="search_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentColor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
      </button>
      

      
      
      <div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
            [&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white">
        <button class="theme-toggle mt-1" accesskey="t" title="appearance">
          <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class="dark:hidden">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </div>
      

      
      

      
      
    </div>
  </nav>
</header>


<div id="search" class="hidden p-3"></div>


        
      
    </div>
    <div class="page-body  my-10">
      





<div class="mx-auto flex max-w-screen-xl">
  



<aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block">
  
  <div class="px-4 pt-4 lg:hidden">
    
    
  </div>
  <div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]">
    <ul class="flex flex-col gap-1 lg:hidden">
      
      
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/"
    
  >Recent Talks
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_cben2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_ssc2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/introduction-to-python/"
    
  >Introduction to Python
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value? (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/how-to-start-career-in-data/"
    
  >How to start career in Data (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/null-hypothesis-significance-testing/"
    
  >Statistical Hypothesis Testing (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/data-visualization/"
    
  >Packages for Data Visualization (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/numpy-pandas-sympy/"
    
  >Intro to NumPy, pandas &amp; SymPy (in Russian)
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/"
    
  >Publications
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/"
    
  >Inhibiting presynaptic calcium channel motility in the auditory cortex suppresses synchronized input processing
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/"
    
  >Blog
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-i-met-my-partner-in-crime/"
    
  >How I Met My Partner In Crime
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-do-criminals-make-decisions/"
    
  >How Do Criminals Make Decisions?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/psychopathy/"
    
  >Psychopaths: the Good, the Bad, and the Crazy
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/"
    
  >Projects
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pandas/"
    
  >Pandas
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pytorch/"
    
  >PyTorch
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/scikit/"
    
  >scikit-learn
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/experience/"
    
  >Experience
    </a></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/"
    
  >Teaching
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/python_for_ds/"
    
  >Python for Data Science (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt2/"
    
  >Computational Models of Behavior, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt1/"
    
  >Computational Models of Behavior, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/pyforneuro/"
    
  >Python for Neuroscience
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bandit_cats/"
    
  >Bandit Cats and Exploration-Exploitation Trade-Off
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/eeg-preprocessing-erp/"
    
  >Intro to EEG Data Analysis
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-3/"
    
  >Null Hypothesis Significance Testing, part 3
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-2/"
    
  >Null Hypothesis Significance Testing, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/roc-curve/"
    
  >ROC Curve Simulation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-1/"
    
  >Null Hypothesis Significance Testing, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/norm-binom/"
    
  >Normal Approximation to Binomial Distribution
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/how-do-cart-models-work/"
    
  >How do CART models work
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bayes_disease/"
    
  >Bayes Rule and Disease Testing
    </a>
              
            </li><li class="flex flex-col open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/tutorial/mab-problem/"
    
  >How to Deal with Multi-Armed Bandit Problem
    </a>
  
    <ul class="hb-sidebar-mobile-toc"><li>
              <a
                href="#what-is-multi-armed-bandit-problem"
                class="hb-docs-link"
              >What is Multi-Armed Bandit Problem?</a>
            </li>
          <li>
              <a
                href="#random-selection"
                class="hb-docs-link"
              >Random Selection</a>
            </li>
          <li>
              <a
                href="#epsilon-greedy"
                class="hb-docs-link"
              >Epsilon Greedy</a>
            </li>
          <li>
              <a
                href="#thompson-sampling"
                class="hb-docs-link"
              >Thompson Sampling</a>
            </li>
          <li>
              <a
                href="#upper-confidence-bound-ucb1"
                class="hb-docs-link"
              >Upper Confidence Bound (UCB1)</a>
            </li>
          <li>
              <a
                href="#comparison-and-conclusions"
                class="hb-docs-link"
              >Comparison and Conclusions</a>
            </li>
          </ul>
  
              
            </li></ul>
      </div></li>
    </ul>

    <div class="max-xl:hidden h-0 w-64 shrink-0"></div></div>

</aside>
  

<nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents">
  











  <div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#what-is-multi-armed-bandit-problem">What is Multi-Armed Bandit Problem?</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#random-selection">Random Selection</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#epsilon-greedy">Epsilon Greedy</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#thompson-sampling">Thompson Sampling</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#upper-confidence-bound-ucb1">Upper Confidence Bound (UCB1)</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#comparison-and-conclusions">Comparison and Conclusions</a>
      </li></ul>

  
  



    












  </div>
  </nav>


  <article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12">

      

      <h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">How to Deal with Multi-Armed Bandit Problem</h1>

      <div class="mt-4 mb-16">
      <div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class="mr-1">Apr 1, 2019</span><span class="mx-1">·</span>
        
          
          
          <div class="group inline-flex items-center text-current gap-x-1.5 mx-1">
            
            
            <img src="/author/ruslan-klymentiev/avatar_hu16379050607528300314.webp" alt="Ruslan Klymentiev" class="inline-block h-4 w-4 rounded-full border border-current" loading="lazy" />
            
            <div >Ruslan Klymentiev</div>
          </div>
          
        

        
        <span class="mx-1">·</span>
        <span class="mx-1">
          18 min read
        </span>
        
        </div>

        <div class="mt-3">
          





        </div>
      </div>



      
      
      
      
      

      
      
      
      
      
      
      
      
      
      
      <div class="article-header article-container featured-image-wrapper mt-4 mb-16" style="max-width: 720px; max-height: 405px;">
        <div style="position: relative">
          <img src="/tutorial/mab-problem/featured_hu17500440193893091320.webp" width="720" height="405" alt="" class="featured-image">
          <span class="article-header-caption">Image by <a href="https://pixabay.com/users/AidanHowe-15857243/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5012428">Aidan Howe</a> from <a href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5012428">Pixabay</a></span>
        </div>
      </div>
      

      
      

      <div class="prose prose-slate lg:prose-xl dark:prose-invert">
        <p><em>by Ruslan Klymentiev and <a href="https://github.com/zankbennett" target="_blank" rel="noopener">Zank Bennett</a></em></p>
<p><em>Originally created for Bennett Data Science <a href="https://bennettdatascience.com/know-your-options-when-it-comes-to-a-b-testing/" target="_blank" rel="noopener">blog post</a>.</em></p>
<h2 id="what-is-multi-armed-bandit-problem">What is Multi-Armed Bandit Problem?</h2>
<p>This is a classic case that comes up various areas, from marketing to medical trials: How do you give a user what they want before you have a relationship with them? What about the case where you don’t even know much about the affinity for a user to an item or treatment your giving the user, as in a medical trial of several drugs or supplements?</p>
<p>We’ll show you how to approach these problems, and how a Multi-Armed Bandit with Thompson Sampling is generally the best choice. That’s a lot of words. Let’s slow down and start with something simple.</p>
<p>As an example, imagine you are running a marketing campaign for your website and have two ads to choose from. And say the objective is  to show the ad with highest click through rate (CTR) value to drive the highest traffic possible. But you don&rsquo;t have any prior information about how either of these ads will perform. What would be your approach? What about typical A/B testing? How about showing both of the ads equally, then, at some point, switching to the ad with the highest measured CTR? How long do you have to show both ads before settling on a “winner”? In these cases, it seems like guessing might be our best bet. In fact, that’s not far off!</p>
<p>There’s a method for this very problem; it’s called <strong>the multi armed bandit (MAB)</strong>.</p>
<p>There’s a lot of information explaining what <a href="https://en.wikipedia.org/wiki/Multi-armed_bandit" target="_blank" rel="noopener">the MAB algorithm</a> is, what it does and how it works, so we’ll keep it brief. Essentially, the MAB algorithm is a near-optimal method for solving the explore exploit trade-off dilemma that occurs when we don’t know whether to explore possible options to find the one with the best payoff or exploit an option that we feel is the best, from the limited exploration done so far.</p>
<p>In this tutorial we will look at different algorithms to solve the MAB problem. They all have different approaches and different Exploration vs Exploitation ratios.</p>
<p>Here, we’ll define <strong>CTR</strong> as the ratio of how many times an ad was clicked vs. the number of impressions. For example, if an ad has been shown 100 times and clicked 10 times, CTR = 10/100 = 0.1</p>
<p>We’ll define <strong>regret</strong> as the difference between the highest possible CTR and the CTR shown. For example, if ad A has a known CTR or 0.1 and ad B has a known CTR of 0.3, each time we show ad A, we have a regret equal to 0.3 - 0.1 = 0.2. This seems like a small difference until we consider that an ad may be shown 1MM times in only hours.</p>
<p>In this tutorial, we want to demonstrate which algorithm implementation performs best in terms of minimizing regret. The four implementations we’ll use are:</p>
<ol>
<li>Random Selection</li>
<li>Epsilon Greedy</li>
<li>Thompson Sampling</li>
<li>Upper Confidence Bound (UCB1)</li>
</ol>
<p>Each method will be described below in the simulations.</p>
<p>To perform this experiment, we have to assume we know the CTR’s in advance. That way, we can simulate a click (or not) of a given ad. For example, if we show ad A, with a known CTR of 28%, we can assume the ad will be clicked on 28% of the time and bake that into our simulation.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">numpy</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">np</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">pandas</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">pd</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">scipy.stats</span> <span style="color:#81c8be">import</span> beta, bernoulli
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">plotly.graph_objs</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">go</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">plotly.offline</span> <span style="color:#81c8be">import</span> init_notebook_mode, iplot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">plotly.subplots</span> <span style="color:#81c8be">import</span> make_subplots
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">random</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">8</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">math</span>
</span></span></code></pre></div><details><summary>Custom functions</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">algorithm_performance</span>(chosen_ads, total_reward, regret_list):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#a6d189">    Function that will show the performance of each algorithm we will be using in this tutorial.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    <span style="color:#737994;font-style:italic"># calculate how many time each Ad has been choosen</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    count_series <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>Series(chosen_ads)<span style="color:#99d1db;font-weight:bold">.</span>value_counts(normalize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;Ad A has been shown&#39;</span>, count_series[<span style="color:#ef9f76">0</span>]<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">100</span>, <span style="color:#a6d189">&#39;</span><span style="color:#a6d189">% o</span><span style="color:#a6d189">f the time.&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;Ad B has been shown&#39;</span>, count_series[<span style="color:#ef9f76">1</span>]<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">100</span>, <span style="color:#a6d189">&#39;</span><span style="color:#a6d189">% o</span><span style="color:#a6d189">f the time.&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;Total Reward (Number of Clicks):&#39;</span>, total_reward) <span style="color:#737994;font-style:italic"># print total Reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>arange(<span style="color:#ef9f76">0</span>, n, <span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#737994;font-style:italic"># plot the calculated CTR for Ad A</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>                       y<span style="color:#99d1db;font-weight:bold">=</span>ctr[<span style="color:#a6d189">&#39;A&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>                       name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Calculated CTR for Ad A&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>                       line<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(10, 108, 94, .7)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>                                 width<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    <span style="color:#737994;font-style:italic"># plot the line with actual CTR for Ad A</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, n],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>                       y<span style="color:#99d1db;font-weight:bold">=</span>[ACTUAL_CTR[<span style="color:#a6d189">&#39;A&#39;</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>                       name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Actual CTR for Ad A&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>                       line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>                                   width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>                                   dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>    <span style="color:#737994;font-style:italic"># plot the calculated CTR for Ad B</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>    trace2 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>                       y<span style="color:#99d1db;font-weight:bold">=</span>ctr[<span style="color:#a6d189">&#39;B&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>                       name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Calculated CTR for Ad B&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>                       line<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(187, 121, 24, .7)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>                                 width<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>    <span style="color:#737994;font-style:italic"># plot the line with actual CTR for Ad A</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>    trace3 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, n],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>                       y<span style="color:#99d1db;font-weight:bold">=</span>[ACTUAL_CTR[<span style="color:#a6d189">&#39;B&#39;</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>                       name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Actual CTR for Ad B&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">41</span><span>                       line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">42</span><span>                                   width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">43</span><span>                                   dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">44</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">45</span><span>    <span style="color:#737994;font-style:italic"># plot the Regret values as a function of trial number</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">46</span><span>    trace4 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">47</span><span>                       y<span style="color:#99d1db;font-weight:bold">=</span>regret_list,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">48</span><span>                       name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Regret&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">49</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">50</span><span>    fig <span style="color:#99d1db;font-weight:bold">=</span> make_subplots(rows<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>, cols<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>, shared_yaxes<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>, shared_xaxes<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">51</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">52</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>add_trace(trace0, row<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>, col<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">53</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>add_trace(trace1, row<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>, col<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">54</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>add_trace(trace2, row<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>, col<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">55</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>add_trace(trace3, row<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>, col<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">56</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>add_trace(trace4, row<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>, col<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">57</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">58</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">59</span><span>        title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Simulated CTR Values and Algorithm Regret&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">60</span><span>        xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Trial Number&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">61</span><span>        yaxis1<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;CTR value&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">62</span><span>        yaxis2<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Regret Value&#39;</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">63</span><span>    )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">64</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">65</span><span>    <span style="color:#ca9ee6">return</span> fig
</span></span></code></pre></div></p>
</details>
<br>
<p>This never(?) happens in real life, but for we will assume that we know the actual CTR values for both Ads for simulation purposes.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ads <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#a6d189">&#39;A&#39;</span>, <span style="color:#a6d189">&#39;B&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ACTUAL_CTR <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">.45</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">.65</span>}
</span></span></code></pre></div><h2 id="random-selection">Random Selection</h2>
<ul>
<li><em>0% - Exploration</em></li>
<li><em>100% - Exploitation</em></li>
</ul>
<p>Let&rsquo;s start with the most naïve approach - Random Selection. The Random Selection algorithm doesn&rsquo;t do any Exploration, it just chooses randomly the Ad to show.</p>
<p>You can think of it as coin flip - if you get heads you show Ad A, if you get tails you show Ad B. So if you have 2 ads, each add will appear ~50% (=100%/2) of the time. I guess you can tell already what are the disadvantages of this model, but let&rsquo;s look on simulation.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># For each alrorithm we will perform 1000 trials</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>n <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>regret <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>total_reward <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>regret_list <span style="color:#99d1db;font-weight:bold">=</span> [] <span style="color:#737994;font-style:italic"># list for collecting the regret values for each impression (trial)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>ctr <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: [], <span style="color:#a6d189">&#39;B&#39;</span>: []} <span style="color:#737994;font-style:italic"># lists for collecting the calculated CTR </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>chosen_ads <span style="color:#99d1db;font-weight:bold">=</span> [] <span style="color:#737994;font-style:italic"># list for collecting the number of randomly choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span><span style="color:#737994;font-style:italic"># set the initial values for impressions and clicks </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>impressions <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>clicks <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n):    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    random_ad <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>choice(ads, p<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>, <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>]) <span style="color:#737994;font-style:italic"># randomly choose the ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    chosen_ads<span style="color:#99d1db;font-weight:bold">.</span>append(random_ad) <span style="color:#737994;font-style:italic"># add the value to list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    impressions[random_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span> <span style="color:#737994;font-style:italic"># add 1 impression value for the choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    did_click <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[random_ad]) <span style="color:#737994;font-style:italic"># simulate if the person clicked on the ad usind Actual CTR value</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    <span style="color:#ca9ee6">if</span> did_click:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        clicks[random_ad] <span style="color:#99d1db;font-weight:bold">+=</span> did_click <span style="color:#737994;font-style:italic"># if person clicked add 1 click value for the choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    <span style="color:#737994;font-style:italic"># calculate the CTR values and add them to list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    <span style="color:#ca9ee6">if</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">0</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>        ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>        ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">/</span>impressions[<span style="color:#a6d189">&#39;A&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>    <span style="color:#ca9ee6">if</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">0</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>        ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>        ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">/</span>impressions[<span style="color:#a6d189">&#39;B&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>    ctr[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_0)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>    ctr[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_1)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>    <span style="color:#737994;font-style:italic"># calculate the regret and reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>    regret <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#99d1db">max</span>(ACTUAL_CTR<span style="color:#99d1db;font-weight:bold">.</span>values()) <span style="color:#99d1db;font-weight:bold">-</span> ACTUAL_CTR[random_ad]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>    regret_list<span style="color:#99d1db;font-weight:bold">.</span>append(regret)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>    total_reward <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> algorithm_performance(chosen_ads, total_reward, regret_list)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div><iframe src="plotly-output/1.html" width="700" height="450" frameborder="0"></iframe>
<p>Both Ads were shown equal amount of times and the more trials, the closer the CTR values are to their known values. However, the Regret is continually increasing since the algorithm doesn&rsquo;t learn anything and doesn&rsquo;t do any updates according to gained information. This ever-increasing regret is exactly what we’re hoping to minimize with “smarter” methods.</p>
<p>I would use this algorithm in two cases:</p>
<ol>
<li>
<p>I want to be confident about the estimated CTR value for each Ad (the more impression each Ad get, the more confindet I am that estimated CTR equals to real CTR).</p>
</li>
<li>
<p>I have unlimited Marketing Budget ;)</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># save the reward and regret values for future comparison</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>random_dict <span style="color:#99d1db;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>    <span style="color:#a6d189">&#39;reward&#39;</span>:total_reward, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    <span style="color:#a6d189">&#39;regret_list&#39;</span>:regret_list, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>    <span style="color:#a6d189">&#39;ads_count&#39;</span>:pd<span style="color:#99d1db;font-weight:bold">.</span>Series(chosen_ads)<span style="color:#99d1db;font-weight:bold">.</span>value_counts(normalize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>}
</span></span></code></pre></div><h2 id="epsilon-greedy">Epsilon Greedy</h2>
<ul>
<li><em>~15% - Exploration</em></li>
<li><em>~85% - Exploitation</em></li>
</ul>
<p>The next approach is Epsilon-Greedy algorithm. Its logic can be defined as follows:</p>
<ol>
<li>Run the experiment for some initial number of times (<strong>Exploration</strong>).</li>
<li>Choose the winning variant with the highest score for initial period of exploration.</li>
<li>Set the Epsilon value, <strong>$\epsilon$</strong>.</li>
<li>Run experiment with choosing the winning variant for <strong>$(1-\epsilon)\% $</strong> of the time and other options for <strong>$\epsilon\%$</strong> of the time (<strong>Exploitation</strong>).</li>
</ol>
<p>Let&rsquo;s take a look at this algorithm in practice:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>e <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">.05</span> <span style="color:#737994;font-style:italic"># set the Epsilon value</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>n_init <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">100</span> <span style="color:#737994;font-style:italic"># number of impressions to choose the winning Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#737994;font-style:italic"># set the initial values for impressions and clicks </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>impressions <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>clicks <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n_init):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    random_ad <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>choice(ads, p<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>, <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>]) <span style="color:#737994;font-style:italic"># randomly choose the ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    impressions[random_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    did_click <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[random_ad])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    <span style="color:#ca9ee6">if</span> did_click:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        clicks[random_ad] <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">/</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">/</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>win_index <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>argmax([ctr_0, ctr_1]) <span style="color:#737994;font-style:italic"># select the Ad number with the highest CTR</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span><span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;After&#39;</span>, n_init, <span style="color:#a6d189">&#39;initial trials Ad&#39;</span>, ads[win_index], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>      <span style="color:#a6d189">&#39;got the highest CTR =&#39;</span>, <span style="color:#99d1db">round</span>(np<span style="color:#99d1db;font-weight:bold">.</span>max([ctr_0, ctr_1]), <span style="color:#ef9f76">2</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>      <span style="color:#a6d189">&#39;(Real CTR value is&#39;</span>, ACTUAL_CTR[ads[win_index]], <span style="color:#a6d189">&#39;).&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>      <span style="color:#a6d189">&#39;</span><span style="color:#8caaee">\n</span><span style="color:#a6d189">It will be shown&#39;</span>, (<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">-</span>e)<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">100</span>, <span style="color:#a6d189">&#39;</span><span style="color:#a6d189">% o</span><span style="color:#a6d189">f the time.&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>regret <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>total_reward <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>regret_list <span style="color:#99d1db;font-weight:bold">=</span> [] <span style="color:#737994;font-style:italic"># list for collecting the regret values for each impression (trial)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>ctr <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: [], <span style="color:#a6d189">&#39;B&#39;</span>: []} <span style="color:#737994;font-style:italic"># lists for collecting the calculated CTR </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>chosen_ads <span style="color:#99d1db;font-weight:bold">=</span> [] <span style="color:#737994;font-style:italic"># list for collecting the number of randomly choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span><span style="color:#737994;font-style:italic"># set the initial values for impressions and clicks </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>impressions <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>clicks <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span><span style="color:#737994;font-style:italic"># update probabilities</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>p <span style="color:#99d1db;font-weight:bold">=</span> [e, e]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>p[win_index] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1</span> <span style="color:#99d1db;font-weight:bold">-</span> e
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n):    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    win_ad <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>choice(ads, p<span style="color:#99d1db;font-weight:bold">=</span>p) <span style="color:#737994;font-style:italic"># randomly choose the ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    chosen_ads<span style="color:#99d1db;font-weight:bold">.</span>append(win_ad) <span style="color:#737994;font-style:italic"># add the value to list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    impressions[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span> <span style="color:#737994;font-style:italic"># add 1 impression value for the choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    did_click <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[win_ad]) <span style="color:#737994;font-style:italic"># simulate if the person clicked on the ad usind Actual CTR value</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    <span style="color:#ca9ee6">if</span> did_click:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>        clicks[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> did_click <span style="color:#737994;font-style:italic"># if person clicked add 1 click value for the choosen Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>    <span style="color:#737994;font-style:italic"># calculate the CTR values and add them to list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>    <span style="color:#ca9ee6">if</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">0</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>        ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>        ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">/</span>impressions[<span style="color:#a6d189">&#39;A&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>    <span style="color:#ca9ee6">if</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">0</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>        ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>        ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">/</span>impressions[<span style="color:#a6d189">&#39;B&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>    ctr[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_0)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>    ctr[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_1)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>    <span style="color:#737994;font-style:italic"># calculate the regret and reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">41</span><span>    regret <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#99d1db">max</span>(ACTUAL_CTR<span style="color:#99d1db;font-weight:bold">.</span>values()) <span style="color:#99d1db;font-weight:bold">-</span> ACTUAL_CTR[win_ad]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">42</span><span>    regret_list<span style="color:#99d1db;font-weight:bold">.</span>append(regret)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">43</span><span>    total_reward <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> algorithm_performance(chosen_ads, total_reward, regret_list)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div><iframe src="plotly-output/2.html" width="700" height="450" frameborder="0"></iframe>
<p>That’s much better; Notice how the regret has decreased by an order of magnitude! The Epsilon-Greedy algorithm seems to perform much better than Random Selection. But can you see the problem here? The winning variant from exploration period will not necessarily be the optimal variant, and you can actually exploit the suboptimal variant. This increases regret and decreases reward. According to the <strong>Law of Large Numbers</strong> the more initial trials you do, the more likely you will choose the winning variant correctly. But in Marketing you don&rsquo;t usually want to rely on chance and hope that you have reached that &rsquo;large number of trials'.</p>
<blockquote>
<p>In probability theory, the <strong>law of large numbers (LLN)</strong> is a theorem that describes the result of performing the same experiment a large number of times. According to the law, the average of the results obtained from a large number of trials should be close to the expected value, and will tend to become closer as more trials are performed.</p>
</blockquote>
<p>The good point is that you can adjust the ratio that controls how often to show the winning ad after initial trials by choosing different $\epsilon$ values.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>epsilon_dict <span style="color:#99d1db;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    <span style="color:#a6d189">&#39;reward&#39;</span>:total_reward, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>    <span style="color:#a6d189">&#39;regret_list&#39;</span>:regret_list, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    <span style="color:#a6d189">&#39;ads_count&#39;</span>:pd<span style="color:#99d1db;font-weight:bold">.</span>Series(chosen_ads)<span style="color:#99d1db;font-weight:bold">.</span>value_counts(normalize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)}
</span></span></code></pre></div><h2 id="thompson-sampling">Thompson Sampling</h2>
<ul>
<li><em>50% - Exploration</em></li>
<li><em>50% - Exploitation</em></li>
</ul>
<p>The Thompson Sampling exploration part is more sophisticated than e-Greedy algorithm. We have been using <strong>Beta distribution</strong>* here, however Thompson Sampling can be generalized to sample from any distributions over parameters.</p>
<blockquote>
<p>*In probability theory and statistics, the <strong>beta distribution</strong> is a family of continuous probability distributions defined on the interval [0, 1] parametrized by two positive shape parameters, denoted by $\alpha$ and $\beta$, that appear as exponents of the random variable and control the shape of the distribution.</p>
</blockquote>
<p><em>If you want to know more about Beta distribution here is an <a href="http://varianceexplained.org/statistics/beta_distribution_and_baseball/" target="_blank" rel="noopener">article</a> I found extremely useful.</em></p>
<p>Logic:</p>
<ol>
<li>Choose prior distributions for parameters $\alpha$ and $\beta$.</li>
<li>Calculate the $\alpha$ and $\beta$ values as: $\alpha = prior + hits$, $\beta = prior + misses$. * In our case hits = number of clicks, misses = number of impressions without a click. Priors are useful if you have some prior information about the actual CTR’s of your ads. Here, we do not, so we’ll use 1.0.*</li>
<li>Estimate actual CTR’s by sampling values of Beta distribution for each variant $B(\alpha_i, \beta_i)$ and choose the sample with the highest value (estimated CTR).</li>
<li>Repeat 2-3.</li>
</ol>
<details><summary>**Custom functions**</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># functions for manual Tompson sampling</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">calculate_beta_dist</span>(win_ad):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    impressions[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    did_click <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[win_ad])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    <span style="color:#ca9ee6">if</span> did_click:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        clicks[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    <span style="color:#737994;font-style:italic"># update ctr values according to beta destribution expected values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> random<span style="color:#99d1db;font-weight:bold">.</span>betavariate(priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;A&#39;</span>], priors[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> random<span style="color:#99d1db;font-weight:bold">.</span>betavariate(priors[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;B&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    highest_ad <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>argmax([ctr_0, ctr_1])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    chosen_ads<span style="color:#99d1db;font-weight:bold">.</span>append(highest_ad)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    ctr[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_0)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    ctr[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_1)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    <span style="color:#ca9ee6">return</span> highest_ad
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">plot_beta_dist</span>():
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>arange(<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>, <span style="color:#ef9f76">0.01</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> beta<span style="color:#99d1db;font-weight:bold">.</span>pdf(x, priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;A&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    y <span style="color:#99d1db;font-weight:bold">/=</span> y<span style="color:#99d1db;font-weight:bold">.</span>max() <span style="color:#737994;font-style:italic">## normalize</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>                    y<span style="color:#99d1db;font-weight:bold">=</span>y,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>                    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distribution (Ad A)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>                    marker <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(10, 108, 94, 1)&#39;</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>                    fill<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;tozeroy&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>                    fillcolor <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;rgba(10, 108, 94, .7)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>    trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x <span style="color:#99d1db;font-weight:bold">=</span> [ACTUAL_CTR[<span style="color:#ef9f76">0</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>                    y <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>                    name <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Actual CTR A Value&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>                    mode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;lines&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>                    line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>                        color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>                        width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>                        dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">41</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> beta<span style="color:#99d1db;font-weight:bold">.</span>pdf(x, priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;B&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">42</span><span>    y <span style="color:#99d1db;font-weight:bold">/=</span> y<span style="color:#99d1db;font-weight:bold">.</span>max()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">43</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">44</span><span>    trace2 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">45</span><span>                    y<span style="color:#99d1db;font-weight:bold">=</span>y,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">46</span><span>                    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distribution (Ad B)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">47</span><span>                    marker <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(187, 121, 24, 1)&#39;</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">48</span><span>                    fill<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;tozeroy&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">49</span><span>                    fillcolor <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;rgba(187, 121, 24, .7)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">50</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">51</span><span>    trace3 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x <span style="color:#99d1db;font-weight:bold">=</span> [ACTUAL_CTR[<span style="color:#ef9f76">1</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">52</span><span>                    y <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">53</span><span>                    name <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Actual CTR B Value&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">54</span><span>                    mode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;lines&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">55</span><span>                    line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">56</span><span>                        color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">57</span><span>                        width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">58</span><span>                        dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">60</span><span>    fig <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Figure([data1, data2, data3, data4])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">61</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>updatedate_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">62</span><span>        title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distributions for both Ads&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">63</span><span>        xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Possible CTR values&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">64</span><span>        yaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Probability Density&#39;</span>})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">66</span><span>    fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>regret <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>total_reward <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>regret_list <span style="color:#99d1db;font-weight:bold">=</span> [] 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>ctr <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: [], <span style="color:#a6d189">&#39;B&#39;</span>: []}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>index_list <span style="color:#99d1db;font-weight:bold">=</span> [] 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>impressions <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>clicks <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>priors <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">1</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">1</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>win_ad <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>choice(ads, p<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>, <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">/</span><span style="color:#ef9f76">2</span>]) <span style="color:#737994;font-style:italic">## randomly choose the first shown Ad</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n):    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    impressions[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    did_click <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[win_ad])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    <span style="color:#ca9ee6">if</span> did_click:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        clicks[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    ctr_0 <span style="color:#99d1db;font-weight:bold">=</span> random<span style="color:#99d1db;font-weight:bold">.</span>betavariate(priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;A&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    ctr_1 <span style="color:#99d1db;font-weight:bold">=</span> random<span style="color:#99d1db;font-weight:bold">.</span>betavariate(priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;B&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    win_ad <span style="color:#99d1db;font-weight:bold">=</span> ads[np<span style="color:#99d1db;font-weight:bold">.</span>argmax([ctr_0, ctr_1])]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    chosen_ads<span style="color:#99d1db;font-weight:bold">.</span>append(win_ad)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    ctr[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_0)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    ctr[<span style="color:#a6d189">&#39;B&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>append(ctr_1)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>    regret <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#99d1db">max</span>(ACTUAL_CTR<span style="color:#99d1db;font-weight:bold">.</span>values()) <span style="color:#99d1db;font-weight:bold">-</span> ACTUAL_CTR[win_ad]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>    regret_list<span style="color:#99d1db;font-weight:bold">.</span>append(regret)    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>    total_reward <span style="color:#99d1db;font-weight:bold">+=</span> did_click
</span></span></code></pre></div><details><summary>Code</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic">## plot the Beta distributions</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>x <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>linspace(<span style="color:#ef9f76">0</span>,<span style="color:#ef9f76">1</span>,<span style="color:#ef9f76">1000</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>y <span style="color:#99d1db;font-weight:bold">=</span> beta<span style="color:#99d1db;font-weight:bold">.</span>pdf(x, priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;A&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;A&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;A&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>y <span style="color:#99d1db;font-weight:bold">/=</span> y<span style="color:#99d1db;font-weight:bold">.</span>max() <span style="color:#737994;font-style:italic">## normalize</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>                   y<span style="color:#99d1db;font-weight:bold">=</span>y,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>                   name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distribution (Ad A)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>                   marker <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(10, 108, 94, 1)&#39;</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>                   fill<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;tozeroy&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>                   fillcolor <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;rgba(10, 108, 94, .7)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x <span style="color:#99d1db;font-weight:bold">=</span> [ACTUAL_CTR[<span style="color:#a6d189">&#39;A&#39;</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>                   y <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>                   name <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Actual CTR A Value&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>                   mode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;lines&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>                   line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>                       color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>                       width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>                       dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>y <span style="color:#99d1db;font-weight:bold">=</span> beta<span style="color:#99d1db;font-weight:bold">.</span>pdf(x, priors[<span style="color:#a6d189">&#39;A&#39;</span>]<span style="color:#99d1db;font-weight:bold">+</span>clicks[<span style="color:#a6d189">&#39;B&#39;</span>], priors[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> impressions[<span style="color:#a6d189">&#39;B&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> clicks[<span style="color:#a6d189">&#39;B&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>y <span style="color:#99d1db;font-weight:bold">/=</span> y<span style="color:#99d1db;font-weight:bold">.</span>max()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>trace2 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x<span style="color:#99d1db;font-weight:bold">=</span>x,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>                   y<span style="color:#99d1db;font-weight:bold">=</span>y,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>                   name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distribution (Ad B)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>                   marker <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#a6d189">&#39;rgba(187, 121, 24, 1)&#39;</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>                   fill<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;tozeroy&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>                   fillcolor <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;rgba(187, 121, 24, .7)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>trace3 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(x <span style="color:#99d1db;font-weight:bold">=</span> [ACTUAL_CTR[<span style="color:#a6d189">&#39;B&#39;</span>]] <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>                   y <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>                   name <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Actual CTR B Value&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>                   mode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;lines&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>                   line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>                       color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgb(205, 12, 24)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>                       width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>                       dash <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;dash&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">41</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Figure([trace0, trace1, trace2, trace3])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">42</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">43</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Beta Distributions for both Ads&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">44</span><span>    xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Possible CTR values&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">45</span><span>    yaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Probability Density&#39;</span>})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">46</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">47</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">48</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<iframe src="plotly-output/3.html" width="700" height="450" frameborder="0"></iframe>
<p>Note the intersection area. There might be the cases that value of Beta distribution for Ad A will be higher, than for Ad B, so algorithm will choose Ad A(which performs worse).</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> algorithm_performance(chosen_ads, total_reward, regret_list)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div><iframe src="plotly-output/4.html" width="700" height="450" frameborder="0"></iframe>
<p>The regret is the lowest we&rsquo;ve seen so far. Each uptick in regret happened when the Ad A was chosen. In the CTR Value plot, you can see that in the beginning, the green (Thompson sampled CTR value for Ad A) values were often greater than the tan (Thompson sampled CTR value for Ad B), resulting in Ad A being shown.</p>
<p>Note the differences in variations for each ad. The algorithm explores constantly, then naturally exploits the ad variant with the highest sample taken from the appropriate Beta distribution. This can be shown in the top plot of the distributions. The Beta distribution for Ad B is much higher and narrower than that of Ad A, meaning its sampled values will be consistently higher than those of Ad A, which is exactly what we want!</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>thompson_dict <span style="color:#99d1db;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    <span style="color:#a6d189">&#39;reward&#39;</span>:total_reward, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>    <span style="color:#a6d189">&#39;regret_list&#39;</span>:regret_list, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    <span style="color:#a6d189">&#39;ads_count&#39;</span>:pd<span style="color:#99d1db;font-weight:bold">.</span>Series(chosen_ads)<span style="color:#99d1db;font-weight:bold">.</span>value_counts(normalize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)}
</span></span></code></pre></div><h2 id="upper-confidence-bound-ucb1">Upper Confidence Bound (UCB1)</h2>
<ul>
<li><em>50% - Exploration</em></li>
<li><em>50% - Exploitation</em></li>
</ul>
<p>Unlike the Thompson Sampling algorithm, the Upper Confidence Bound cares more about the uncertainty (high variation) of each variant. The more uncertain we are about one variant, the more important it is to explore.</p>
<p>Algorithm chooses the variant with the highest upper confidence bound value (UCB) which represents the highest reward guess for the variant. It is defind as follows:</p>
<p>$UCB = \bar x_i + \sqrt{\frac{2 \cdot \log{t}}{n}}$ ,</p>
<p>where $\bar x_i$ - the (CTR rate) for $i$-th step,</p>
<p>$t$ - total number of (impressions) for all variants,</p>
<p>$n$ - total number of (impressions) for choosen variant</p>
<p>The logic is rather straightforward:</p>
<ol>
<li>Calculate the UCB for all variants.</li>
<li>Choose the variant with the highest UCB.</li>
<li>Go to 1.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>regret <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>total_reward <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>regret_list <span style="color:#99d1db;font-weight:bold">=</span> [] 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>ctr <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: [], <span style="color:#a6d189">&#39;B&#39;</span>: []}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>index_list <span style="color:#99d1db;font-weight:bold">=</span> [] 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>impressions <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>clicks <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;A&#39;</span>: <span style="color:#ef9f76">0</span>, <span style="color:#a6d189">&#39;B&#39;</span>: <span style="color:#ef9f76">0</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    win_ad <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;A&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    max_upper_bound <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    <span style="color:#ca9ee6">for</span> k <span style="color:#99d1db;font-weight:bold">in</span> ads:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        <span style="color:#ca9ee6">if</span> (impressions[k] <span style="color:#99d1db;font-weight:bold">&gt;</span> <span style="color:#ef9f76">0</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>            CTR <span style="color:#99d1db;font-weight:bold">=</span> clicks[k] <span style="color:#99d1db;font-weight:bold">/</span> impressions[k]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>            delta <span style="color:#99d1db;font-weight:bold">=</span> math<span style="color:#99d1db;font-weight:bold">.</span>sqrt(<span style="color:#ef9f76">2</span> <span style="color:#99d1db;font-weight:bold">*</span> math<span style="color:#99d1db;font-weight:bold">.</span>log(i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>) <span style="color:#99d1db;font-weight:bold">/</span> impressions[k])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>            upper_bound <span style="color:#99d1db;font-weight:bold">=</span> CTR <span style="color:#99d1db;font-weight:bold">+</span> delta
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>            ctr[k]<span style="color:#99d1db;font-weight:bold">.</span>append(CTR)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>        <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>            upper_bound <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1e400</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        <span style="color:#ca9ee6">if</span> upper_bound <span style="color:#99d1db;font-weight:bold">&gt;</span> max_upper_bound:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>            max_upper_bound <span style="color:#99d1db;font-weight:bold">=</span> upper_bound
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>            win_ad <span style="color:#99d1db;font-weight:bold">=</span> k
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    index_list<span style="color:#99d1db;font-weight:bold">.</span>append(win_ad)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    impressions[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#ef9f76">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>    reward <span style="color:#99d1db;font-weight:bold">=</span> bernoulli<span style="color:#99d1db;font-weight:bold">.</span>rvs(ACTUAL_CTR[win_ad])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>    clicks[win_ad] <span style="color:#99d1db;font-weight:bold">+=</span> reward
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>    total_reward <span style="color:#99d1db;font-weight:bold">+=</span> reward
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>    regret <span style="color:#99d1db;font-weight:bold">+=</span> <span style="color:#99d1db">max</span>(ACTUAL_CTR<span style="color:#99d1db;font-weight:bold">.</span>values()) <span style="color:#99d1db;font-weight:bold">-</span> ACTUAL_CTR[win_ad]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>    regret_list<span style="color:#99d1db;font-weight:bold">.</span>append(regret)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> algorithm_performance(chosen_ads, total_reward, regret_list)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div><iframe src="plotly-output/5.html" width="700" height="450" frameborder="0"></iframe>
<p>You can see that regret went up when the algorithm tried to decrease uncertainty of CTR for Ad A by choosing it.</p>
<p>It might be useful when you want the model to choose the best variant more often, but are still interested in reducing the uncertainty of both variants.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ucb1_dict <span style="color:#99d1db;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    <span style="color:#a6d189">&#39;reward&#39;</span>:total_reward, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>    <span style="color:#a6d189">&#39;regret_list&#39;</span>:regret_list, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    <span style="color:#a6d189">&#39;ads_count&#39;</span>:pd<span style="color:#99d1db;font-weight:bold">.</span>Series(chosen_ads)<span style="color:#99d1db;font-weight:bold">.</span>value_counts(normalize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)}
</span></span></code></pre></div><h2 id="comparison-and-conclusions">Comparison and Conclusions</h2>
<p>Now let&rsquo;s compare four of this methods and see which one performed better for our problem.</p>
<p>First of all, it&rsquo;s obvious that we want to show the Ad B more often since its actual CTR is 0.65. Let&rsquo;s take a look at the ratio how many time the right Ad has been chosen for each algorithm.</p>
<details><summary>Code</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Bar(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;Random Selection&#39;</span>, <span style="color:#a6d189">&#39;Epsilon Greedy&#39;</span>, <span style="color:#a6d189">&#39;Thompson Sampling&#39;</span>, <span style="color:#a6d189">&#39;UCB1&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>[random_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;A&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>       epsilon_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;A&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>       thompson_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;A&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>       ucb1_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;A&#39;</span>]],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Ad A&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;rgba(10, 108, 94, .7)&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Bar(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;Random Selection&#39;</span>, <span style="color:#a6d189">&#39;Epsilon Greedy&#39;</span>, <span style="color:#a6d189">&#39;Thompson Sampling&#39;</span>, <span style="color:#a6d189">&#39;UCB1&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>[random_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;B&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>       epsilon_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;B&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>       thompson_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;B&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>       ucb1_dict[<span style="color:#a6d189">&#39;ads_count&#39;</span>][<span style="color:#a6d189">&#39;B&#39;</span>]],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Ad B&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;rgba(187, 121, 24, .7)&#39;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Figure([trace0, trace1])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Ratio of appearance of both Ads throughout the trials&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Algorithm&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    yaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Ratio&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    barmode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;stack&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<iframe src="plotly-output/6.html" width="700" height="450" frameborder="0"></iframe>
<p>As you can see, three algorithms Epsilon Greedy, Thimpson Sampling and UCB1 showed Ad B most of the times (95%+).</p>
<details><summary>Code</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>arange (<span style="color:#ef9f76">0</span>, n, <span style="color:#ef9f76">1</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>random_dict[<span style="color:#a6d189">&#39;regret_list&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Random Selection&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;#ffcc66&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>arange (<span style="color:#ef9f76">0</span>, n, <span style="color:#ef9f76">1</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>epsilon_dict[<span style="color:#a6d189">&#39;regret_list&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;e-Greedy&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;#0099ff&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>trace2 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>arange (<span style="color:#ef9f76">0</span>, n, <span style="color:#ef9f76">1</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>thompson_dict[<span style="color:#a6d189">&#39;regret_list&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Thompson Sampling&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;#ff3300&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>trace3 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>arange (<span style="color:#ef9f76">0</span>, n, <span style="color:#ef9f76">1</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>ucb1_dict[<span style="color:#a6d189">&#39;regret_list&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    name<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;UCB1&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;#33cc33&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Figure([trace0, trace1, trace2, trace3])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Regret by the Algorithm&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>    xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Trial&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>    yaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Regret&#39;</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<iframe src="plotly-output/7.html" width="700" height="450" frameborder="0"></iframe>
<p>Taking to account that Thompson Sampling and Epsilon-Greedy algorithms chose ad with the higher CTR (B) most of the time, it shouldn&rsquo;t come as surprise that their regret values are the lowest.</p>
<details><summary>Code</summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>trace0 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Bar(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>[ucb1_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], thompson_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], epsilon_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], random_dict[<span style="color:#a6d189">&#39;reward&#39;</span>]],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;UCB1&#39;</span>, <span style="color:#a6d189">&#39;Thompson Sampling&#39;</span>, <span style="color:#a6d189">&#39;e-Greedy&#39;</span>,<span style="color:#a6d189">&#39;Random Selection&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    orientation <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;h&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    marker<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(color<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;#33cc33&#39;</span>, <span style="color:#a6d189">&#39;#ff3300&#39;</span>, <span style="color:#a6d189">&#39;#0099ff&#39;</span>, <span style="color:#a6d189">&#39;#ffcc66&#39;</span>]),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    opacity<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0.7</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>trace1 <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Scatter(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    x<span style="color:#99d1db;font-weight:bold">=</span>[ucb1_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], thompson_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], epsilon_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], random_dict[<span style="color:#a6d189">&#39;reward&#39;</span>]],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    y<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;UCB1&#39;</span>, <span style="color:#a6d189">&#39;Thompson Sampling&#39;</span>, <span style="color:#a6d189">&#39;e-Greedy&#39;</span>, <span style="color:#a6d189">&#39;Random Selection&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    mode<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;text&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    text<span style="color:#99d1db;font-weight:bold">=</span>[ucb1_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], thompson_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], epsilon_dict[<span style="color:#a6d189">&#39;reward&#39;</span>], random_dict[<span style="color:#a6d189">&#39;reward&#39;</span>]],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    textposition<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;middle left&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    line <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>        color <span style="color:#99d1db;font-weight:bold">=</span> (<span style="color:#a6d189">&#39;rgba(255,141,41,0.6)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        width <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    textfont<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">dict</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        family<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;sans serif&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        size<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">16</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>        color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;#000000&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>    )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>fig <span style="color:#99d1db;font-weight:bold">=</span> go<span style="color:#99d1db;font-weight:bold">.</span>Figure([trace0, trace1])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Total Reward by Algorithms&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>    xaxis<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;title&#39;</span>: <span style="color:#a6d189">&#39;Total Reward (Clicks)&#39;</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>    margin<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;l&#39;</span>:<span style="color:#ef9f76">200</span>},
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>    showlegend<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">False</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>fig<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<iframe src="plotly-output/8.html" width="700" height="450" frameborder="0"></iframe>
<p>It can be the case that total reward for the algorithm with the lowest regret value will not be the highest. It is caused by the fact that even if the algorithm chooses the right ad it doesn&rsquo;t guarantee that the user will click on it.</p>
<p>As was told from the beginning, the Thompson Sampling is generally the best choice, but we also looked at other algorithms and discussed how and when they might be useful. The method you choose depends on your unique problem, prior information you have and what information you want to receive afterwards.</p>

      </div>

      
  <time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime="2019-04-01T00:00:00.000Z">
    <span>Last updated on</span>
    Apr 1, 2019</time>

      <div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5">
        
        <div class="max-w-prose print:hidden">
  
  

  

<div class="flex justify-center">
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/reinforcement-learning/">Reinforcement Learning</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/python/">Python</a>
  
</div>


  
<section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fmab-problem%2F&amp;text=How&#43;to&#43;Deal&#43;with&#43;Multi-Armed&#43;Bandit&#43;Problem"
    title="X"
    aria-label="X"
    id="share-link-x"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fmab-problem%2F&amp;t=How&#43;to&#43;Deal&#43;with&#43;Multi-Armed&#43;Bandit&#43;Problem"
    title="Facebook"
    aria-label="Facebook"
    id="share-link-facebook"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
  </a>
  

  
  
  
  
  
  
    
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="mailto:?subject=How%20to%20Deal%20with%20Multi-Armed%20Bandit%20Problem&amp;body=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fmab-problem%2F"
    title="Email"
    aria-label="Email"
    id="share-link-email"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fmab-problem%2F&amp;title=How&#43;to&#43;Deal&#43;with&#43;Multi-Armed&#43;Bandit&#43;Problem"
    title="LinkedIn"
    aria-label="LinkedIn"
    id="share-link-linkedin"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="whatsapp://send?text=How&#43;to&#43;Deal&#43;with&#43;Multi-Armed&#43;Bandit&#43;Problem%20http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fmab-problem%2F"
    title="WhatsApp"
    aria-label="WhatsApp"
    id="share-link-whatsapp"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><path d="m187.58 144.84-32-16a8 8 0 0 0-8 .5l-14.69 9.8a40.55 40.55 0 0 1-16-16l9.8-14.69a8 8 0 0 0 .5-8l-16-32A8 8 0 0 0 104 64a40 40 0 0 0-40 40 88.1 88.1 0 0 0 88 88 40 40 0 0 0 40-40 8 8 0 0 0-4.42-7.16ZM152 176a72.08 72.08 0 0 1-72-72 24 24 0 0 1 19.29-23.54l11.48 23L101 118a8 8 0 0 0-.73 7.51 56.47 56.47 0 0 0 30.15 30.15A8 8 0 0 0 138 155l14.61-9.74 23 11.48A24 24 0 0 1 152 176ZM128 24a104 104 0 0 0-91.82 152.88l-11.35 34.05a16 16 0 0 0 20.24 20.24l34.05-11.35A104 104 0 1 0 128 24Zm0 192a87.87 87.87 0 0 1-44.06-11.81 8 8 0 0 0-6.54-.67L40 216l12.47-37.4a8 8 0 0 0-.66-6.54A88 88 0 1 1 128 216Z"/></svg>
  </a>
  
</section>


  








  
  
    



  
  
  
    
  
  
  

<div class="flex pt-12 pb-4">
  
  
  <img
    class="mr-4 h-24 w-24 rounded-full"
    width="96"
    height="96"
    alt="Ruslan Klymentiev"
  src="/author/ruslan-klymentiev/avatar_hu14015720463236890778.png"
  loading="lazy"
  />
  
  <div class="place-self-center">
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Authors
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      <a href="http://localhost:4321/" class="no-underline">
      Ruslan Klymentiev
      </a>
    </div>

    
    <div class="text-sm font-bold text-neutral-700 dark:text-neutral-300">
    Data-something-scientist
    </div>
    


    

    <div class="text-2xl sm:text-lg pt-1">

      
<div class="flex flex-wrap text-neutral-500 dark:text-neutral-300">
  
    
    
    
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="mailto:rklymentiev@gmail.com"
      
      aria-label="At-Symbol"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://github.com/rklymentiev"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Github"
    ><svg style="height: 1em;" fill="currentColor" viewBox="3 3 18 18"><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://scholar.google.com/citations?user=prQO0zEAAAAJ"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Google-Scholar"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M343.759 106.662V79.43L363.524 64h-213.89L20.476 176.274h85.656a82.339 82.339 0 0 0-.219 6.225c0 20.845 7.22 38.087 21.672 51.861c14.453 13.797 32.252 20.648 53.327 20.648c4.923 0 9.75-.368 14.438-1.024c-2.907 6.5-4.374 12.523-4.374 18.142c0 9.875 4.499 20.43 13.467 31.642c-39.234 2.67-68.061 9.732-86.437 21.163c-10.531 6.5-19 14.704-25.39 24.531c-6.391 9.9-9.578 20.515-9.578 31.962c0 9.648 2.062 18.336 6.219 26.062c4.156 7.726 9.578 14.07 16.312 18.984c6.718 4.968 14.469 9.101 23.219 12.469c8.734 3.344 17.406 5.718 26.061 7.062A167.052 167.052 0 0 0 180.555 448c13.469 0 26.953-1.734 40.547-5.187c13.562-3.485 26.28-8.642 38.171-15.493c11.86-6.805 21.515-16.086 28.922-27.718c7.39-11.68 11.094-24.805 11.094-39.336c0-11.016-2.25-21.039-6.75-30.14c-4.468-9.073-9.938-16.542-16.452-22.345c-6.501-5.813-13-11.155-19.516-15.968c-6.5-4.845-12-9.75-16.468-14.813c-4.485-5.046-6.735-10.054-6.735-14.984c0-4.921 1.734-9.672 5.216-14.265c3.455-4.61 7.674-9.048 12.61-13.306c4.937-4.25 9.875-8.968 14.796-14.133c4.922-5.147 9.141-11.827 12.61-20.008c3.485-8.18 5.203-17.445 5.203-27.757c0-13.453-2.547-24.46-7.547-33.314c-.594-1.022-1.218-1.803-1.875-3.022l56.907-46.672v17.119c-7.393.93-6.624 5.345-6.624 10.635V245.96c0 5.958 4.875 10.834 10.834 10.834h3.989c5.958 0 10.833-4.875 10.833-10.834V117.293c0-5.277.778-9.688-6.561-10.63zm-107.36 222.48c1.14.75 3.704 2.78 7.718 6.038c4.05 3.243 6.797 5.695 8.266 7.414a443.553 443.553 0 0 1 6.376 7.547c2.813 3.375 4.718 6.304 5.718 8.734c1 2.477 2.016 5.461 3.047 8.946a38.27 38.27 0 0 1 1.485 10.562c0 17.048-6.564 29.68-19.656 37.859c-13.125 8.18-28.767 12.274-46.938 12.274c-9.187 0-18.203-1.093-27.063-3.196c-8.843-2.116-17.311-5.336-25.39-9.601c-8.078-4.258-14.577-10.204-19.5-17.797c-4.938-7.64-7.407-16.415-7.407-26.25c0-10.32 2.797-19.29 8.422-26.906c5.594-7.625 12.938-13.391 22.032-17.315c9.063-3.946 18.25-6.742 27.562-8.398a157.865 157.865 0 0 1 28.438-2.555c4.47 0 7.936.25 10.405.696c.455.219 3.032 2.07 7.735 5.563c4.704 3.462 7.625 5.595 8.75 6.384zm-3.359-100.579c-7.406 8.86-17.734 13.288-30.953 13.288c-11.86 0-22.298-4.764-31.266-14.312c-9-9.523-15.422-20.328-19.344-32.43c-3.937-12.109-5.906-23.984-5.906-35.648c0-13.694 3.596-25.352 10.781-34.976c7.187-9.65 17.5-14.485 30.938-14.485c11.875 0 22.374 5.038 31.437 15.157c9.094 10.085 15.61 21.413 19.517 33.968c3.922 12.54 5.873 24.53 5.873 35.984c0 13.446-3.702 24.61-11.076 33.454z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://orcid.org/0000-0002-0907-0908"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Orcid"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M336.62 194.538c-7.13-3.328-13.866-5.56-20.253-6.614c-6.365-1.095-16.574-1.612-30.71-1.612h-36.704v152.747h37.634c14.673 0 26.081-1.013 34.224-3.017c8.142-2.004 14.921-4.526 20.356-7.626a69.448 69.448 0 0 0 14.942-11.388c14.488-14.714 21.742-33.273 21.742-55.717c0-22.052-7.44-40.052-22.341-53.982c-5.498-5.166-11.822-9.444-18.89-12.793zM256 8C119.022 8 8 119.042 8 256s111.022 248 248 248s248-111.042 248-248S392.978 8 256 8Zm-82.336 357.513h-29.389V160.148h29.389zM158.95 138.696c-11.14 0-20.213-9.01-20.213-20.212c0-11.118 9.052-20.191 20.213-20.191c11.18 0 20.232 9.052 20.232 20.191a20.194 20.194 0 0 1-20.232 20.212zm241.386 163.597c-5.29 12.545-12.834 23.581-22.65 33.088c-9.982 9.837-21.597 17.194-34.844 22.196c-7.75 3.017-14.839 5.063-21.307 6.117c-6.49 1.013-18.828 1.509-37.076 1.509h-64.956V160.148h69.233c27.962 0 50.034 4.154 66.32 12.545c16.265 8.37 29.181 20.728 38.792 36.972c9.61 16.265 14.425 34.018 14.425 53.196c.023 13.765-2.666 26.908-7.936 39.432z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://www.instagram.com/rklymentiev/"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Instagram"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path fill="currentColor" fill-rule="evenodd" d="M12.91 12.909c.326-.327.582-.72.749-1.151c.16-.414.27-.886.302-1.578c.032-.693.04-.915.04-2.68c0-1.765-.008-1.987-.04-2.68c-.032-.692-.142-1.164-.302-1.578a3.185 3.185 0 0 0-.75-1.151a3.187 3.187 0 0 0-1.151-.75c-.414-.16-.886-.27-1.578-.302C9.487 1.007 9.265 1 7.5 1c-1.765 0-1.987.007-2.68.04c-.692.03-1.164.14-1.578.301a3.2 3.2 0 0 0-1.151.75a3.2 3.2 0 0 0-.75 1.151c-.16.414-.27.886-.302 1.578C1.007 5.513 1 5.735 1 7.5c0 1.765.007 1.987.04 2.68c.03.692.14 1.164.301 1.578c.164.434.42.826.75 1.151c.325.33.718.586 1.151.75c.414.16.886.27 1.578.302c.693.031.915.039 2.68.039c1.765 0 1.987-.008 2.68-.04c.692-.03 1.164-.14 1.578-.301a3.323 3.323 0 0 0 1.151-.75ZM2 6.735v1.53c-.002.821-.002 1.034.02 1.5c.026.586.058 1.016.156 1.34c.094.312.199.63.543 1.012c.344.383.675.556 1.097.684c.423.127.954.154 1.415.175c.522.024.73.024 1.826.024H8.24c.842.001 1.054.002 1.526-.02c.585-.027 1.015-.059 1.34-.156c.311-.094.629-.2 1.011-.543c.383-.344.556-.676.684-1.098c.127-.422.155-.953.176-1.414C13 9.247 13 9.04 13 7.947v-.89c0-1.096 0-1.303-.023-1.826c-.021-.461-.049-.992-.176-1.414c-.127-.423-.3-.754-.684-1.098c-.383-.344-.7-.449-1.011-.543c-.325-.097-.755-.13-1.34-.156A27.29 27.29 0 0 0 8.24 2H7.057c-1.096 0-1.304 0-1.826.023c-.461.021-.992.049-1.415.176c-.422.128-.753.301-1.097.684c-.344.383-.45.7-.543 1.012c-.098.324-.13.754-.156 1.34c-.022.466-.022.679-.02 1.5ZM7.5 5.25a2.25 2.25 0 1 0 0 4.5a2.25 2.25 0 0 0 0-4.5ZM4.25 7.5a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0Zm6.72-2.72a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"/></svg></a>
  
</div>



    </div>
  </div>
</div>



  




  
  
    
    
    
      
      
    
<div class="pt-1 no-prose w-full">
  <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
  <div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2">
    <div class="">
      
        <a class="group flex no-underline" href="/tutorial/bayes_disease/">
          <span
            class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline rtl:hidden">&larr;</span></span>
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Bayes Rule and Disease Testing</span>
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Apr 10, 2020
              
            </span>
          </span>
        </a>
      
    </div>
    <div class="">
      
    </div>
  </div>
</div>



  


  



</div>

      </div>

    </main>
  </article>
</div>

    </div>
    <div class="page-footer">
      <footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200">

  












  
  
  
  
  














  
  
  

  
  
  
    
  

  

  
  <p class="powered-by text-center">
    © 2024. This work is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by text-center">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>

</footer>

    </div>

    
    











  </body>
</html>
