<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: November 11, 2024 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="system">
  
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.2.0" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ruslan Klymentiev" />

  
  
  
    
  
  <meta name="description" content="How to fit reinforcement learning models to behavioral data using Maximum Likelihood Estimation." />

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:4321/tutorial/computational-models-of-behavior-pt1/" />

  
  
  
  
    
    <link rel="stylesheet" href="/css/themes/emerald.min.css" />
  

  
  
    
    <link href="/dist/wc.min.css" rel="stylesheet" />
  

  
  
  

  
    
    <link href="/css/custom.min.15f6624443884362110ae1c63cfb1412c6924eea6b2373b4f708c498d4bf0f66.css" rel="stylesheet" />
  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  
  




































  
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu18111939623654241174.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu8230923372197676942.png" />

  <link rel="canonical" href="http://localhost:4321/tutorial/computational-models-of-behavior-pt1/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="RK" />
  <meta property="og:url" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt1/" />
  <meta property="og:title" content="Computational Models of Behavior, part 1 | RK" />
  <meta property="og:description" content="How to fit reinforcement learning models to behavioral data using Maximum Likelihood Estimation." /><meta property="og:image" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt1/featured.png" />
    <meta property="twitter:image" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt1/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-10-25T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-10-25T00:00:00&#43;00:00">
  

  



  


  <title>Computational Models of Behavior, part 1 | RK</title>

  
  
  
  
  
    
    
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(/dist/font/Inter.var.woff2) format(woff2);
    }
  </style>

  

  
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  







<link type="text/css" rel="stylesheet" href="/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css" integrity="sha256-vnZutBkxehTsdp0hbpd5v&#43;jzc3yA54D0ug2vtXpBpII=" />


<script src="/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js" integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script>


<script>window.hbb.pagefind = {"baseUrl":"/"};</script>

<style>
  html.dark {
    --pagefind-ui-primary: #eeeeee;
    --pagefind-ui-text: #eeeeee;
    --pagefind-ui-background: #152028;
    --pagefind-ui-border: #152028;
    --pagefind-ui-tag: #152028;
  }
</style>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    new PagefindUI({
      element: "#search",
      showSubResults: true,
      baseUrl: window.hbb.pagefind.baseUrl,
      bundlePath: window.hbb.pagefind.baseUrl + "pagefind/",
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    let element = document.getElementById('search');
    let trigger = document.getElementById('search_toggle');

    if (trigger) {
      trigger.addEventListener('click', () => {
        element.classList.toggle('hidden');
        element.querySelector("input").value = ""
        element.querySelector("input").focus()

        if (!element.classList.contains('hidden')) {
          let clear_trigger = document.querySelector('.pagefind-ui__search-clear');

          if (clear_trigger && !clear_trigger.hasAttribute('listenerOnClick')) {
            clear_trigger.setAttribute('listenerOnClick', 'true');

            clear_trigger.addEventListener('click', () => {
              element.classList.toggle('hidden');
            });
          }
        }

      });
    }
  });
</script>










  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js" integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="/js/hugo-blox-en.min.js"
    integrity=""
  ></script>

  
  








  
    
      
      <script async defer src="https://buttons.github.io/buttons.js"></script>

      
    
  




</head>

  <body class="dark:bg-hb-dark dark:text-white page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header sticky top-0 z-30">
      
      
      
        
        
        
          <header id="site-header" class="header">
  <nav class="navbar px-3 flex justify-left">
    <div class="order-0 h-100">
      
      <a class="navbar-brand" href="/" title="RK">
        RK
      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Open Menu</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Close Menu</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left
      ">
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/"
        >Home</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/publication/"
        >Publications</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/tutorial/"
        >Tutorials</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/post/"
        >Blog</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/event/"
        >Talks</a
        >
      </li>
      
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">

      
      
      
      <button
        aria-label="search"
        class="text-black hover:text-primary  inline-block px-3 text-xl dark:text-white"
        id="search_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentColor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
      </button>
      

      
      
      <div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
            [&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white">
        <button class="theme-toggle mt-1" accesskey="t" title="appearance">
          <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class="dark:hidden">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </div>
      

      
      

      
      
    </div>
  </nav>
</header>


<div id="search" class="hidden p-3"></div>


        
      
    </div>
    <div class="page-body  my-10">
      





<div class="mx-auto flex max-w-screen-xl">
  



<aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block">
  
  <div class="px-4 pt-4 lg:hidden">
    
    
  </div>
  <div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]">
    <ul class="flex flex-col gap-1 lg:hidden">
      
      
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/"
    
  >Recent Talks
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_cben2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_ssc2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/introduction-to-python/"
    
  >Introduction to Python
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value? (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/how-to-start-career-in-data/"
    
  >How to start career in Data (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/null-hypothesis-significance-testing/"
    
  >Statistical Hypothesis Testing (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/data-visualization/"
    
  >Packages for Data Visualization (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/numpy-pandas-sympy/"
    
  >Intro to NumPy, pandas &amp; SymPy (in Russian)
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/"
    
  >Publications
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/"
    
  >Inhibiting presynaptic calcium channel motility in the auditory cortex suppresses synchronized input processing
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/"
    
  >Blog
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-i-met-my-partner-in-crime/"
    
  >How I Met My Partner In Crime
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-do-criminals-make-decisions/"
    
  >How Do Criminals Make Decisions?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/psychopathy/"
    
  >Psychopaths: the Good, the Bad, and the Crazy
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/"
    
  >Projects
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pandas/"
    
  >Pandas
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pytorch/"
    
  >PyTorch
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/scikit/"
    
  >scikit-learn
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/experience/"
    
  >Experience
    </a></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/"
    
  >Teaching
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/python_for_ds/"
    
  >Python for Data Science (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt2/"
    
  >Computational Models of Behavior, part 2
    </a>
              
            </li><li class="flex flex-col open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/tutorial/computational-models-of-behavior-pt1/"
    
  >Computational Models of Behavior, part 1
    </a>
  
    <ul class="hb-sidebar-mobile-toc"><li>
              <a
                href="#introduction"
                class="hb-docs-link"
              >Introduction</a>
            </li>
          <li>
              <a
                href="#data-generation"
                class="hb-docs-link"
              >Data generation</a>
            </li>
          <li>
              <a
                href="#maximum-likelihood-estimation"
                class="hb-docs-link"
              >Maximum Likelihood Estimation</a>
            </li>
          <li>
              <a
                href="#model-comparison"
                class="hb-docs-link"
              >Model Comparison</a>
            </li>
          <li>
              <a
                href="#model-validation"
                class="hb-docs-link"
              >Model Validation</a>
            </li>
          <li>
              <a
                href="#groups-comparison"
                class="hb-docs-link"
              >Groups Comparison</a>
            </li>
          <li>
              <a
                href="#summary-and-limitations"
                class="hb-docs-link"
              >Summary and Limitations</a>
            </li>
          <li>
              <a
                href="#references"
                class="hb-docs-link"
              >References</a>
            </li>
          </ul>
  
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/pyforneuro/"
    
  >Python for Neuroscience
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bandit_cats/"
    
  >Bandit Cats and Exploration-Exploitation Trade-Off
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/eeg-preprocessing-erp/"
    
  >Intro to EEG Data Analysis
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-3/"
    
  >Null Hypothesis Significance Testing, part 3
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-2/"
    
  >Null Hypothesis Significance Testing, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/roc-curve/"
    
  >ROC Curve Simulation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-1/"
    
  >Null Hypothesis Significance Testing, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/norm-binom/"
    
  >Normal Approximation to Binomial Distribution
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/how-do-cart-models-work/"
    
  >How do CART models work
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bayes_disease/"
    
  >Bayes Rule and Disease Testing
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/mab-problem/"
    
  >How to Deal with Multi-Armed Bandit Problem
    </a>
              
            </li></ul>
      </div></li>
    </ul>

    <div class="max-xl:hidden h-0 w-64 shrink-0"></div></div>

</aside>
  

<nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents">
  











  <div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#introduction">Introduction</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#data-generation">Data generation</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#maximum-likelihood-estimation">Maximum Likelihood Estimation</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#different-starting-values">Different starting values</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#model-comparison">Model Comparison</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#comparison-to-the-random-choice-model">Comparison to the Random Choice Model</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#model-validation">Model Validation</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#groups-comparison">Groups Comparison</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#summary-and-limitations">Summary and Limitations</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#references">References</a>
      </li></ul>

  
  



    












  </div>
  </nav>


  <article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12">

      

      <h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">Computational Models of Behavior, part 1</h1>

      <div class="mt-4 mb-16">
      <div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class="mr-1">Oct 25, 2021</span><span class="mx-1">·</span>
        
          
          
          <div class="group inline-flex items-center text-current gap-x-1.5 mx-1">
            
            
            <img src="/author/ruslan-klymentiev/avatar_hu16379050607528300314.webp" alt="Ruslan Klymentiev" class="inline-block h-4 w-4 rounded-full border border-current" loading="lazy" />
            
            <div >Ruslan Klymentiev</div>
          </div>
          
        

        
        <span class="mx-1">·</span>
        <span class="mx-1">
          30 min read
        </span>
        
        </div>

        <div class="mt-3">
          





        </div>
      </div>



      
      
      
      
      

      
      
      
      
      
      
      
      
      
      
      <div class="article-header article-container featured-image-wrapper mt-4 mb-16" style="max-width: 720px; max-height: 386px;">
        <div style="position: relative">
          <img src="/tutorial/computational-models-of-behavior-pt1/featured_hu4735426749675544230.webp" width="720" height="386" alt="" class="featured-image">
          <span class="article-header-caption">Image credit: <a href="https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6655267">Gerd Altmann</a> from <a href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6655267">Pixabay</a></span>
        </div>
      </div>
      

      
      

      <div class="prose prose-slate lg:prose-xl dark:prose-invert">
        <h2 id="introduction">Introduction</h2>
<p>It is pretty clear that neuroscience is shaping the artificial intelligence (AI) field by means of new research questions and ideas. But at the same time AI also has a huge impact on the neuroscience field. Over the last decades reinforcement learning (RL) algorithms have been particularly useful in attempts to understand how humans and animals make decisions and they&rsquo;ve provided methods to quantify the parameters of behavioral data, which could be also correlated to neuronal data. For example, temporal difference (TD) learning model has highlighted the role of dopamine in decision-making in a classical study of Schultz (1998)<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p>Even though RL methods have been applied in a neuroscience field for quite some time, some may still be unsure how these methods can help with answering research questions or how to actually apply modeling in practice. While there are already several comprehensive articles on how to apply RL models to decision-making data, the purpose of this post is to provide an actual example of model fitting with coding guidelines and also to compare two main approaches, maximum likelihood estimation (MLE) and Bayesian method. Part 1 will focus on the MLE approach with the example code in Python, whereas part 2 will focus on the Bayesian approach written in R with the help of <code>hBayesDM</code> package. Both parts should be viewed as an overview, and not as means of selecting the one-size-fits-all approach. The explanations and basics of theory will be provided, however for a more in-depth overview reader might want to refer to Lockwood et al. (2021)<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>, Daw (2011)<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> and Wilson et al. (2019)<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<p><strong>Objectives</strong>:</p>
<ol>
<li>How to answer research questions using modelling.</li>
<li>How to fit a RL model to behavioral data using MLE.</li>
<li>How to compare models and choose the best fitting one.</li>
<li>How to generate the data using RL model.</li>
</ol>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">itertools</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">numpy</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">np</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">pandas</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">pd</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">seaborn</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">sns</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">matplotlib.pyplot</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">plt</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">pingouin</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">pg</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">tqdm</span> <span style="color:#81c8be">import</span> tqdm
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">scipy.special</span> <span style="color:#81c8be">import</span> softmax, log_softmax
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">scipy.optimize</span> <span style="color:#81c8be">import</span> minimize
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">scipy.stats</span> <span style="color:#81c8be">import</span> chisquare
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>style<span style="color:#99d1db;font-weight:bold">.</span>use(<span style="color:#a6d189">&#39;bmh&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>rcParams[<span style="color:#a6d189">&#39;figure.facecolor&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;white&#39;</span>
</span></span></code></pre></div></p>
</details>
<br>
<p><strong>Research question</strong>:</p>
<p>We hypothesize that treatment (could be anything, dopamine manipulations, exposure to stress, etc.) affects humans&rsquo; reward sensitivity and the learning rate for a positive outcome (the speed of learning where the optimal choice is).</p>
<p><strong>Paradigm</strong>:</p>
<p>We could test this using so-called multi-armed bandit (MAB) paradigm, with a slight modification. In our case, each &ldquo;arm&rdquo; can bring reward and punishment at the same time for each trial. The probabilities of outcomes are stationary over time. Subject has to make a decision (choose an &ldquo;arm&rdquo;) at each trial. We will use a 4-armed bandit.</p>
<p>We will also have two groups, control (CTR) and treatment (TRT), and compare the parameters between them.</p>
<h2 id="data-generation">Data generation</h2>
<p>For this article, we will generate <strong>artificial</strong> data, but we will treat it as <strong>real-life</strong> data (at least most of the time). In other words, we will generate data with a set of parameter values, but then we will try to recover them using the modeling. On the one hand, this will allow to perform a quantitative assessment of model fitting techniques (since we know the ground truth). On the other hand, we can see how to perform a model fitting in a &ldquo;real-life&rdquo;.</p>
<p>We will use the model adapted from Seymour et al. (2012)<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>. Parameters of the model are:</p>
<ul>
<li>learning rate for reward outcomes $\alpha^{\text{reward}}$ (how fast agent learns from the positive feedback)</li>
<li>learning rate for punishment outcomes $\alpha^{\text{punishment}}$ (how fast agent learns from the negative feedback)</li>
<li>reward sensitivity $R$ (how agent perceives positive feedback)</li>
<li>punishment sensitivity $P$ (how agent perceives negative feedback)</li>
</ul>
<p><strong>Model algorithm:</strong></p>
<ul>
<li><strong>for</strong> <em>each step $t$ in episode</em> <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)_t \leftarrow Q(a_j)^{\text{reward}}_t + Q(a_j)^{\text{punishment}}_t$</li>
<li>Select action $a_t$ using softmax policy $\scriptsize P(a_j = a_t) = \frac{e^{Q_j}}{\sum_{j}e^{Q_j}}$</li>
<li>Observe reward $r_t$ and punishment $p_t$ values</li>
<li><strong>for</strong> <em>each action $a_j$ in possible actions</em> <strong>do</strong>
<ul>
<li><strong>if</strong> $a_j$ == $a_t$ <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} - Q(a_j)^{\text{reward}}_t + \alpha^{\text{reward}} \left( R \cdot r_t - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha^{\text{punishment}} \left( P \cdot p_t - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>else</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} \leftarrow Q(a_j)^{\text{reward}}_t + \alpha^{\text{reward}} \left( - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha^{\text{punishment}} \left( - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
<div class="flex px-4 py-3 mb-6 rounded-md bg-primary-100 dark:bg-primary-900">
<span class="pr-3 pt-1 text-primary-600 dark:text-primary-300">
  <svg height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m11.25 11.25l.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0m-9-3.75h.008v.008H12z"/></svg>
</span>
  <span class="dark:text-neutral-300">A note on terminology. In neuroscience settings, we usually call participants &ldquo;subjects&rdquo;, whereas in RL we usually refer to them as &ldquo;agents&rdquo; (which may also have more abstract meaning). Also, a set of consecutive trials is usually called a &ldquo;session&rdquo; in neuroscience, but an &ldquo;episode&rdquo; in RL. In this article we may use these terms interchangeably.</span>
</div>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  1</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">generate_agent_data</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  2</span><span>    alpha_rew, alpha_pun, rew_sens,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  3</span><span>    pun_sens, rew_prob, pun_prob, rew_vals,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  4</span><span>    n_arms<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">4</span>, n_trials<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">100</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  5</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  6</span><span><span style="color:#a6d189">    Simulate agent data for N-armed bandit task.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  7</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  8</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  9</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 10</span><span><span style="color:#a6d189">    alpha_rew : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 11</span><span><span style="color:#a6d189">        Learning rate for rewarding trials. Should be in a (0, 1) range.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 12</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 13</span><span><span style="color:#a6d189">    alpha_pun : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 14</span><span><span style="color:#a6d189">        Learning rate for punishing trials. Should be in a (0, 1) range.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 15</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 16</span><span><span style="color:#a6d189">    rew_sens : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 17</span><span><span style="color:#a6d189">        Reward sensitivity (R)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 18</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 19</span><span><span style="color:#a6d189">    pun_sens : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 20</span><span><span style="color:#a6d189">        Punishment sensitivity (P)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 21</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 22</span><span><span style="color:#a6d189">    rew_prob : array_like
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 23</span><span><span style="color:#a6d189">        Probability of reward for each arm.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 24</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 25</span><span><span style="color:#a6d189">    pun_prob : array_like
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 26</span><span><span style="color:#a6d189">        Probability of punishment for each arm.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 27</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 28</span><span><span style="color:#a6d189">    rew_vals : array_like
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 29</span><span><span style="color:#a6d189">        Values of reward (first element) and punishment (second element).
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 30</span><span><span style="color:#a6d189">        For example [100, -50] means that agent receives 100 a.u. during 
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 31</span><span><span style="color:#a6d189">        the reward and looses 50 a.u. during the punishment.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 32</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 33</span><span><span style="color:#a6d189">    n_arms : int, default=4
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 34</span><span><span style="color:#a6d189">        Number of arms in N-armed bandit task.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 35</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 36</span><span><span style="color:#a6d189">    n_trials : int, default=100
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 37</span><span><span style="color:#a6d189">        Number of simulated trials for an agent
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 38</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 39</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 40</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 41</span><span><span style="color:#a6d189">    actions : array of shape (n_trials,)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 42</span><span><span style="color:#a6d189">        Selected action by the agent at each trial.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 43</span><span><span style="color:#a6d189">        
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 44</span><span><span style="color:#a6d189">    gains : array of shape (n_trials,)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 45</span><span><span style="color:#a6d189">        Agent&#39;s reward value at each trial.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 46</span><span><span style="color:#a6d189">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 47</span><span><span style="color:#a6d189">    losses : array of shape (n_trials,)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 48</span><span><span style="color:#a6d189">        Agent&#39;s punishment value at each trial.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 49</span><span><span style="color:#a6d189">    
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 50</span><span><span style="color:#a6d189">    Qs : array of shape (n_trials, n_arms)
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 51</span><span><span style="color:#a6d189">        Value function for each arm at each trial.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 52</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 53</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 54</span><span>    actions <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_trials,), dtype<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>int32)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 55</span><span>    gains <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_trials,), dtype<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>int32)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 56</span><span>    losses <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_trials,), dtype<span style="color:#99d1db;font-weight:bold">=</span>np<span style="color:#99d1db;font-weight:bold">.</span>int32)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 57</span><span>    Qs <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_trials, n_arms))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 58</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 59</span><span>    <span style="color:#737994;font-style:italic"># initial uniform values for both reward and punishment value function</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 60</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 61</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 62</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 63</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 64</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 66</span><span>    Qs[<span style="color:#ef9f76">0</span>] <span style="color:#99d1db;font-weight:bold">=</span> Q_rew <span style="color:#99d1db;font-weight:bold">+</span> Q_pun
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 67</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 68</span><span>    <span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n_trials):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 69</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 70</span><span>        <span style="color:#737994;font-style:italic"># choose the action based of softmax function</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 71</span><span>        prob_a <span style="color:#99d1db;font-weight:bold">=</span> softmax(Qs[i])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 72</span><span>        a <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>choice(a<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">range</span>(n_arms), p<span style="color:#99d1db;font-weight:bold">=</span>prob_a) <span style="color:#737994;font-style:italic"># select the action</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 73</span><span>        <span style="color:#737994;font-style:italic"># list of actions that were not selected</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 74</span><span>        a_left <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(<span style="color:#99d1db">range</span>(n_arms)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 75</span><span>        a_left<span style="color:#99d1db;font-weight:bold">.</span>remove(a) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 76</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 77</span><span>        <span style="color:#737994;font-style:italic"># reward </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 78</span><span>        <span style="color:#ca9ee6">if</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>rand() <span style="color:#99d1db;font-weight:bold">&lt;</span> rew_prob[a]: <span style="color:#737994;font-style:italic"># if arm brings reward</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 79</span><span>            r <span style="color:#99d1db;font-weight:bold">=</span> rew_vals[<span style="color:#ef9f76">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 80</span><span>        <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 81</span><span>            r <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 82</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 83</span><span>        gains[i] <span style="color:#99d1db;font-weight:bold">=</span> r
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 84</span><span>        <span style="color:#737994;font-style:italic"># value function update for a chosen arm</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 85</span><span>        Q_rew[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_rew <span style="color:#99d1db;font-weight:bold">*</span> (rew_sens<span style="color:#99d1db;font-weight:bold">*</span>r <span style="color:#99d1db;font-weight:bold">-</span> Q_rew[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 86</span><span>        <span style="color:#737994;font-style:italic"># value function update for non-chosen arms</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 87</span><span>        <span style="color:#ca9ee6">for</span> a_l <span style="color:#99d1db;font-weight:bold">in</span> a_left:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 88</span><span>            Q_rew[a_l] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_rew<span style="color:#99d1db;font-weight:bold">*</span>(<span style="color:#99d1db;font-weight:bold">-</span>Q_rew[a_l])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 89</span><span>                
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 90</span><span>        <span style="color:#737994;font-style:italic"># punishment</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 91</span><span>        <span style="color:#ca9ee6">if</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>rand() <span style="color:#99d1db;font-weight:bold">&lt;</span> pun_prob[a]:  <span style="color:#737994;font-style:italic"># if arm brings punishment</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 92</span><span>            r <span style="color:#99d1db;font-weight:bold">=</span> rew_vals[<span style="color:#ef9f76">1</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 93</span><span>        <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 94</span><span>            r <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 95</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 96</span><span>        losses[i] <span style="color:#99d1db;font-weight:bold">=</span> r
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 97</span><span>        Q_pun[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_pun <span style="color:#99d1db;font-weight:bold">*</span> (pun_sens<span style="color:#99d1db;font-weight:bold">*</span>r <span style="color:#99d1db;font-weight:bold">-</span> Q_pun[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 98</span><span>        <span style="color:#ca9ee6">for</span> a_l <span style="color:#99d1db;font-weight:bold">in</span> a_left:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 99</span><span>            Q_pun[a_l] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_pun<span style="color:#99d1db;font-weight:bold">*</span>(<span style="color:#99d1db;font-weight:bold">-</span>Q_pun[a_l])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">100</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">101</span><span>        <span style="color:#737994;font-style:italic"># save the records</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">102</span><span>        actions[i] <span style="color:#99d1db;font-weight:bold">=</span> a
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">103</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">104</span><span>        <span style="color:#ca9ee6">if</span> i <span style="color:#99d1db;font-weight:bold">&lt;</span> n_trials<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">1</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">105</span><span>            Qs[i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>] <span style="color:#99d1db;font-weight:bold">=</span> Q_rew <span style="color:#99d1db;font-weight:bold">+</span> Q_pun
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">106</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">107</span><span>    <span style="color:#ca9ee6">return</span> actions, gains, losses, Qs
</span></span></code></pre></div></p>
</details>
<br>
<p>Initial parameters:</p>
<ul>
<li>Probabilities of reward for each option are: 10%, 30%, 60% and 90%.</li>
<li>Probabilities of punishment for each option are: 90%, 60%, 30% and 10%.</li>
<li>Value of the reward is $+1$, value of the punishment is $-1$.</li>
<li>Each group (CTR and TRT) will consist of 10 subjects.</li>
<li>Each subject will perform 200 trials.</li>
</ul>
<center><img src ="bandit.png" width="400"></img></center>
<p>We can see, that an &ldquo;ideal&rdquo; agent would learn that 4-th option is the best choice to maximize the total reward, since it has the highest probability of reward and lowest probability of punishment.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># initial parameters</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>rew_probs <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>array([<span style="color:#ef9f76">.1</span>, <span style="color:#ef9f76">.3</span>, <span style="color:#ef9f76">.6</span>, <span style="color:#ef9f76">.9</span>]) <span style="color:#737994;font-style:italic"># probability of reward of each arm</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>pun_probs <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>array([<span style="color:#ef9f76">.9</span>, <span style="color:#ef9f76">.6</span>, <span style="color:#ef9f76">.3</span>, <span style="color:#ef9f76">.1</span>]) <span style="color:#737994;font-style:italic"># probability of punishment of each arm</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>rew_vals <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>array([<span style="color:#ef9f76">1</span>, <span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">1</span>]) <span style="color:#737994;font-style:italic"># reward = 1, punishment = -1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>n_subj <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">10</span> <span style="color:#737994;font-style:italic"># n subjects in each group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>n_arms <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>n_trials <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">200</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span><span style="color:#737994;font-style:italic"># ids of agents</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>ids <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;Control&#39;</span>: <span style="color:#99d1db">list</span>(<span style="color:#99d1db">range</span>(<span style="color:#ef9f76">1</span>, <span style="color:#ef9f76">11</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>       <span style="color:#a6d189">&#39;Treatment&#39;</span>: <span style="color:#99d1db">list</span>(<span style="color:#99d1db">range</span>(<span style="color:#ef9f76">11</span>, <span style="color:#ef9f76">21</span>))}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>params <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#a6d189">&#39;alpha_rew&#39;</span>, <span style="color:#a6d189">&#39;alpha_pun&#39;</span>, <span style="color:#a6d189">&#39;R&#39;</span>, <span style="color:#a6d189">&#39;P&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>param_names <span style="color:#99d1db;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#a6d189">&#39;alpha_rew&#39;</span>: <span style="color:#a6d189">&#39;Learning rate (reward)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    <span style="color:#a6d189">&#39;alpha_pun&#39;</span>: <span style="color:#a6d189">&#39;Learning rate (punishment)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    <span style="color:#a6d189">&#39;R&#39;</span>: <span style="color:#a6d189">&#39;Reward sensitivity&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    <span style="color:#a6d189">&#39;P&#39;</span>: <span style="color:#a6d189">&#39;Punishment sensitivity&#39;</span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># data generation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>seed(<span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>agent_data <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>true_params <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span><span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values()):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    true_params[subj] <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    <span style="color:#ca9ee6">if</span> subj <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Control&#39;</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        <span style="color:#737994;font-style:italic"># control group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        group <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Control&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        alpha_rew <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">30</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">50</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">100</span> <span style="color:#737994;font-style:italic"># RV in [0.3, 0.5]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        alpha_pun <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">20</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">40</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">100</span> <span style="color:#737994;font-style:italic"># RV in [0.2, 0.4]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>        rew_sens <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">20</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">50</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span> <span style="color:#737994;font-style:italic"># RV in [2., 5.]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>        pun_sens <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">30</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">70</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span> <span style="color:#737994;font-style:italic"># RV in [3., 7.]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    <span style="color:#ca9ee6">elif</span> subj <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Treatment&#39;</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>        <span style="color:#737994;font-style:italic"># treatment group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>        group <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;Treatment&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        alpha_rew <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">10</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">25</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">100</span> <span style="color:#737994;font-style:italic"># RV in [0.1, 0.25]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        alpha_pun <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">20</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">40</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">100</span> <span style="color:#737994;font-style:italic"># RV in [0.2, 0.4]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>        rew_sens <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">15</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">50</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span> <span style="color:#737994;font-style:italic"># RV in [1., 5.]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>        pun_sens <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">30</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">70</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span> <span style="color:#737994;font-style:italic"># RV in [3., 7.]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>        <span style="color:#ca9ee6">raise</span> <span style="color:#ef9f76">ValueError</span>(<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;No subject with id </span><span style="color:#a6d189">{</span>subj<span style="color:#a6d189">}</span><span style="color:#a6d189"> found!&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>    actions, gain, loss, Qs <span style="color:#99d1db;font-weight:bold">=</span> generate_agent_data(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>        alpha_rew<span style="color:#99d1db;font-weight:bold">=</span>alpha_rew, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>        alpha_pun<span style="color:#99d1db;font-weight:bold">=</span>alpha_pun,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>        rew_sens<span style="color:#99d1db;font-weight:bold">=</span>rew_sens,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>        pun_sens<span style="color:#99d1db;font-weight:bold">=</span>pun_sens,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>        rew_prob<span style="color:#99d1db;font-weight:bold">=</span>rew_probs,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>        pun_prob<span style="color:#99d1db;font-weight:bold">=</span>pun_probs,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>        rew_vals<span style="color:#99d1db;font-weight:bold">=</span>rew_vals,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>        n_trials<span style="color:#99d1db;font-weight:bold">=</span>n_trials)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>    <span style="color:#737994;font-style:italic"># add generated data to temporary data frame</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span>    temp_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>        <span style="color:#a6d189">&#39;group&#39;</span>: group, <span style="color:#a6d189">&#39;subjID&#39;</span>: subj, <span style="color:#a6d189">&#39;trial&#39;</span>: <span style="color:#99d1db">range</span>(<span style="color:#ef9f76">1</span>, n_trials<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>        <span style="color:#a6d189">&#39;choice&#39;</span>: actions<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>, <span style="color:#a6d189">&#39;gain&#39;</span>: gain, <span style="color:#a6d189">&#39;loss&#39;</span>: loss})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">41</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">42</span><span>    agent_data <span style="color:#99d1db;font-weight:bold">=</span> agent_data<span style="color:#99d1db;font-weight:bold">.</span>append(temp_df)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">43</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">44</span><span>    <span style="color:#737994;font-style:italic"># update dictionary with true parameter values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">45</span><span>    true_params[subj][<span style="color:#a6d189">&#39;alpha_rew&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> alpha_rew
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">46</span><span>    true_params[subj][<span style="color:#a6d189">&#39;alpha_pun&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> alpha_pun
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">47</span><span>    true_params[subj][<span style="color:#a6d189">&#39;R&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> rew_sens
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">48</span><span>    true_params[subj][<span style="color:#a6d189">&#39;P&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> pun_sens
</span></span></code></pre></div></p>
</details>
<br>
<p>Sample of generated data:</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="0" class="dataframe">
<caption>
<span id="tab:unnamed-chunk-2">Table 1: </span>Sample of the generated data 
</caption>
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>subjID</th>
      <th>trial</th>
      <th>choice</th>
      <th>gain</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Control</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Control</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Control</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Control</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Control</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Control</td>
      <td>1</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Control</td>
      <td>1</td>
      <td>7</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Control</td>
      <td>1</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Control</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Control</td>
      <td>1</td>
      <td>10</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
<p>Even though this data is generated, that&rsquo;s the exact data you can get from a real behavioral experiment. Each row in a dataset represents a trial for a particular subject. <code>choice</code> column represents the option chosen, <code>gain</code> and <code>loss</code> represent the reward and punishment values for a given trial. Full generated data set can be found <a href="https://github.com/ruslan-kl/rklymentiev.com/blob/master/content/post/computational-models-of-behavior-pt1/agent_data.csv" target="_blank" rel="noopener">here</a>.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>true_params_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame(true_params)<span style="color:#99d1db;font-weight:bold">.</span>T<span style="color:#99d1db;font-weight:bold">.</span>reset_index(drop<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">False</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>true_params_df<span style="color:#99d1db;font-weight:bold">.</span>rename(columns<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;index&#39;</span>: <span style="color:#a6d189">&#39;subjID&#39;</span>}, inplace<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>true_params_df[<span style="color:#a6d189">&#39;group&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> true_params_df[<span style="color:#a6d189">&#39;subjID&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>apply(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    <span style="color:#ca9ee6">lambda</span> x: <span style="color:#a6d189">&#39;Control&#39;</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Control&#39;</span>] <span style="color:#ca9ee6">else</span> (
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>        <span style="color:#a6d189">&#39;Treatment&#39;</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Treatment&#39;</span>] <span style="color:#ca9ee6">else</span> <span style="color:#a6d189">&#39;Undefined&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>    )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># plot boxplots with true parameter values for each group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>figure(figsize<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">11</span>,<span style="color:#ef9f76">6</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">for</span> (i, param) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(params):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>subplot(<span style="color:#ef9f76">2</span>,<span style="color:#ef9f76">2</span>,i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    sns<span style="color:#99d1db;font-weight:bold">.</span>boxplot(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>        y<span style="color:#99d1db;font-weight:bold">=</span>param, x<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;group&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        data<span style="color:#99d1db;font-weight:bold">=</span>true_params_df, linewidth<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">3</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>        palette<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Set3&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    sns<span style="color:#99d1db;font-weight:bold">.</span>stripplot(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>        y<span style="color:#99d1db;font-weight:bold">=</span>param, x<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;group&#39;</span>, data<span style="color:#99d1db;font-weight:bold">=</span>true_params_df,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        jitter<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0.1</span>, linewidth<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>, palette<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Set3&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    <span style="color:#ca9ee6">if</span> i <span style="color:#99d1db;font-weight:bold">&lt;</span> <span style="color:#ef9f76">2</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim([<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">.55</span>]) <span style="color:#737994;font-style:italic"># use the same scale for each parameter type</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;Group&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim([<span style="color:#ef9f76">1</span>, <span style="color:#ef9f76">8</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>ylabel(<span style="color:#a6d189">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>title(param_names[param], fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>suptitle(<span style="color:#a6d189">&#39;True parameters of agents&#39;</span>, fontsize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">15</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>tight_layout()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/computational-models-of-behavior-pt1/output_16_0_hu2835811890857217553.webp 400w,
               /tutorial/computational-models-of-behavior-pt1/output_16_0_hu15373500815932547867.webp 760w,
               /tutorial/computational-models-of-behavior-pt1/output_16_0_hu5567279669946567788.webp 1200w"
               src="/tutorial/computational-models-of-behavior-pt1/output_16_0_hu2835811890857217553.webp"
               width="760"
               height="415"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>That&rsquo;s how <strong>true</strong> parameters are distributed. Visually, it looks like TRT group on average has a lower learning rate for positive feedback compared to CTR.</p>
<div class="flex px-4 py-3 mb-6 rounded-md bg-yellow-100 dark:bg-yellow-900">
<span class="pr-3 pt-1 text-red-400">
  <svg height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0zM12 15.75h.007v.008H12z"/></svg>
</span>
  <span class="dark:text-neutral-300">Reminder, that we don&rsquo;t have information about the true parameter values in real life. We have access to them here since we are working with the simulated data.</span>
</div>
<h2 id="maximum-likelihood-estimation">Maximum Likelihood Estimation</h2>
<p>Now we want to recover the parameters of subjects and basically check if our hypothesis is true and treatment affects the learning rate for positive feedback and sensitivity to a reward. As told before, there are two main approaches to do this, fitting the model using MLE and Bayesian way. Here we will focus on the MLE.</p>
<p>The idea of MLE is pretty simple, however, math under the hood is a bit more sophisticated. We want to find such set of parameters $\hat{\Theta} = { \\{ \alpha^{\text{reward}}, \alpha^{\text{punishment}}, R, P \\} } $, that is more likely to be true. In a simplified version, one can start it by choosing 4 random values for $\hat{\Theta}$, putting them into the algorithm described in <a href="#data-generation">data generation part</a>, and then answering the question &ldquo;What is the probability that actions were selected given these four parameters&rdquo; (or in a notation way, $P(\text{data}|\Theta)$). After this, one would have to change the values and answer the same question again for a new set of values. After $n$ of such runs, the winning set of parameters is the one that gives the <strong>highest</strong> probability of the data occurrence. Or in other words, it is the maximum likelihood estimator.</p>
<p>But of course, no one would do that by hand and we can use function optimization techniques to deal with it. In Python we can use <code>minimize</code> function from SciPy package to find the estimated values with the help of <a href="https://en.wikipedia.org/wiki/Limited-memory_BFGS" target="_blank" rel="noopener">limited-memory Broyden–Fletcher–Goldfarb–Shanno algorithm</a>. This algorithm is a variation of a <a href="https://en.wikipedia.org/wiki/Gradient_descent" target="_blank" rel="noopener">gradient descent optimization method</a>.</p>
<p>Since the function is looking for a <em>minimum</em> value, we will change the sign of likelihood in our function (and now function <code>minimize</code> will find the minimum value, while it is actually the highest). Also, we are going to use the <a href="https://en.wikipedia.org/wiki/Likelihood_function#Log-likelihood" target="_blank" rel="noopener">logarithm of likelihood</a>, not the likelihood value itself.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  1</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">log_lik</span>(x, <span style="color:#99d1db;font-weight:bold">*</span>args):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  2</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  3</span><span><span style="color:#a6d189">    Sum of negative log likelihoods over all trials.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  4</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  5</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  6</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  7</span><span><span style="color:#a6d189">    x : tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  8</span><span><span style="color:#a6d189">        Parameters to estimate by MLE fit.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  9</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 10</span><span><span style="color:#a6d189">    args: tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 11</span><span><span style="color:#a6d189">        Input parameters for the model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 12</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 13</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 14</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 15</span><span><span style="color:#a6d189">        Sum of negative log likelihoods.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 16</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 18</span><span>    alpha_rew, alpha_pun, rew_sens, pun_sens <span style="color:#99d1db;font-weight:bold">=</span> x <span style="color:#737994;font-style:italic"># parameters to estimate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 19</span><span>    n_arms, actions, gain, loss <span style="color:#99d1db;font-weight:bold">=</span> args <span style="color:#737994;font-style:italic"># input values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 21</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 22</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 24</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 25</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 27</span><span>    log_prob_actions <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#99d1db">len</span>(actions), n_arms)) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 29</span><span>    <span style="color:#ca9ee6">for</span> i, (a, g, l) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(<span style="color:#99d1db">zip</span>(actions, gain, loss)):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 31</span><span>        a_left <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(<span style="color:#99d1db">range</span>(n_arms)) <span style="color:#737994;font-style:italic"># actions that were not selected</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 32</span><span>        a_left<span style="color:#99d1db;font-weight:bold">.</span>remove(a)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 34</span><span>        log_prob_action <span style="color:#99d1db;font-weight:bold">=</span> log_softmax(Q_rew <span style="color:#99d1db;font-weight:bold">+</span> Q_pun)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 35</span><span>        log_prob_actions[i] <span style="color:#99d1db;font-weight:bold">=</span> log_prob_action[a]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 37</span><span>        Q_rew[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_rew <span style="color:#99d1db;font-weight:bold">*</span> (rew_sens<span style="color:#99d1db;font-weight:bold">*</span>g <span style="color:#99d1db;font-weight:bold">-</span> Q_rew[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 38</span><span>        <span style="color:#ca9ee6">for</span> a_l <span style="color:#99d1db;font-weight:bold">in</span> a_left:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 39</span><span>            Q_rew[a_l] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_rew<span style="color:#99d1db;font-weight:bold">*</span>(<span style="color:#99d1db;font-weight:bold">-</span>Q_rew[a_l])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 41</span><span>        Q_pun[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_pun <span style="color:#99d1db;font-weight:bold">*</span> (pun_sens<span style="color:#99d1db;font-weight:bold">*</span>l <span style="color:#99d1db;font-weight:bold">-</span> Q_pun[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 42</span><span>        <span style="color:#ca9ee6">for</span> a_l <span style="color:#99d1db;font-weight:bold">in</span> a_left:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 43</span><span>            Q_pun[a_l] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_pun<span style="color:#99d1db;font-weight:bold">*</span>(<span style="color:#99d1db;font-weight:bold">-</span>Q_pun[a_l])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 44</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 45</span><span>    <span style="color:#ca9ee6">return</span> <span style="color:#99d1db;font-weight:bold">-</span>np<span style="color:#99d1db;font-weight:bold">.</span>sum(log_prob_actions)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 46</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 47</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 48</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">mle_fit</span>(x0, fun, params, bounds):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 49</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 50</span><span><span style="color:#a6d189">    Fit model parameters using MLE approach.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 51</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 52</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 53</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 54</span><span><span style="color:#a6d189">    x0 : array-like
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 55</span><span><span style="color:#a6d189">        Initial value for each of the parameter.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 56</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 57</span><span><span style="color:#a6d189">    fun : function
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 58</span><span><span style="color:#a6d189">        Function name to use for optimization.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 59</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 60</span><span><span style="color:#a6d189">    params : list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 61</span><span><span style="color:#a6d189">        List of parameter names.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 62</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 63</span><span><span style="color:#a6d189">    bounds : tuple
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 64</span><span><span style="color:#a6d189">        Tuple of the lower and upper bounds for parameters.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 65</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 66</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 67</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 68</span><span><span style="color:#a6d189">    output : dict
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 69</span><span><span style="color:#a6d189">        Dictionary with the estimated parameters for each agent.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 70</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 71</span><span><span style="color:#a6d189">    Example call
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 72</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 73</span><span><span style="color:#a6d189">    mle_fit(
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 74</span><span><span style="color:#a6d189">        x0=[0.5, 2], fun=logLike,
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 75</span><span><span style="color:#a6d189">        params=[&#39;alpha&#39;, &#39;beta&#39;],
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 76</span><span><span style="color:#a6d189">        bounds=((0.1, 1), (0, 10))
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 77</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 78</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 79</span><span>    output <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 80</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 81</span><span>    <span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> tqdm(agent_data[<span style="color:#a6d189">&#39;subjID&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>unique(), desc<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#e78284">f</span><span style="color:#a6d189">&#39;Fit with x0: </span><span style="color:#a6d189">{</span>x0<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 82</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 83</span><span>        output[subj] <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 84</span><span>        cond <span style="color:#99d1db;font-weight:bold">=</span> agent_data[<span style="color:#a6d189">&#39;subjID&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> subj
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 85</span><span>        actions <span style="color:#99d1db;font-weight:bold">=</span> (agent_data[cond][<span style="color:#a6d189">&#39;choice&#39;</span>] <span style="color:#99d1db;font-weight:bold">-</span> <span style="color:#ef9f76">1</span>)<span style="color:#99d1db;font-weight:bold">.</span>to_list()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 86</span><span>        gain <span style="color:#99d1db;font-weight:bold">=</span> agent_data[cond][<span style="color:#a6d189">&#39;gain&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>to_list()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 87</span><span>        loss <span style="color:#99d1db;font-weight:bold">=</span> agent_data[cond][<span style="color:#a6d189">&#39;loss&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>to_list()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 88</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 89</span><span>        result <span style="color:#99d1db;font-weight:bold">=</span> minimize(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 90</span><span>            fun<span style="color:#99d1db;font-weight:bold">=</span>fun, x0<span style="color:#99d1db;font-weight:bold">=</span>x0,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 91</span><span>            method<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;L-BFGS-B&#39;</span>, <span style="color:#737994;font-style:italic"># Limited-memory Broyden–Fletcher–Goldfarb–Shanno algorithm</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 92</span><span>            args<span style="color:#99d1db;font-weight:bold">=</span>(n_arms, actions, gain, loss),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 93</span><span>            bounds<span style="color:#99d1db;font-weight:bold">=</span>bounds)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 94</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 95</span><span>        <span style="color:#ca9ee6">for</span> (j,param) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(params):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 96</span><span>            output[subj][param] <span style="color:#99d1db;font-weight:bold">=</span> result<span style="color:#99d1db;font-weight:bold">.</span>x[j]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 97</span><span>        output[subj][<span style="color:#a6d189">&#39;likelihood&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> result<span style="color:#99d1db;font-weight:bold">.</span>fun
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 98</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 99</span><span>    <span style="color:#ca9ee6">return</span> output
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">100</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">101</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">102</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">best_params</span>(all_params_list):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">103</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">104</span><span><span style="color:#a6d189">    Find the best fitting parameters from a set of parameters.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">105</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">106</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">107</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">108</span><span><span style="color:#a6d189">    all_params_list : list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">109</span><span><span style="color:#a6d189">        List with the dictionaries of fitted value.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">110</span><span><span style="color:#a6d189">        Each dictionary should look as following:
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">111</span><span><span style="color:#a6d189">        {&lt;subject&gt;: {&lt;parameter1&gt;: &lt;value&gt;, ..., &lt;likelihood&gt;: &lt;value&gt;}}
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">112</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">113</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">114</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">115</span><span><span style="color:#a6d189">    selected_params : dict
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">116</span><span><span style="color:#a6d189">        Dictionary with the best fitted values.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">117</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">118</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">119</span><span>    <span style="color:#737994;font-style:italic"># dictionary {&lt;subject&gt;: [&lt;likelihood1&gt;, &lt;likelihood2&gt;, ...]}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">120</span><span>    likelihoods <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">121</span><span>    <span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values()):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">122</span><span>        likelihoods[subj] <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">123</span><span>        <span style="color:#ca9ee6">for</span> param_set <span style="color:#99d1db;font-weight:bold">in</span> all_params_list:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">124</span><span>            likelihoods[subj]<span style="color:#99d1db;font-weight:bold">.</span>append(param_set[subj][<span style="color:#a6d189">&#39;likelihood&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">125</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">126</span><span>    <span style="color:#737994;font-style:italic"># select the lowest log likelihood among given models</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">127</span><span>    <span style="color:#737994;font-style:italic"># {&lt;subject&gt;: &lt;index of a set with the lowest log likelihood&gt;}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">128</span><span>    selected_set <span style="color:#99d1db;font-weight:bold">=</span> {subj: np<span style="color:#99d1db;font-weight:bold">.</span>argmin(lik) <span style="color:#ca9ee6">for</span> (subj, lik) <span style="color:#99d1db;font-weight:bold">in</span> likelihoods<span style="color:#99d1db;font-weight:bold">.</span>items()}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">129</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">130</span><span>    <span style="color:#737994;font-style:italic"># new set of parameters for each subject with best fitted values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">131</span><span>    selected_params <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">132</span><span>    <span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> selected_set<span style="color:#99d1db;font-weight:bold">.</span>keys():
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">133</span><span>        selected_params[subj] <span style="color:#99d1db;font-weight:bold">=</span> all_params_list[selected_set[subj]][subj]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">134</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">135</span><span>    <span style="color:#ca9ee6">return</span> selected_params
</span></span></code></pre></div></p>
</details>
<br>
<h3 id="different-starting-values">Different starting values</h3>
<p>Before we start fitting, there is one big issue with MLE that we should be aware of. The algorithm can be stuck in a <a href="https://en.wikipedia.org/wiki/Local_optimum" target="_blank" rel="noopener">local minimum</a>, meaning that the found set of parameters is not optimal in the <em>entire</em> parameter space. One of the ways to deal with this problem is to use several starting points. Here we will run MLE for 10 random starting values and choose the set that gives the minimum negative log likelihood for each subject.</p>
<p>We will also use bounds for the parameters (learning rates should be in a range $\[ 0, 1\]$ and sensitivities should be in a range $\[ 0, 8 \]$), however Daw (2009)<sup id="fnref1:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> argues against that.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>all_mle_params <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(<span style="color:#ef9f76">10</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    <span style="color:#737994;font-style:italic"># generate random initial values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>seed(i)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    alpha0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>random(size<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">2</span>,))<span style="color:#99d1db;font-weight:bold">.</span>round(<span style="color:#ef9f76">2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    sens0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">80</span>, size<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">2</span>,)) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    x0 <span style="color:#99d1db;font-weight:bold">=</span> alpha0 <span style="color:#99d1db;font-weight:bold">+</span> sens0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    mle_output <span style="color:#99d1db;font-weight:bold">=</span> mle_fit(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        x0<span style="color:#99d1db;font-weight:bold">=</span>x0, fun<span style="color:#99d1db;font-weight:bold">=</span>log_lik,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        params<span style="color:#99d1db;font-weight:bold">=</span>params,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        bounds<span style="color:#99d1db;font-weight:bold">=</span>((<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">8</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">8</span>)))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    all_mle_params<span style="color:#99d1db;font-weight:bold">.</span>append(mle_output)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>selected_params <span style="color:#99d1db;font-weight:bold">=</span> best_params(all_mle_params)
</span></span></code></pre></div><pre><code>Fit with x0: [0.55, 0.72, 6.7, 6.7]: 100%|██████████| 20/20 [00:38&lt;00:00,  1.91s/it]
Fit with x0: [0.42, 0.72, 0.9, 7.5]: 100%|██████████| 20/20 [00:36&lt;00:00,  1.81s/it]
Fit with x0: [0.44, 0.03, 2.2, 4.3]: 100%|██████████| 20/20 [00:35&lt;00:00,  1.78s/it]
Fit with x0: [0.55, 0.71, 5.6, 7.2]: 100%|██████████| 20/20 [00:27&lt;00:00,  1.38s/it]
Fit with x0: [0.97, 0.55, 0.1, 7.2]: 100%|██████████| 20/20 [00:45&lt;00:00,  2.25s/it]
Fit with x0: [0.22, 0.87, 1.6, 7.3]: 100%|██████████| 20/20 [00:34&lt;00:00,  1.74s/it]
Fit with x0: [0.89, 0.33, 7.9, 6.2]: 100%|██████████| 20/20 [00:39&lt;00:00,  1.98s/it]
Fit with x0: [0.08, 0.78, 6.7, 2.3]: 100%|██████████| 20/20 [00:34&lt;00:00,  1.75s/it]
Fit with x0: [0.87, 0.97, 0.5, 0.8]: 100%|██████████| 20/20 [00:38&lt;00:00,  1.91s/it]
Fit with x0: [0.01, 0.5, 5.4, 5.6]: 100%|██████████| 20/20 [00:41&lt;00:00,  2.09s/it]
</code></pre>
</p>
</details>
<br>
<p>Once we have selected the best fitting values, the following questions may arise:</p>
<ul>
<li>Are we sure that the selected values represent the global minimum? We are not sure.</li>
<li>Were 10 initial starting points enough? We don&rsquo;t know.</li>
<li>Would another optimization method find a better set of parameters? It could, but the overview of different optimization methods is beyond the scope of this article.</li>
</ul>
<p>It may sound vague, but that&rsquo;s the sad truth about MLE, we are never sure that we&rsquo;ve found the best parameters. Although, by trying different methods and initial values we can make it as good as possible.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># convert dict to dataframe</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>mle_params_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame(selected_params)<span style="color:#99d1db;font-weight:bold">.</span>T<span style="color:#99d1db;font-weight:bold">.</span>reset_index(drop<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">False</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>mle_params_df<span style="color:#99d1db;font-weight:bold">.</span>rename(columns<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;index&#39;</span>: <span style="color:#a6d189">&#39;subjID&#39;</span>}, inplace<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>mle_params_df[<span style="color:#a6d189">&#39;group&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> mle_params_df[<span style="color:#a6d189">&#39;subjID&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>apply(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>    <span style="color:#ca9ee6">lambda</span> x: <span style="color:#a6d189">&#39;Control&#39;</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Control&#39;</span>] <span style="color:#ca9ee6">else</span> (
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>        <span style="color:#a6d189">&#39;Treatment&#39;</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">in</span> ids[<span style="color:#a6d189">&#39;Treatment&#39;</span>] <span style="color:#ca9ee6">else</span> <span style="color:#a6d189">&#39;Undefined&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span>    )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">8</span><span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># plot estimated parameters</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>figure(figsize<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">11</span>,<span style="color:#ef9f76">6</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">for</span> (i, param) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(params):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>subplot(<span style="color:#ef9f76">2</span>,<span style="color:#ef9f76">2</span>,i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    sns<span style="color:#99d1db;font-weight:bold">.</span>boxplot(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>        y<span style="color:#99d1db;font-weight:bold">=</span>param, x<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;group&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        data<span style="color:#99d1db;font-weight:bold">=</span>mle_params_df, linewidth<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">3</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>        palette<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Set3&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    sns<span style="color:#99d1db;font-weight:bold">.</span>stripplot(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>        y<span style="color:#99d1db;font-weight:bold">=</span>param, x<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;group&#39;</span>, data<span style="color:#99d1db;font-weight:bold">=</span>mle_params_df,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        jitter<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0.1</span>, linewidth<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>, palette<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Set3&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    <span style="color:#ca9ee6">if</span> i <span style="color:#99d1db;font-weight:bold">&lt;</span> <span style="color:#ef9f76">2</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim([<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">0.05</span>, <span style="color:#ef9f76">1.05</span>]) <span style="color:#737994;font-style:italic"># use the same scale for each parameter type</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;Group&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim([<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">12</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>ylabel(<span style="color:#a6d189">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>title(param_names[param], fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>suptitle(<span style="color:#a6d189">&#39;Estimated parameters of agents (MLE)&#39;</span>, fontsize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">15</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>tight_layout()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/computational-models-of-behavior-pt1/output_24_0_hu10307520599994425952.webp 400w,
               /tutorial/computational-models-of-behavior-pt1/output_24_0_hu4752979116956575957.webp 760w,
               /tutorial/computational-models-of-behavior-pt1/output_24_0_hu3725157466715075695.webp 1200w"
               src="/tutorial/computational-models-of-behavior-pt1/output_24_0_hu10307520599994425952.webp"
               width="760"
               height="415"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>Now, we can actually estimate how good the selected parameters are.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># plot estimated parameters vs true parameters</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>figure(figsize<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">8</span>,<span style="color:#ef9f76">8</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#ca9ee6">for</span> (i,param) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(params):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>subplot(<span style="color:#ef9f76">2</span>,<span style="color:#ef9f76">2</span>,i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>axis(<span style="color:#a6d189">&#39;square&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    sns<span style="color:#99d1db;font-weight:bold">.</span>scatterplot(x<span style="color:#99d1db;font-weight:bold">=</span>mle_params_df[param], y<span style="color:#99d1db;font-weight:bold">=</span>true_params_df[param])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    r_coef <span style="color:#99d1db;font-weight:bold">=</span> pg<span style="color:#99d1db;font-weight:bold">.</span>corr(true_params_df[param], mle_params_df[param])[<span style="color:#a6d189">&#39;r&#39;</span>][<span style="color:#ef9f76">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    p_val <span style="color:#99d1db;font-weight:bold">=</span> pg<span style="color:#99d1db;font-weight:bold">.</span>corr(true_params_df[param], mle_params_df[param])[<span style="color:#a6d189">&#39;p-val&#39;</span>][<span style="color:#ef9f76">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    <span style="color:#ca9ee6">if</span> i <span style="color:#99d1db;font-weight:bold">&lt;</span> <span style="color:#ef9f76">2</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        lim <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>,<span style="color:#ef9f76">1</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>plot(lim, lim, ls<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#34;--&#34;</span>, c<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#34;.3&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlim(lim)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim(lim)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>        lim <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>,<span style="color:#ef9f76">10</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>plot(lim, lim, ls<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#34;--&#34;</span>, c<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#34;.3&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlim(lim)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylim(lim)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;MLE&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>ylabel(<span style="color:#a6d189">&#39;True&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>title(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>        <span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>param_names[param]<span style="color:#a6d189">}</span><span style="color:#8caaee">\n</span><span style="color:#a6d189">r = </span><span style="color:#a6d189">{</span>r_coef<span style="color:#a6d189">:</span><span style="color:#a6d189">.2f</span><span style="color:#a6d189">}</span><span style="color:#a6d189"> (p-val = </span><span style="color:#a6d189">{</span>p_val<span style="color:#a6d189">:</span><span style="color:#a6d189">.2f</span><span style="color:#a6d189">}</span><span style="color:#a6d189">)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>        fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>tight_layout()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/computational-models-of-behavior-pt1/output_26_0_hu6778021832051829288.webp 400w,
               /tutorial/computational-models-of-behavior-pt1/output_26_0_hu4462163613190219873.webp 760w,
               /tutorial/computational-models-of-behavior-pt1/output_26_0_hu3585626775395368144.webp 1200w"
               src="/tutorial/computational-models-of-behavior-pt1/output_26_0_hu6778021832051829288.webp"
               width="576"
               height="576"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>In the perfect world, all dots would lie on a diagonal line, meaning that fitted values (on the $x$ axis) match the real values (on the $y$ axis). In our case, we can see that MLE fit recovered values for reward sensitivity quite accurately, whereas punishment sensitivity values are not that aligned.</p>
<div class="flex px-4 py-3 mb-6 rounded-md bg-yellow-100 dark:bg-yellow-900">
<span class="pr-3 pt-1 text-red-400">
  <svg height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0zM12 15.75h.007v.008H12z"/></svg>
</span>
  <span class="dark:text-neutral-300">Yet another reminder, that we are able to make this type of comparison since we are using the generated data. In real life, we don&rsquo;t have access to the true parameters.</span>
</div>
<p>Another caution is that we have 2 estimated values for punishment sensitivity that are equal to or are really close to 8, which was the upper threshold for the optimizing function. This could mean that a better fitting value lies beyond the threshold value.</p>
<h2 id="model-comparison">Model Comparison</h2>
<p>By this point we have found the set of parameters for a model that fit data quite well, but what if our model is wrong? MLE will always return a set of best-fitting parameters, but if the chosen model doesn&rsquo;t represent the actual mechanism of subjects&rsquo; decision making, the results are unreliable. One can deal with such an issue by trying out several models and comparing them.</p>
<p>What if our subjects don&rsquo;t really have the &ldquo;competing&rdquo; sides of positive and negative feedback and the learning rate and sensitivity are the same for both types of an outcome? We will also fit model to data and call this model &ldquo;No Competition&rdquo;. Another possible scenario is that subjects don&rsquo;t update the action values for non-selected actions. We will call this model &ldquo;No update&rdquo;. The model that we have fit before will be called &ldquo;Full Model&rdquo;.</p>
<p>Now, in order to check these models, we just have to change the log likelihood function that we want to optimize. Once we find the likelihoods of the model, we can compare the models. There are several ways of doing it, but the most common ones are with the help of Akaike information criterion (AIC) or Bayesian information criterion (BIC):</p>
$$AIC = 2k - 2 \text{ln} (\mathcal{\hat{L}})$$$$BIC = k \ \text{ln}(n) - 2 \text{ln} (\mathcal{\hat{L}})$$<ul>
<li>$k$ - number of estimated parameters in the model</li>
<li>$\mathcal{\hat{L}}$ - maximum value of the likelihood function for the model</li>
<li>$n$ - the number of observations (number of trials in our case)</li>
</ul>
<p>The first part for both equations (before the minus sign) represents the model complexity, whereas the second part (after the minus sign) represents the model performance. Basically, both criteria are looking for a better performing and less complex model. In practice, the lower the values, the better.</p>
<p><b>Model algorithm for &ldquo;No Competition&rdquo; model</b>:</p>
<ul>
<li><strong>for</strong> <em>each step $t$ in episode</em> <strong>do</strong>
<ul>
<li>Select action $a_t$ using softmax policy $\scriptsize P(a_j = a_t) = \frac{e^{Q_j}}{\sum_{j}e^{Q_j}}$</li>
<li>Observe reward $r_t$ and punishment $p_t$ values. Outcome $\scriptsize o_t = r_t + p_t$</li>
<li><strong>for</strong> <em>each action $a_j$ in possible actions</em> <strong>do</strong>
<ul>
<li><strong>if</strong> $a_j$ == $a_t$ <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)_{t+1} \leftarrow Q(a_j)_t + \alpha \left( S \cdot o_t - Q(a_j)_t \right)$</li>
</ul>
</li>
<li><strong>else</strong>
<ul>
<li>$\scriptsize Q(a_j)_{t+1} \leftarrow Q(a_j)_t + \alpha \left( - Q(a_j)_t \right)$</li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
<p><b>Model algorithm for &ldquo;No Update&rdquo; model</b>:</p>
<ul>
<li><strong>for</strong> <em>each step $t$ in episode</em> <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)_t \leftarrow Q(a_j)^{\text{reward}}_t + Q(a_j)^{\text{punishment}}_t$</li>
<li>Select action $a_t$ using softmax policy $\scriptsize P(a_j = a_t) = \frac{e^{Q_j}}{\sum_{j}e^{Q_j}}$</li>
<li>Observe reward $r_t$ and punishment $p_t$ values</li>
<li>$\scriptsize Q(a_t)^{\text{reward}}_{t+1} - Q(a_t)^{\text{reward}}_t + \alpha^{\text{reward}} \left( R \cdot r_t - Q(a_t)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_t)^{\text{punishment}}_{t+1} \leftarrow Q(a_t)^{\text{punishment}}_t + \alpha^{\text{punishment}} \left( P \cdot p_t - Q(a_t)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  1</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">log_lik_no_compet</span>(x, <span style="color:#99d1db;font-weight:bold">*</span>args):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  2</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  3</span><span><span style="color:#a6d189">    Sum of negative log likelihoods over all trials for &#34;No Competition&#34; model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  4</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  5</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  6</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  7</span><span><span style="color:#a6d189">    x : tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  8</span><span><span style="color:#a6d189">        Parameters to estimate by MLE fit.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">  9</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 10</span><span><span style="color:#a6d189">    args: tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 11</span><span><span style="color:#a6d189">        Input parameters for the model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 12</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 13</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 14</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 15</span><span><span style="color:#a6d189">        Sum of negative log likelihoods.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 16</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 18</span><span>    alpha, outcome_sens <span style="color:#99d1db;font-weight:bold">=</span> x <span style="color:#737994;font-style:italic"># parameters to estimate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 19</span><span>    n_arms, actions, gain, loss <span style="color:#99d1db;font-weight:bold">=</span> args <span style="color:#737994;font-style:italic"># input values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 21</span><span>    Qs <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 22</span><span>    Qs <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 24</span><span>    log_prob_actions <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#99d1db">len</span>(actions), n_arms))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 26</span><span>    <span style="color:#ca9ee6">for</span> i, (a, g, l) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(<span style="color:#99d1db">zip</span>(actions, gain, loss)):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 28</span><span>        r <span style="color:#99d1db;font-weight:bold">=</span> g <span style="color:#99d1db;font-weight:bold">+</span> l
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 30</span><span>        a_left <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(<span style="color:#99d1db">range</span>(n_arms)) <span style="color:#737994;font-style:italic"># actions that were not selected</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 31</span><span>        a_left<span style="color:#99d1db;font-weight:bold">.</span>remove(a)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 32</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 33</span><span>        log_prob_action <span style="color:#99d1db;font-weight:bold">=</span> log_softmax(Qs)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 34</span><span>        log_prob_actions[i] <span style="color:#99d1db;font-weight:bold">=</span> log_prob_action[a]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 35</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 36</span><span>        Qs[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha <span style="color:#99d1db;font-weight:bold">*</span> (outcome_sens<span style="color:#99d1db;font-weight:bold">*</span>r <span style="color:#99d1db;font-weight:bold">-</span> Qs[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 37</span><span>        <span style="color:#ca9ee6">for</span> a_l <span style="color:#99d1db;font-weight:bold">in</span> a_left:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 38</span><span>            Qs[a_l] <span style="color:#99d1db;font-weight:bold">+=</span> alpha<span style="color:#99d1db;font-weight:bold">*</span>(<span style="color:#99d1db;font-weight:bold">-</span>Qs[a_l])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 40</span><span>    <span style="color:#ca9ee6">return</span> <span style="color:#99d1db;font-weight:bold">-</span>np<span style="color:#99d1db;font-weight:bold">.</span>sum(log_prob_actions)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 41</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 43</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">log_lik_no_update</span>(x, <span style="color:#99d1db;font-weight:bold">*</span>args):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 44</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 45</span><span><span style="color:#a6d189">    Sum of negative log likelihoods over all trials for &#34;No Update&#34; model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 46</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 47</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 48</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 49</span><span><span style="color:#a6d189">    x : tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 50</span><span><span style="color:#a6d189">        Parameters to estimate by MLE fit.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 51</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 52</span><span><span style="color:#a6d189">    args: tuple, list
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 53</span><span><span style="color:#a6d189">        Input parameters for the model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 54</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 55</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 56</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 57</span><span><span style="color:#a6d189">        Sum of negative log likelihoods.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 58</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 59</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 60</span><span>    alpha_rew, alpha_pun, rew_sens, pun_sens <span style="color:#99d1db;font-weight:bold">=</span> x <span style="color:#737994;font-style:italic"># parameters to estimate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 61</span><span>    n_arms, actions, gain, loss <span style="color:#99d1db;font-weight:bold">=</span> args <span style="color:#737994;font-style:italic"># input values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 62</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 63</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 64</span><span>    Q_rew <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 65</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 66</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>ones(shape<span style="color:#99d1db;font-weight:bold">=</span>(n_arms,))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 67</span><span>    Q_pun <span style="color:#99d1db;font-weight:bold">/=</span> n_arms
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 68</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 69</span><span>    log_prob_actions <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>zeros(shape<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#99d1db">len</span>(actions), n_arms))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 70</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 71</span><span>    <span style="color:#ca9ee6">for</span> i, (a, g, l) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(<span style="color:#99d1db">zip</span>(actions, gain, loss)):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 72</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 73</span><span>        log_prob_action <span style="color:#99d1db;font-weight:bold">=</span> log_softmax(Q_rew <span style="color:#99d1db;font-weight:bold">+</span> Q_pun)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 74</span><span>        log_prob_actions[i] <span style="color:#99d1db;font-weight:bold">=</span> log_prob_action[a]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 75</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 76</span><span>        Q_rew[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_rew <span style="color:#99d1db;font-weight:bold">*</span> (rew_sens<span style="color:#99d1db;font-weight:bold">*</span>g <span style="color:#99d1db;font-weight:bold">-</span> Q_rew[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 77</span><span>        Q_pun[a] <span style="color:#99d1db;font-weight:bold">+=</span> alpha_pun <span style="color:#99d1db;font-weight:bold">*</span> (pun_sens<span style="color:#99d1db;font-weight:bold">*</span>l <span style="color:#99d1db;font-weight:bold">-</span> Q_pun[a])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 78</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 79</span><span>    <span style="color:#ca9ee6">return</span> <span style="color:#99d1db;font-weight:bold">-</span>np<span style="color:#99d1db;font-weight:bold">.</span>sum(log_prob_actions)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 80</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 81</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 82</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">aic</span>(k, L):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 83</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 84</span><span><span style="color:#a6d189">    Get the value of Akaike information criterion (AIC).
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 85</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 86</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 87</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 88</span><span><span style="color:#a6d189">    k : int
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 89</span><span><span style="color:#a6d189">        Number of estimated parameters in the model
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 90</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 91</span><span><span style="color:#a6d189">    L : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 92</span><span><span style="color:#a6d189">        Logarithm of a maximum value of the likelihood function for the model
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 93</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 94</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 95</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 96</span><span><span style="color:#a6d189">        AIC value
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 97</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 98</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 99</span><span>    <span style="color:#ca9ee6">return</span> <span style="color:#ef9f76">2</span><span style="color:#99d1db;font-weight:bold">*</span>k <span style="color:#99d1db;font-weight:bold">-</span> <span style="color:#ef9f76">2</span><span style="color:#99d1db;font-weight:bold">*</span>L
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">100</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">101</span><span><span style="color:#ca9ee6">def</span> <span style="color:#8caaee">bic</span>(k, n, L):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">102</span><span>    <span style="color:#a6d189">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">103</span><span><span style="color:#a6d189">    Get the value of Bayesian information criterion (BIC).
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">104</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">105</span><span><span style="color:#a6d189">    Arguments
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">106</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">107</span><span><span style="color:#a6d189">    k : int
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">108</span><span><span style="color:#a6d189">        Number of estimated parameters in the model.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">109</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">110</span><span><span style="color:#a6d189">    n : int
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">111</span><span><span style="color:#a6d189">        The number of observations.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">112</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">113</span><span><span style="color:#a6d189">    L : float
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">114</span><span><span style="color:#a6d189">        Logarithm of a maximum value of the likelihood function for the model
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">115</span><span><span style="color:#a6d189">
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">116</span><span><span style="color:#a6d189">    Returns
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">117</span><span><span style="color:#a6d189">    ----------
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">118</span><span><span style="color:#a6d189">        BIC value
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">119</span><span><span style="color:#a6d189">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">120</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">121</span><span>    <span style="color:#ca9ee6">return</span> k<span style="color:#99d1db;font-weight:bold">*</span>np<span style="color:#99d1db;font-weight:bold">.</span>log(n) <span style="color:#99d1db;font-weight:bold">-</span> <span style="color:#ef9f76">2</span><span style="color:#99d1db;font-weight:bold">*</span>L
</span></span></code></pre></div></p>
</details>
<br>
<p>For both new models, we will also fit 10 different initial parameters and select the optimal ones before comparing models between each other.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>all_mle_params_no_compet <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(<span style="color:#ef9f76">10</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    <span style="color:#737994;font-style:italic"># generate random initial values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>seed(i)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    alpha0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">round</span>(np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>random(), <span style="color:#ef9f76">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    sens0 <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">80</span>) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    x0 <span style="color:#99d1db;font-weight:bold">=</span> [alpha0, sens0]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    mle_output <span style="color:#99d1db;font-weight:bold">=</span> mle_fit(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        x0<span style="color:#99d1db;font-weight:bold">=</span>x0, fun<span style="color:#99d1db;font-weight:bold">=</span>log_lik_no_compet,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        params<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;alpha&#39;</span>, <span style="color:#a6d189">&#39;outcome_sens&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        bounds<span style="color:#99d1db;font-weight:bold">=</span>((<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">8</span>)))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    all_mle_params_no_compet<span style="color:#99d1db;font-weight:bold">.</span>append(mle_output)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>selected_params_no_compet <span style="color:#99d1db;font-weight:bold">=</span> best_params(all_mle_params_no_compet)
</span></span></code></pre></div><pre><code>Fit with x0: [0.55, 6.4]: 100%|██████████| 20/20 [00:12&lt;00:00,  1.61it/s]
Fit with x0: [0.42, 1.2]: 100%|██████████| 20/20 [00:16&lt;00:00,  1.18it/s]
Fit with x0: [0.44, 7.2]: 100%|██████████| 20/20 [00:09&lt;00:00,  2.08it/s]
Fit with x0: [0.55, 0.3]: 100%|██████████| 20/20 [00:20&lt;00:00,  1.01s/it]
Fit with x0: [0.97, 5.5]: 100%|██████████| 20/20 [00:09&lt;00:00,  2.16it/s]
Fit with x0: [0.22, 6.1]: 100%|██████████| 20/20 [00:12&lt;00:00,  1.63it/s]
Fit with x0: [0.89, 7.9]: 100%|██████████| 20/20 [00:08&lt;00:00,  2.29it/s]
Fit with x0: [0.08, 2.5]: 100%|██████████| 20/20 [00:14&lt;00:00,  1.39it/s]
Fit with x0: [0.87, 0.5]: 100%|██████████| 20/20 [00:19&lt;00:00,  1.01it/s]
Fit with x0: [0.01, 5.4]: 100%|██████████| 20/20 [00:24&lt;00:00,  1.24s/it]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>all_mle_params_no_update <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(<span style="color:#ef9f76">10</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    <span style="color:#737994;font-style:italic"># generate random initial values</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>seed(i<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">10</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    alpha0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>random(size<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">2</span>,))<span style="color:#99d1db;font-weight:bold">.</span>round(<span style="color:#ef9f76">2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    sens0 <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(np<span style="color:#99d1db;font-weight:bold">.</span>random<span style="color:#99d1db;font-weight:bold">.</span>randint(low<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0</span>, high<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">80</span>, size<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">2</span>,)) <span style="color:#99d1db;font-weight:bold">/</span> <span style="color:#ef9f76">10</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    x0 <span style="color:#99d1db;font-weight:bold">=</span> alpha0 <span style="color:#99d1db;font-weight:bold">+</span> sens0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    mle_output <span style="color:#99d1db;font-weight:bold">=</span> mle_fit(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        x0<span style="color:#99d1db;font-weight:bold">=</span>x0, fun<span style="color:#99d1db;font-weight:bold">=</span>log_lik_no_update,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        params<span style="color:#99d1db;font-weight:bold">=</span>params,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        bounds<span style="color:#99d1db;font-weight:bold">=</span>((<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">1</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">8</span>), (<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">8</span>)))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    all_mle_params_no_update<span style="color:#99d1db;font-weight:bold">.</span>append(mle_output)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>selected_params_no_update <span style="color:#99d1db;font-weight:bold">=</span> best_params(all_mle_params_no_update)
</span></span></code></pre></div><pre><code>Fit with x0: [0.55, 0.72, 6.7, 6.7]: 100%|██████████| 20/20 [00:18&lt;00:00,  1.10it/s]
Fit with x0: [0.77, 0.02, 6.4, 2.8]: 100%|██████████| 20/20 [00:15&lt;00:00,  1.28it/s]
Fit with x0: [0.59, 0.9, 2.8, 0.9]: 100%|██████████| 20/20 [00:25&lt;00:00,  1.27s/it]
Fit with x0: [0.64, 0.38, 1.2, 2.3]: 100%|██████████| 20/20 [00:35&lt;00:00,  1.79s/it]
Fit with x0: [0.41, 0.06, 5.6, 5.0]: 100%|██████████| 20/20 [00:22&lt;00:00,  1.10s/it]
Fit with x0: [0.49, 0.23, 3.3, 0.4]: 100%|██████████| 20/20 [00:32&lt;00:00,  1.60s/it]
Fit with x0: [0.3, 0.19, 1.5, 7.2]: 100%|██████████| 20/20 [00:44&lt;00:00,  2.21s/it]
Fit with x0: [0.93, 0.87, 6.0, 5.9]: 100%|██████████| 20/20 [00:17&lt;00:00,  1.15it/s]
Fit with x0: [0.52, 0.7, 1.0, 5.0]: 100%|██████████| 20/20 [00:45&lt;00:00,  2.26s/it]
Fit with x0: [0.15, 0.16, 6.7, 3.9]: 100%|██████████| 20/20 [00:46&lt;00:00,  2.34s/it]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># combine selected value for each model in one list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>all_models <span style="color:#99d1db;font-weight:bold">=</span> [selected_params, selected_params_no_update, selected_params_no_compet]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>model_names <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#a6d189">&#39;Full Model&#39;</span>, <span style="color:#a6d189">&#39;No Update&#39;</span>, <span style="color:#a6d189">&#39;No Competition&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>metrics <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span><span style="color:#737994;font-style:italic"># dictionary will look like</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span><span style="color:#737994;font-style:italic"># {&lt;subject&gt;:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span><span style="color:#737994;font-style:italic">#     {&lt;Model Name&gt;:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span><span style="color:#737994;font-style:italic">#         {&#39;AIC&#39;: &lt;value&gt;},</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span><span style="color:#737994;font-style:italic">#         {&#39;BIC&#39;: &lt;value&gt;}</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span><span style="color:#737994;font-style:italic">#     }</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span><span style="color:#737994;font-style:italic"># }</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span><span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values()):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    metrics[subj] <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    <span style="color:#ca9ee6">for</span> (i,m) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(all_models):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        metrics[subj][model_names[i]] <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>        metrics[subj][model_names[i]][<span style="color:#a6d189">&#39;AIC&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">int</span>(aic(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>            k<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">len</span>(m[subj])<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">1</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>            L<span style="color:#99d1db;font-weight:bold">=-</span>m[subj][<span style="color:#a6d189">&#39;likelihood&#39;</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>        metrics[subj][model_names[i]][<span style="color:#a6d189">&#39;BIC&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">int</span>(bic(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>            k<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">len</span>(m[subj])<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">1</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>            n<span style="color:#99d1db;font-weight:bold">=</span>n_trials,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>            L<span style="color:#99d1db;font-weight:bold">=-</span>m[subj][<span style="color:#a6d189">&#39;likelihood&#39;</span>]))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># convert dictionary to data frame for better visualization</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>metrics_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame({})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#ca9ee6">for</span> (i, subj) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values())):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    temp <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame(metrics[subj])<span style="color:#99d1db;font-weight:bold">.</span>reset_index(drop<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">False</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    temp<span style="color:#99d1db;font-weight:bold">.</span>rename(columns<span style="color:#99d1db;font-weight:bold">=</span>{<span style="color:#a6d189">&#39;index&#39;</span>: <span style="color:#a6d189">&#39;metric&#39;</span>}, inplace<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    temp[<span style="color:#a6d189">&#39;subjID&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> subj
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    metrics_df <span style="color:#99d1db;font-weight:bold">=</span> metrics_df<span style="color:#99d1db;font-weight:bold">.</span>append(temp)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>metrics_df<span style="color:#99d1db;font-weight:bold">.</span>set_index([<span style="color:#a6d189">&#39;subjID&#39;</span>, <span style="color:#a6d189">&#39;metric&#39;</span>])<span style="color:#99d1db;font-weight:bold">.</span>style<span style="color:#99d1db;font-weight:bold">.</span>highlight_min(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    axis<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    props<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;color:black; font-weight:bold; background-color:lightgreen;&#39;</span>)
</span></span></code></pre></div></p>
</details>
<br>
<style type="text/css">
#T_e2d81_row0_col2, #T_e2d81_row1_col2, #T_e2d81_row2_col0, #T_e2d81_row3_col0, #T_e2d81_row4_col0, #T_e2d81_row5_col0, #T_e2d81_row6_col0, #T_e2d81_row7_col2, #T_e2d81_row8_col0, #T_e2d81_row9_col0, #T_e2d81_row10_col0, #T_e2d81_row11_col2, #T_e2d81_row12_col0, #T_e2d81_row13_col0, #T_e2d81_row14_col0, #T_e2d81_row15_col2, #T_e2d81_row16_col0, #T_e2d81_row17_col0, #T_e2d81_row18_col0, #T_e2d81_row19_col0, #T_e2d81_row20_col0, #T_e2d81_row21_col0, #T_e2d81_row22_col0, #T_e2d81_row23_col0, #T_e2d81_row24_col0, #T_e2d81_row25_col0, #T_e2d81_row26_col0, #T_e2d81_row27_col0, #T_e2d81_row28_col0, #T_e2d81_row29_col0, #T_e2d81_row30_col0, #T_e2d81_row31_col0, #T_e2d81_row32_col0, #T_e2d81_row33_col0, #T_e2d81_row34_col0, #T_e2d81_row35_col0, #T_e2d81_row36_col0, #T_e2d81_row37_col2, #T_e2d81_row38_col0, #T_e2d81_row39_col0 {
  color: black;
  font-weight: bold;
  background-color: lightgreen;
}
</style>
<table id="T_e2d81_">
<caption>
<span id="tab:unnamed-chunk-2">Table 2: </span>Model comparison for all subjects
</caption>
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >Full Model</th>
      <th class="col_heading level0 col1" >No Update</th>
      <th class="col_heading level0 col2" >No Competition</th>
    </tr>
    <tr>
      <th class="index_name level0" >subjID</th>
      <th class="index_name level1" >metric</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e2d81_level0_row0" class="row_heading level0 row0" rowspan="2">1</th>
      <th id="T_e2d81_level1_row0" class="row_heading level1 row0" >AIC</th>
      <td id="T_e2d81_row0_col0" class="data row0 col0" >1696</td>
      <td id="T_e2d81_row0_col1" class="data row0 col1" >1807</td>
      <td id="T_e2d81_row0_col2" class="data row0 col2" >1692</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row1" class="row_heading level1 row1" >BIC</th>
      <td id="T_e2d81_row1_col0" class="data row1 col0" >1709</td>
      <td id="T_e2d81_row1_col1" class="data row1 col1" >1821</td>
      <td id="T_e2d81_row1_col2" class="data row1 col2" >1699</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row2" class="row_heading level0 row2" rowspan="2">2</th>
      <th id="T_e2d81_level1_row2" class="row_heading level1 row2" >AIC</th>
      <td id="T_e2d81_row2_col0" class="data row2 col0" >1257</td>
      <td id="T_e2d81_row2_col1" class="data row2 col1" >1479</td>
      <td id="T_e2d81_row2_col2" class="data row2 col2" >1281</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row3" class="row_heading level1 row3" >BIC</th>
      <td id="T_e2d81_row3_col0" class="data row3 col0" >1270</td>
      <td id="T_e2d81_row3_col1" class="data row3 col1" >1492</td>
      <td id="T_e2d81_row3_col2" class="data row3 col2" >1288</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row4" class="row_heading level0 row4" rowspan="2">3</th>
      <th id="T_e2d81_level1_row4" class="row_heading level1 row4" >AIC</th>
      <td id="T_e2d81_row4_col0" class="data row4 col0" >1044</td>
      <td id="T_e2d81_row4_col1" class="data row4 col1" >1262</td>
      <td id="T_e2d81_row4_col2" class="data row4 col2" >1054</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row5" class="row_heading level1 row5" >BIC</th>
      <td id="T_e2d81_row5_col0" class="data row5 col0" >1057</td>
      <td id="T_e2d81_row5_col1" class="data row5 col1" >1275</td>
      <td id="T_e2d81_row5_col2" class="data row5 col2" >1060</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row6" class="row_heading level0 row6" rowspan="2">4</th>
      <th id="T_e2d81_level1_row6" class="row_heading level1 row6" >AIC</th>
      <td id="T_e2d81_row6_col0" class="data row6 col0" >1802</td>
      <td id="T_e2d81_row6_col1" class="data row6 col1" >1922</td>
      <td id="T_e2d81_row6_col2" class="data row6 col2" >1806</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row7" class="row_heading level1 row7" >BIC</th>
      <td id="T_e2d81_row7_col0" class="data row7 col0" >1816</td>
      <td id="T_e2d81_row7_col1" class="data row7 col1" >1935</td>
      <td id="T_e2d81_row7_col2" class="data row7 col2" >1812</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row8" class="row_heading level0 row8" rowspan="2">5</th>
      <th id="T_e2d81_level1_row8" class="row_heading level1 row8" >AIC</th>
      <td id="T_e2d81_row8_col0" class="data row8 col0" >863</td>
      <td id="T_e2d81_row8_col1" class="data row8 col1" >1046</td>
      <td id="T_e2d81_row8_col2" class="data row8 col2" >882</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row9" class="row_heading level1 row9" >BIC</th>
      <td id="T_e2d81_row9_col0" class="data row9 col0" >876</td>
      <td id="T_e2d81_row9_col1" class="data row9 col1" >1059</td>
      <td id="T_e2d81_row9_col2" class="data row9 col2" >889</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row10" class="row_heading level0 row10" rowspan="2">6</th>
      <th id="T_e2d81_level1_row10" class="row_heading level1 row10" >AIC</th>
      <td id="T_e2d81_row10_col0" class="data row10 col0" >924</td>
      <td id="T_e2d81_row10_col1" class="data row10 col1" >1058</td>
      <td id="T_e2d81_row10_col2" class="data row10 col2" >930</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row11" class="row_heading level1 row11" >BIC</th>
      <td id="T_e2d81_row11_col0" class="data row11 col0" >937</td>
      <td id="T_e2d81_row11_col1" class="data row11 col1" >1072</td>
      <td id="T_e2d81_row11_col2" class="data row11 col2" >936</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row12" class="row_heading level0 row12" rowspan="2">7</th>
      <th id="T_e2d81_level1_row12" class="row_heading level1 row12" >AIC</th>
      <td id="T_e2d81_row12_col0" class="data row12 col0" >1470</td>
      <td id="T_e2d81_row12_col1" class="data row12 col1" >1733</td>
      <td id="T_e2d81_row12_col2" class="data row12 col2" >1516</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row13" class="row_heading level1 row13" >BIC</th>
      <td id="T_e2d81_row13_col0" class="data row13 col0" >1483</td>
      <td id="T_e2d81_row13_col1" class="data row13 col1" >1747</td>
      <td id="T_e2d81_row13_col2" class="data row13 col2" >1523</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row14" class="row_heading level0 row14" rowspan="2">8</th>
      <th id="T_e2d81_level1_row14" class="row_heading level1 row14" >AIC</th>
      <td id="T_e2d81_row14_col0" class="data row14 col0" >1097</td>
      <td id="T_e2d81_row14_col1" class="data row14 col1" >1253</td>
      <td id="T_e2d81_row14_col2" class="data row14 col2" >1098</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row15" class="row_heading level1 row15" >BIC</th>
      <td id="T_e2d81_row15_col0" class="data row15 col0" >1110</td>
      <td id="T_e2d81_row15_col1" class="data row15 col1" >1266</td>
      <td id="T_e2d81_row15_col2" class="data row15 col2" >1105</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row16" class="row_heading level0 row16" rowspan="2">9</th>
      <th id="T_e2d81_level1_row16" class="row_heading level1 row16" >AIC</th>
      <td id="T_e2d81_row16_col0" class="data row16 col0" >1066</td>
      <td id="T_e2d81_row16_col1" class="data row16 col1" >1472</td>
      <td id="T_e2d81_row16_col2" class="data row16 col2" >1089</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row17" class="row_heading level1 row17" >BIC</th>
      <td id="T_e2d81_row17_col0" class="data row17 col0" >1079</td>
      <td id="T_e2d81_row17_col1" class="data row17 col1" >1485</td>
      <td id="T_e2d81_row17_col2" class="data row17 col2" >1095</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row18" class="row_heading level0 row18" rowspan="2">10</th>
      <th id="T_e2d81_level1_row18" class="row_heading level1 row18" >AIC</th>
      <td id="T_e2d81_row18_col0" class="data row18 col0" >1710</td>
      <td id="T_e2d81_row18_col1" class="data row18 col1" >1821</td>
      <td id="T_e2d81_row18_col2" class="data row18 col2" >1749</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row19" class="row_heading level1 row19" >BIC</th>
      <td id="T_e2d81_row19_col0" class="data row19 col0" >1724</td>
      <td id="T_e2d81_row19_col1" class="data row19 col1" >1834</td>
      <td id="T_e2d81_row19_col2" class="data row19 col2" >1756</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row20" class="row_heading level0 row20" rowspan="2">11</th>
      <th id="T_e2d81_level1_row20" class="row_heading level1 row20" >AIC</th>
      <td id="T_e2d81_row20_col0" class="data row20 col0" >1987</td>
      <td id="T_e2d81_row20_col1" class="data row20 col1" >2147</td>
      <td id="T_e2d81_row20_col2" class="data row20 col2" >2064</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row21" class="row_heading level1 row21" >BIC</th>
      <td id="T_e2d81_row21_col0" class="data row21 col0" >2000</td>
      <td id="T_e2d81_row21_col1" class="data row21 col1" >2160</td>
      <td id="T_e2d81_row21_col2" class="data row21 col2" >2070</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row22" class="row_heading level0 row22" rowspan="2">12</th>
      <th id="T_e2d81_level1_row22" class="row_heading level1 row22" >AIC</th>
      <td id="T_e2d81_row22_col0" class="data row22 col0" >1805</td>
      <td id="T_e2d81_row22_col1" class="data row22 col1" >1874</td>
      <td id="T_e2d81_row22_col2" class="data row22 col2" >1857</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row23" class="row_heading level1 row23" >BIC</th>
      <td id="T_e2d81_row23_col0" class="data row23 col0" >1818</td>
      <td id="T_e2d81_row23_col1" class="data row23 col1" >1887</td>
      <td id="T_e2d81_row23_col2" class="data row23 col2" >1864</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row24" class="row_heading level0 row24" rowspan="2">13</th>
      <th id="T_e2d81_level1_row24" class="row_heading level1 row24" >AIC</th>
      <td id="T_e2d81_row24_col0" class="data row24 col0" >1967</td>
      <td id="T_e2d81_row24_col1" class="data row24 col1" >2100</td>
      <td id="T_e2d81_row24_col2" class="data row24 col2" >1988</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row25" class="row_heading level1 row25" >BIC</th>
      <td id="T_e2d81_row25_col0" class="data row25 col0" >1980</td>
      <td id="T_e2d81_row25_col1" class="data row25 col1" >2113</td>
      <td id="T_e2d81_row25_col2" class="data row25 col2" >1994</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row26" class="row_heading level0 row26" rowspan="2">14</th>
      <th id="T_e2d81_level1_row26" class="row_heading level1 row26" >AIC</th>
      <td id="T_e2d81_row26_col0" class="data row26 col0" >1455</td>
      <td id="T_e2d81_row26_col1" class="data row26 col1" >1572</td>
      <td id="T_e2d81_row26_col2" class="data row26 col2" >1489</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row27" class="row_heading level1 row27" >BIC</th>
      <td id="T_e2d81_row27_col0" class="data row27 col0" >1468</td>
      <td id="T_e2d81_row27_col1" class="data row27 col1" >1585</td>
      <td id="T_e2d81_row27_col2" class="data row27 col2" >1495</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row28" class="row_heading level0 row28" rowspan="2">15</th>
      <th id="T_e2d81_level1_row28" class="row_heading level1 row28" >AIC</th>
      <td id="T_e2d81_row28_col0" class="data row28 col0" >998</td>
      <td id="T_e2d81_row28_col1" class="data row28 col1" >1135</td>
      <td id="T_e2d81_row28_col2" class="data row28 col2" >1042</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row29" class="row_heading level1 row29" >BIC</th>
      <td id="T_e2d81_row29_col0" class="data row29 col0" >1011</td>
      <td id="T_e2d81_row29_col1" class="data row29 col1" >1148</td>
      <td id="T_e2d81_row29_col2" class="data row29 col2" >1049</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row30" class="row_heading level0 row30" rowspan="2">16</th>
      <th id="T_e2d81_level1_row30" class="row_heading level1 row30" >AIC</th>
      <td id="T_e2d81_row30_col0" class="data row30 col0" >1975</td>
      <td id="T_e2d81_row30_col1" class="data row30 col1" >2050</td>
      <td id="T_e2d81_row30_col2" class="data row30 col2" >2035</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row31" class="row_heading level1 row31" >BIC</th>
      <td id="T_e2d81_row31_col0" class="data row31 col0" >1988</td>
      <td id="T_e2d81_row31_col1" class="data row31 col1" >2064</td>
      <td id="T_e2d81_row31_col2" class="data row31 col2" >2042</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row32" class="row_heading level0 row32" rowspan="2">17</th>
      <th id="T_e2d81_level1_row32" class="row_heading level1 row32" >AIC</th>
      <td id="T_e2d81_row32_col0" class="data row32 col0" >1272</td>
      <td id="T_e2d81_row32_col1" class="data row32 col1" >1410</td>
      <td id="T_e2d81_row32_col2" class="data row32 col2" >1307</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row33" class="row_heading level1 row33" >BIC</th>
      <td id="T_e2d81_row33_col0" class="data row33 col0" >1285</td>
      <td id="T_e2d81_row33_col1" class="data row33 col1" >1424</td>
      <td id="T_e2d81_row33_col2" class="data row33 col2" >1314</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row34" class="row_heading level0 row34" rowspan="2">18</th>
      <th id="T_e2d81_level1_row34" class="row_heading level1 row34" >AIC</th>
      <td id="T_e2d81_row34_col0" class="data row34 col0" >1897</td>
      <td id="T_e2d81_row34_col1" class="data row34 col1" >2039</td>
      <td id="T_e2d81_row34_col2" class="data row34 col2" >1927</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row35" class="row_heading level1 row35" >BIC</th>
      <td id="T_e2d81_row35_col0" class="data row35 col0" >1911</td>
      <td id="T_e2d81_row35_col1" class="data row35 col1" >2052</td>
      <td id="T_e2d81_row35_col2" class="data row35 col2" >1933</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row36" class="row_heading level0 row36" rowspan="2">19</th>
      <th id="T_e2d81_level1_row36" class="row_heading level1 row36" >AIC</th>
      <td id="T_e2d81_row36_col0" class="data row36 col0" >1889</td>
      <td id="T_e2d81_row36_col1" class="data row36 col1" >1932</td>
      <td id="T_e2d81_row36_col2" class="data row36 col2" >1894</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row37" class="row_heading level1 row37" >BIC</th>
      <td id="T_e2d81_row37_col0" class="data row37 col0" >1902</td>
      <td id="T_e2d81_row37_col1" class="data row37 col1" >1946</td>
      <td id="T_e2d81_row37_col2" class="data row37 col2" >1901</td>
    </tr>
    <tr>
      <th id="T_e2d81_level0_row38" class="row_heading level0 row38" rowspan="2">20</th>
      <th id="T_e2d81_level1_row38" class="row_heading level1 row38" >AIC</th>
      <td id="T_e2d81_row38_col0" class="data row38 col0" >1627</td>
      <td id="T_e2d81_row38_col1" class="data row38 col1" >1724</td>
      <td id="T_e2d81_row38_col2" class="data row38 col2" >1658</td>
    </tr>
    <tr>
      <th id="T_e2d81_level1_row39" class="row_heading level1 row39" >BIC</th>
      <td id="T_e2d81_row39_col0" class="data row39 col0" >1640</td>
      <td id="T_e2d81_row39_col1" class="data row39 col1" >1737</td>
      <td id="T_e2d81_row39_col2" class="data row39 col2" >1664</td>
    </tr>
  </tbody>
</table>
<p>As one can see from the results table, BIC and AIC values don&rsquo;t always agree. And even though &ldquo;No Competition&rdquo; model showed lower BIC and AIC values for some of the subjects, we will select the &ldquo;Full Model&rdquo; as a winning one, since it fits better for the majority of subjects.</p>
<h3 id="comparison-to-the-random-choice-model">Comparison to the Random Choice Model</h3>
<p>One can also check whether the subject performed actions at random with the help of &ldquo;classical&rdquo; statistical approaches, such as <a href="https://en.wikipedia.org/wiki/Chi-squared_test" target="_blank" rel="noopener">Chi-square test</a>.</p>
<p>Our null hypothesis is that actions were selected at random. If this was true in our case, then for 200 trials, we would see 50 selections of each option. An alternative hypothesis is that number of selections of each option is different from 50. Significance level $\alpha$ is going to be 0.05. We will perform the Chi-square test for each subject separately.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>alpha <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">0.05</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>chisq_results <span style="color:#99d1db;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values()):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    <span style="color:#737994;font-style:italic"># get the list of observed counts of choices</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    obs <span style="color:#99d1db;font-weight:bold">=</span> agent_data[agent_data[<span style="color:#a6d189">&#39;subjID&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> subj][<span style="color:#a6d189">&#39;choice&#39;</span>]\
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>      <span style="color:#99d1db;font-weight:bold">.</span>value_counts()\
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>      <span style="color:#99d1db;font-weight:bold">.</span>sort_index()\
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>      <span style="color:#99d1db;font-weight:bold">.</span>to_list()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    chisq_results[subj] <span style="color:#99d1db;font-weight:bold">=</span> chisquare(f_obs<span style="color:#99d1db;font-weight:bold">=</span>obs)[<span style="color:#ef9f76">1</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span><span style="color:#ca9ee6">if</span> np<span style="color:#99d1db;font-weight:bold">.</span>sum(np<span style="color:#99d1db;font-weight:bold">.</span>array(<span style="color:#99d1db">list</span>(chisq_results<span style="color:#99d1db;font-weight:bold">.</span>values())) <span style="color:#99d1db;font-weight:bold">&lt;</span> alpha) <span style="color:#99d1db;font-weight:bold">==</span> n_subj<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">2</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;Rejecting the null hypothesis for all subjects.&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span><span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#a6d189">&#39;Some subject may have chosen actions at random.&#39;</span>)
</span></span></code></pre></div><pre><code>Rejecting the null hypothesis for all subjects.
</code></pre>
</p>
</details>
<br>
<p>Results above show that we were able to reject the null hypothesis for all the subjects, meaning that the counts of choices are not equal (or in other words, choices were not selected at random) at the significance level of 0.05.</p>
<h2 id="model-validation">Model Validation</h2>
<p>After we have selected the model, we could proceed to the model validation. In this step, we try to replicate the original data with the selected parameters and check whether they fit. We will use the same function <code>generate_agent_data</code> that we used to generate the initial set using the estimated values from MLE results and see how artificial data differs from the original one. As a measure of comparison, we can check the ratio of selection of 4-th window (the one with the highest reward probability and lowest punishment probability). This will allow us to indirectly compare the action value functions (if estimated parameters were close to the real parameters, the action value function over the trials would be approximately the same and thus the probability of choosing each option would also be roughly the same).</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># data generation</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>sim_data <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span><span style="color:#ca9ee6">for</span> subj <span style="color:#99d1db;font-weight:bold">in</span> itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values()):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    actions, gain, loss, Qs <span style="color:#99d1db;font-weight:bold">=</span> generate_agent_data(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        alpha_rew<span style="color:#99d1db;font-weight:bold">=</span>selected_params[subj][<span style="color:#a6d189">&#39;alpha_rew&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>        alpha_pun<span style="color:#99d1db;font-weight:bold">=</span>selected_params[subj][<span style="color:#a6d189">&#39;alpha_pun&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>        rew_sens<span style="color:#99d1db;font-weight:bold">=</span>selected_params[subj][<span style="color:#a6d189">&#39;R&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>        pun_sens<span style="color:#99d1db;font-weight:bold">=</span>selected_params[subj][<span style="color:#a6d189">&#39;P&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        rew_prob<span style="color:#99d1db;font-weight:bold">=</span>rew_probs,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        pun_prob<span style="color:#99d1db;font-weight:bold">=</span>pun_probs,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>        rew_vals<span style="color:#99d1db;font-weight:bold">=</span>rew_vals,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>        n_trials<span style="color:#99d1db;font-weight:bold">=</span>n_trials)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    temp_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        <span style="color:#a6d189">&#39;subjID&#39;</span>: subj, <span style="color:#a6d189">&#39;choice&#39;</span>: actions<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>, <span style="color:#a6d189">&#39;gain&#39;</span>: gain, <span style="color:#a6d189">&#39;loss&#39;</span>: loss})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    sim_data <span style="color:#99d1db;font-weight:bold">=</span> sim_data<span style="color:#99d1db;font-weight:bold">.</span>append(temp_df)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>figure(figsize<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#ef9f76">10</span>,<span style="color:#ef9f76">20</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span><span style="color:#ca9ee6">for</span> (j, subj) <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">enumerate</span>(itertools<span style="color:#99d1db;font-weight:bold">.</span>chain(<span style="color:#99d1db;font-weight:bold">*</span>ids<span style="color:#99d1db;font-weight:bold">.</span>values())):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>    cumavg_true <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    cumavg_sim <span style="color:#99d1db;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>subplot(<span style="color:#ef9f76">10</span>, <span style="color:#ef9f76">2</span>, j<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    <span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(n_trials):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>        cumavg_true<span style="color:#99d1db;font-weight:bold">.</span>append(np<span style="color:#99d1db;font-weight:bold">.</span>mean(agent_data[agent_data[<span style="color:#a6d189">&#39;subjID&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> subj][<span style="color:#a6d189">&#39;choice&#39;</span>][:i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">4</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>        cumavg_sim<span style="color:#99d1db;font-weight:bold">.</span>append(np<span style="color:#99d1db;font-weight:bold">.</span>mean(sim_data[sim_data[<span style="color:#a6d189">&#39;subjID&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> subj][<span style="color:#a6d189">&#39;choice&#39;</span>][:i<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">1</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">4</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>plot(cumavg_true, color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;blue&#39;</span>, label<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;True&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>plot(cumavg_sim, color<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;red&#39;</span>, label<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Simulated&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>legend()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>title(<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;Subject </span><span style="color:#a6d189">{</span>subj<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    plt<span style="color:#99d1db;font-weight:bold">.</span>ylim([<span style="color:#ef9f76">0</span>,<span style="color:#ef9f76">1</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    <span style="color:#ca9ee6">if</span> (j<span style="color:#99d1db;font-weight:bold">+</span><span style="color:#ef9f76">2</span>) <span style="color:#99d1db;font-weight:bold">%</span> <span style="color:#ef9f76">2</span> <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#ef9f76">0</span>: <span style="color:#737994;font-style:italic"># for odd indeces</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>ylabel(<span style="color:#a6d189">&#39;$P(a_t = a_4)$&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    <span style="color:#ca9ee6">if</span> j <span style="color:#99d1db;font-weight:bold">in</span> [<span style="color:#ef9f76">18</span>, <span style="color:#ef9f76">19</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        plt<span style="color:#99d1db;font-weight:bold">.</span>xlabel(<span style="color:#a6d189">&#39;Trial&#39;</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>suptitle(<span style="color:#a6d189">&#39;Probability of choosing the 4th arm&#39;</span>, y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1.01</span>, fontsize<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">15</span>, fontweight<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;bold&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>tight_layout()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>plt<span style="color:#99d1db;font-weight:bold">.</span>show()
</span></span></code></pre></div></p>
</details>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/computational-models-of-behavior-pt1/output_43_0_hu14477425686854901018.webp 400w,
               /tutorial/computational-models-of-behavior-pt1/output_43_0_hu6876939937241008370.webp 760w,
               /tutorial/computational-models-of-behavior-pt1/output_43_0_hu5416740143250148250.webp 1200w"
               src="/tutorial/computational-models-of-behavior-pt1/output_43_0_hu14477425686854901018.webp"
               width="380"
               height="760"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>Probabilities (of ratio) of selection of the 4th option don&rsquo;t always perfectly match between true and simulated values, but it&rsquo;s fairly close. We can make a conclusion, that model captured the real behavior pretty well.</p>
<h2 id="groups-comparison">Groups Comparison</h2>
<p>Once we have selected the model and confirmed, that it can reproduce the real behavioral data, we can come to the main research question we had in the beginning: does treatment change the reward sensitivity and learning rate for a positive outcome?</p>
<p>We have our selected parameters for each subject, now it comes again to the statistical analysis. We will use a two-sample $t$-test to see whether there is a significant difference between the samples of parameters at the significance level $\alpha$ of 0.05.</p>
<p><strong>Results</strong></p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#ca9ee6">for</span> param <span style="color:#99d1db;font-weight:bold">in</span> params:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    <span style="color:#99d1db">print</span>(<span style="color:#e78284">f</span><span style="color:#a6d189">&#34;==Results for </span><span style="color:#a6d189">{</span>param_names[param]<span style="color:#a6d189">}</span><span style="color:#a6d189">==&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>    ttest_res <span style="color:#99d1db;font-weight:bold">=</span> pg<span style="color:#99d1db;font-weight:bold">.</span>ttest(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>        x<span style="color:#99d1db;font-weight:bold">=</span>mle_params_df[mle_params_df[<span style="color:#a6d189">&#39;group&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;Control&#39;</span>][param],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>        y<span style="color:#99d1db;font-weight:bold">=</span>mle_params_df[mle_params_df[<span style="color:#a6d189">&#39;group&#39;</span>] <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;Treatment&#39;</span>][param])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>    display(ttest_res)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span>    <span style="color:#99d1db">print</span>()
</span></span></code></pre></div></p>
</details>
<br>
<p>Results for learning rate (reward):</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>4.188352</td>
      <td>18</td>
      <td>two-sided</td>
      <td>0.000552</td>
      <td>[0.1, 0.3]</td>
      <td>1.873088</td>
      <td>48.259</td>
      <td>0.977033</td>
    </tr>
  </tbody>
</table>
</div>
<p>Results for learning rate (punishment):</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>0.169418</td>
      <td>18</td>
      <td>two-sided</td>
      <td>0.867357</td>
      <td>[-0.1, 0.12]</td>
      <td>0.075766</td>
      <td>0.401</td>
      <td>0.052959</td>
    </tr>
  </tbody>
</table>
</div>
<p>Results for reward sensitivity:</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>1.981033</td>
      <td>18</td>
      <td>two-sided</td>
      <td>0.063076</td>
      <td>[-0.05, 1.79]</td>
      <td>0.885945</td>
      <td>1.463</td>
      <td>0.466243</td>
    </tr>
  </tbody>
</table>
</div>
<p>Results for punishment sensitivity:</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="0" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>-0.751089</td>
      <td>18</td>
      <td>two-sided</td>
      <td>0.462306</td>
      <td>[-1.77, 0.84]</td>
      <td>0.335897</td>
      <td>0.485</td>
      <td>0.109741</td>
    </tr>
  </tbody>
</table>
</div>
<p>$t$-test results showed that there is only a significant difference between the learning rate for a reward with the large effect size. One could argue that difference for reward sensitivity is also statistically different with the medium effect size.</p>
<p>Another general issue with this approach is that each estimated value of the parameter has its own value of uncertainty (which can be estimated using the inverse of Hessian matrix), but by doing the $t$-test (or another alternative test) we are losing this uncertainty and use the values as if they were fixed. Bayesian approach doesn&rsquo;t have this issue and we can see it in the 2nd part of the article.</p>
<h2 id="summary-and-limitations">Summary and Limitations</h2>
<p>We have looked at how one can fit RL model to the behavioral data using MLE approach and select the best fitting values. Then we have introduced the idea of models comparison and model validation. Lastly, we have used statistical analysis to answer the research question using selected model parameters.</p>
<p>However, there are several limitations of this review. First of all, data was artificially generated and parameters were selected for simplicity from a given range. Real behavioral data can be much noisier.</p>
<p>Secondly, it is worth mentioning, that the initial data was generated with the research question in mind (<s>cheating</s>) to make it more exciting, that&rsquo;s why the results came up significantly different. Although it doesn&rsquo;t change the modeling and analysis steps.</p>
<p><a href="https://rklymentiev.com/post/computational-models-of-behavior-pt2/" target="_blank" rel="noopener"><strong>►Computational Models of Behavior, part 2: Bayesian Inference</strong></a></p>
<h2 id="references">References</h2>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Schultz W. (1998). Predictive reward signal of dopamine neurons. <em>Journal of neurophysiology, 80</em>(1), 1–27. <a href="https://doi.org/10.1152/jn.1998.80.1.1" target="_blank" rel="noopener">https://doi.org/10.1152/jn.1998.80.1.1</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Lockwood, P. L., &amp; Klein-Flügge, M. C. (2021). Computational modelling of social cognition and behaviour-a reinforcement learning primer. <em>Social cognitive and affective neuroscience, 16</em>(8), 761–771. <a href="https://doi.org/10.1093/scan/nsaa040" target="_blank" rel="noopener">https://doi.org/10.1093/scan/nsaa040</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Daw, N. (2011). Trial-by-trial data analysis using computational models. <em>Affect, Learning and Decision Making, Attention and Performance XXIII</em>. 23. <a href="https://doi.org/10.1093/acprof:oso/9780199600434.003.0001" target="_blank" rel="noopener">https://doi.org/10.1093/acprof:oso/9780199600434.003.0001</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Wilson, R. C., &amp; Collins, A. G. (2019). Ten simple rules for the computational modeling of behavioral data. <em>eLife, 8</em>, e49547. <a href="https://doi.org/10.7554/eLife.49547" target="_blank" rel="noopener">https://doi.org/10.7554/eLife.49547</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Seymour, B., Daw, N. D., Roiser, J. P., Dayan, P., &amp; Dolan, R. (2012). Serotonin selectively modulates reward value in human decision-making. <em>The Journal of neuroscience : the official journal of the Society for Neuroscience, 32</em>(17), 5833–5842. <a href="https://doi.org/10.1523/JNEUROSCI.0053-12.2012" target="_blank" rel="noopener">https://doi.org/10.1523/JNEUROSCI.0053-12.2012</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

      </div>

      
  <time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime="2021-10-25T00:00:00.000Z">
    <span>Last updated on</span>
    Oct 25, 2021</time>

      <div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5">
        
        <div class="max-w-prose print:hidden">
  
  

  

<div class="flex justify-center">
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/neuroscience/">Neuroscience</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/reinforcement-learning/">Reinforcement Learning</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/computational-modeling/">Computational Modeling</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/python/">Python</a>
  
</div>


  
<section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt1%2F&amp;text=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;1"
    title="X"
    aria-label="X"
    id="share-link-x"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt1%2F&amp;t=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;1"
    title="Facebook"
    aria-label="Facebook"
    id="share-link-facebook"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
  </a>
  

  
  
  
  
  
  
    
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="mailto:?subject=Computational%20Models%20of%20Behavior%2C%20part%201&amp;body=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt1%2F"
    title="Email"
    aria-label="Email"
    id="share-link-email"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt1%2F&amp;title=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;1"
    title="LinkedIn"
    aria-label="LinkedIn"
    id="share-link-linkedin"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="whatsapp://send?text=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;1%20http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt1%2F"
    title="WhatsApp"
    aria-label="WhatsApp"
    id="share-link-whatsapp"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><path d="m187.58 144.84-32-16a8 8 0 0 0-8 .5l-14.69 9.8a40.55 40.55 0 0 1-16-16l9.8-14.69a8 8 0 0 0 .5-8l-16-32A8 8 0 0 0 104 64a40 40 0 0 0-40 40 88.1 88.1 0 0 0 88 88 40 40 0 0 0 40-40 8 8 0 0 0-4.42-7.16ZM152 176a72.08 72.08 0 0 1-72-72 24 24 0 0 1 19.29-23.54l11.48 23L101 118a8 8 0 0 0-.73 7.51 56.47 56.47 0 0 0 30.15 30.15A8 8 0 0 0 138 155l14.61-9.74 23 11.48A24 24 0 0 1 152 176ZM128 24a104 104 0 0 0-91.82 152.88l-11.35 34.05a16 16 0 0 0 20.24 20.24l34.05-11.35A104 104 0 1 0 128 24Zm0 192a87.87 87.87 0 0 1-44.06-11.81 8 8 0 0 0-6.54-.67L40 216l12.47-37.4a8 8 0 0 0-.66-6.54A88 88 0 1 1 128 216Z"/></svg>
  </a>
  
</section>


  








  
  
    



  
  
  
    
  
  
  

<div class="flex pt-12 pb-4">
  
  
  <img
    class="mr-4 h-24 w-24 rounded-full"
    width="96"
    height="96"
    alt="Ruslan Klymentiev"
  src="/author/ruslan-klymentiev/avatar_hu14015720463236890778.png"
  loading="lazy"
  />
  
  <div class="place-self-center">
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Authors
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      <a href="http://localhost:4321/" class="no-underline">
      Ruslan Klymentiev
      </a>
    </div>

    
    <div class="text-sm font-bold text-neutral-700 dark:text-neutral-300">
    Data-something-scientist
    </div>
    


    

    <div class="text-2xl sm:text-lg pt-1">

      
<div class="flex flex-wrap text-neutral-500 dark:text-neutral-300">
  
    
    
    
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="mailto:rklymentiev@gmail.com"
      
      aria-label="At-Symbol"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://github.com/rklymentiev"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Github"
    ><svg style="height: 1em;" fill="currentColor" viewBox="3 3 18 18"><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://scholar.google.com/citations?user=prQO0zEAAAAJ"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Google-Scholar"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M343.759 106.662V79.43L363.524 64h-213.89L20.476 176.274h85.656a82.339 82.339 0 0 0-.219 6.225c0 20.845 7.22 38.087 21.672 51.861c14.453 13.797 32.252 20.648 53.327 20.648c4.923 0 9.75-.368 14.438-1.024c-2.907 6.5-4.374 12.523-4.374 18.142c0 9.875 4.499 20.43 13.467 31.642c-39.234 2.67-68.061 9.732-86.437 21.163c-10.531 6.5-19 14.704-25.39 24.531c-6.391 9.9-9.578 20.515-9.578 31.962c0 9.648 2.062 18.336 6.219 26.062c4.156 7.726 9.578 14.07 16.312 18.984c6.718 4.968 14.469 9.101 23.219 12.469c8.734 3.344 17.406 5.718 26.061 7.062A167.052 167.052 0 0 0 180.555 448c13.469 0 26.953-1.734 40.547-5.187c13.562-3.485 26.28-8.642 38.171-15.493c11.86-6.805 21.515-16.086 28.922-27.718c7.39-11.68 11.094-24.805 11.094-39.336c0-11.016-2.25-21.039-6.75-30.14c-4.468-9.073-9.938-16.542-16.452-22.345c-6.501-5.813-13-11.155-19.516-15.968c-6.5-4.845-12-9.75-16.468-14.813c-4.485-5.046-6.735-10.054-6.735-14.984c0-4.921 1.734-9.672 5.216-14.265c3.455-4.61 7.674-9.048 12.61-13.306c4.937-4.25 9.875-8.968 14.796-14.133c4.922-5.147 9.141-11.827 12.61-20.008c3.485-8.18 5.203-17.445 5.203-27.757c0-13.453-2.547-24.46-7.547-33.314c-.594-1.022-1.218-1.803-1.875-3.022l56.907-46.672v17.119c-7.393.93-6.624 5.345-6.624 10.635V245.96c0 5.958 4.875 10.834 10.834 10.834h3.989c5.958 0 10.833-4.875 10.833-10.834V117.293c0-5.277.778-9.688-6.561-10.63zm-107.36 222.48c1.14.75 3.704 2.78 7.718 6.038c4.05 3.243 6.797 5.695 8.266 7.414a443.553 443.553 0 0 1 6.376 7.547c2.813 3.375 4.718 6.304 5.718 8.734c1 2.477 2.016 5.461 3.047 8.946a38.27 38.27 0 0 1 1.485 10.562c0 17.048-6.564 29.68-19.656 37.859c-13.125 8.18-28.767 12.274-46.938 12.274c-9.187 0-18.203-1.093-27.063-3.196c-8.843-2.116-17.311-5.336-25.39-9.601c-8.078-4.258-14.577-10.204-19.5-17.797c-4.938-7.64-7.407-16.415-7.407-26.25c0-10.32 2.797-19.29 8.422-26.906c5.594-7.625 12.938-13.391 22.032-17.315c9.063-3.946 18.25-6.742 27.562-8.398a157.865 157.865 0 0 1 28.438-2.555c4.47 0 7.936.25 10.405.696c.455.219 3.032 2.07 7.735 5.563c4.704 3.462 7.625 5.595 8.75 6.384zm-3.359-100.579c-7.406 8.86-17.734 13.288-30.953 13.288c-11.86 0-22.298-4.764-31.266-14.312c-9-9.523-15.422-20.328-19.344-32.43c-3.937-12.109-5.906-23.984-5.906-35.648c0-13.694 3.596-25.352 10.781-34.976c7.187-9.65 17.5-14.485 30.938-14.485c11.875 0 22.374 5.038 31.437 15.157c9.094 10.085 15.61 21.413 19.517 33.968c3.922 12.54 5.873 24.53 5.873 35.984c0 13.446-3.702 24.61-11.076 33.454z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://orcid.org/0000-0002-0907-0908"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Orcid"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M336.62 194.538c-7.13-3.328-13.866-5.56-20.253-6.614c-6.365-1.095-16.574-1.612-30.71-1.612h-36.704v152.747h37.634c14.673 0 26.081-1.013 34.224-3.017c8.142-2.004 14.921-4.526 20.356-7.626a69.448 69.448 0 0 0 14.942-11.388c14.488-14.714 21.742-33.273 21.742-55.717c0-22.052-7.44-40.052-22.341-53.982c-5.498-5.166-11.822-9.444-18.89-12.793zM256 8C119.022 8 8 119.042 8 256s111.022 248 248 248s248-111.042 248-248S392.978 8 256 8Zm-82.336 357.513h-29.389V160.148h29.389zM158.95 138.696c-11.14 0-20.213-9.01-20.213-20.212c0-11.118 9.052-20.191 20.213-20.191c11.18 0 20.232 9.052 20.232 20.191a20.194 20.194 0 0 1-20.232 20.212zm241.386 163.597c-5.29 12.545-12.834 23.581-22.65 33.088c-9.982 9.837-21.597 17.194-34.844 22.196c-7.75 3.017-14.839 5.063-21.307 6.117c-6.49 1.013-18.828 1.509-37.076 1.509h-64.956V160.148h69.233c27.962 0 50.034 4.154 66.32 12.545c16.265 8.37 29.181 20.728 38.792 36.972c9.61 16.265 14.425 34.018 14.425 53.196c.023 13.765-2.666 26.908-7.936 39.432z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://www.instagram.com/rklymentiev/"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Instagram"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path fill="currentColor" fill-rule="evenodd" d="M12.91 12.909c.326-.327.582-.72.749-1.151c.16-.414.27-.886.302-1.578c.032-.693.04-.915.04-2.68c0-1.765-.008-1.987-.04-2.68c-.032-.692-.142-1.164-.302-1.578a3.185 3.185 0 0 0-.75-1.151a3.187 3.187 0 0 0-1.151-.75c-.414-.16-.886-.27-1.578-.302C9.487 1.007 9.265 1 7.5 1c-1.765 0-1.987.007-2.68.04c-.692.03-1.164.14-1.578.301a3.2 3.2 0 0 0-1.151.75a3.2 3.2 0 0 0-.75 1.151c-.16.414-.27.886-.302 1.578C1.007 5.513 1 5.735 1 7.5c0 1.765.007 1.987.04 2.68c.03.692.14 1.164.301 1.578c.164.434.42.826.75 1.151c.325.33.718.586 1.151.75c.414.16.886.27 1.578.302c.693.031.915.039 2.68.039c1.765 0 1.987-.008 2.68-.04c.692-.03 1.164-.14 1.578-.301a3.323 3.323 0 0 0 1.151-.75ZM2 6.735v1.53c-.002.821-.002 1.034.02 1.5c.026.586.058 1.016.156 1.34c.094.312.199.63.543 1.012c.344.383.675.556 1.097.684c.423.127.954.154 1.415.175c.522.024.73.024 1.826.024H8.24c.842.001 1.054.002 1.526-.02c.585-.027 1.015-.059 1.34-.156c.311-.094.629-.2 1.011-.543c.383-.344.556-.676.684-1.098c.127-.422.155-.953.176-1.414C13 9.247 13 9.04 13 7.947v-.89c0-1.096 0-1.303-.023-1.826c-.021-.461-.049-.992-.176-1.414c-.127-.423-.3-.754-.684-1.098c-.383-.344-.7-.449-1.011-.543c-.325-.097-.755-.13-1.34-.156A27.29 27.29 0 0 0 8.24 2H7.057c-1.096 0-1.304 0-1.826.023c-.461.021-.992.049-1.415.176c-.422.128-.753.301-1.097.684c-.344.383-.45.7-.543 1.012c-.098.324-.13.754-.156 1.34c-.022.466-.022.679-.02 1.5ZM7.5 5.25a2.25 2.25 0 1 0 0 4.5a2.25 2.25 0 0 0 0-4.5ZM4.25 7.5a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0Zm6.72-2.72a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"/></svg></a>
  
</div>



    </div>
  </div>
</div>



  




  
  
    
    
    
      
      
    
<div class="pt-1 no-prose w-full">
  <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
  <div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2">
    <div class="">
      
        <a class="group flex no-underline" href="/tutorial/computational-models-of-behavior-pt2/">
          <span
            class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline rtl:hidden">&larr;</span></span>
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Computational Models of Behavior, part 2</span>
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Nov 13, 2021
              
            </span>
          </span>
        </a>
      
    </div>
    <div class="">
      
        <a class="group flex text-right no-underline" href="/tutorial/pyforneuro/">
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Python for Neuroscience</span
            >
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Sep 28, 2021
              
            </span>
          </span>
          <span
            class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline">&rarr;</span></span>
        </a>
      
    </div>
  </div>
</div>



  


  



</div>

      </div>

    </main>
  </article>
</div>

    </div>
    <div class="page-footer">
      <footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200">

  












  
  
  
  
  














  
  
  

  
  
  
    
  

  

  
  <p class="powered-by text-center">
    © 2024. This work is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by text-center">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>

</footer>

    </div>

    
    











  </body>
</html>
