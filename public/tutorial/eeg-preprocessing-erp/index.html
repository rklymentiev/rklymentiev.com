<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: November 11, 2024 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="system">
  
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.2.0" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ruslan Klymentiev" />

  
  
  
    
  
  <meta name="description" content="Preprocessing &amp; Event-related potential (ERP) of EEG data taken from Cavanagh et al. (2019) experiment." />

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:4321/tutorial/eeg-preprocessing-erp/" />

  
  
  
  
    
    <link rel="stylesheet" href="/css/themes/emerald.min.css" />
  

  
  
    
    <link href="/dist/wc.min.css" rel="stylesheet" />
  

  
  
  

  
    
    <link href="/css/custom.min.15f6624443884362110ae1c63cfb1412c6924eea6b2373b4f708c498d4bf0f66.css" rel="stylesheet" />
  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  
  




































  
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu18111939623654241174.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu8230923372197676942.png" />

  <link rel="canonical" href="http://localhost:4321/tutorial/eeg-preprocessing-erp/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="RK" />
  <meta property="og:url" content="http://localhost:4321/tutorial/eeg-preprocessing-erp/" />
  <meta property="og:title" content="Intro to EEG Data Analysis | RK" />
  <meta property="og:description" content="Preprocessing &amp; Event-related potential (ERP) of EEG data taken from Cavanagh et al. (2019) experiment." /><meta property="og:image" content="http://localhost:4321/tutorial/eeg-preprocessing-erp/featured.png" />
    <meta property="twitter:image" content="http://localhost:4321/tutorial/eeg-preprocessing-erp/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-02-19T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-02-19T00:00:00&#43;00:00">
  

  



  


  <title>Intro to EEG Data Analysis | RK</title>

  
  
  
  
  
    
    
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(/dist/font/Inter.var.woff2) format(woff2);
    }
  </style>

  

  
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  







<link type="text/css" rel="stylesheet" href="/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css" integrity="sha256-vnZutBkxehTsdp0hbpd5v&#43;jzc3yA54D0ug2vtXpBpII=" />


<script src="/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js" integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script>


<script>window.hbb.pagefind = {"baseUrl":"/"};</script>

<style>
  html.dark {
    --pagefind-ui-primary: #eeeeee;
    --pagefind-ui-text: #eeeeee;
    --pagefind-ui-background: #152028;
    --pagefind-ui-border: #152028;
    --pagefind-ui-tag: #152028;
  }
</style>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    new PagefindUI({
      element: "#search",
      showSubResults: true,
      baseUrl: window.hbb.pagefind.baseUrl,
      bundlePath: window.hbb.pagefind.baseUrl + "pagefind/",
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    let element = document.getElementById('search');
    let trigger = document.getElementById('search_toggle');

    if (trigger) {
      trigger.addEventListener('click', () => {
        element.classList.toggle('hidden');
        element.querySelector("input").value = ""
        element.querySelector("input").focus()

        if (!element.classList.contains('hidden')) {
          let clear_trigger = document.querySelector('.pagefind-ui__search-clear');

          if (clear_trigger && !clear_trigger.hasAttribute('listenerOnClick')) {
            clear_trigger.setAttribute('listenerOnClick', 'true');

            clear_trigger.addEventListener('click', () => {
              element.classList.toggle('hidden');
            });
          }
        }

      });
    }
  });
</script>










  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js" integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="/js/hugo-blox-en.min.js"
    integrity=""
  ></script>

  
  








  
    
      
      <script async defer src="https://buttons.github.io/buttons.js"></script>

      
    
  




</head>

  <body class="dark:bg-hb-dark dark:text-white page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header sticky top-0 z-30">
      
      
      
        
        
        
          <header id="site-header" class="header">
  <nav class="navbar px-3 flex justify-left">
    <div class="order-0 h-100">
      
      <a class="navbar-brand" href="/" title="RK">
        RK
      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Open Menu</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Close Menu</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left
      ">
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/"
        >Home</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/publication/"
        >Publications</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/tutorial/"
        >Tutorials</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/post/"
        >Blog</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/event/"
        >Talks</a
        >
      </li>
      
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">

      
      
      
      <button
        aria-label="search"
        class="text-black hover:text-primary  inline-block px-3 text-xl dark:text-white"
        id="search_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentColor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
      </button>
      

      
      
      <div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
            [&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white">
        <button class="theme-toggle mt-1" accesskey="t" title="appearance">
          <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class="dark:hidden">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </div>
      

      
      

      
      
    </div>
  </nav>
</header>


<div id="search" class="hidden p-3"></div>


        
      
    </div>
    <div class="page-body  my-10">
      <div class="mx-auto flex max-w-screen-xl">
  

  
  <div class="hb-sidebar-mobile-menu fixed inset-0 z-10 bg-white dark:bg-black/80 hidden"></div>



<aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:sticky">
  
  <div class="px-4 pt-4 lg:hidden">
    
    
  </div>
  <div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]">
    <ul class="flex flex-col gap-1 lg:hidden">
      
      
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/"
    
  >Recent Talks
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_cben2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_ssc2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/introduction-to-python/"
    
  >Introduction to Python
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value? (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/how-to-start-career-in-data/"
    
  >How to start career in Data (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/null-hypothesis-significance-testing/"
    
  >Statistical Hypothesis Testing (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/data-visualization/"
    
  >Packages for Data Visualization (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/numpy-pandas-sympy/"
    
  >Intro to NumPy, pandas &amp; SymPy (in Russian)
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/"
    
  >Publications
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/"
    
  >Inhibiting presynaptic calcium channel motility in the auditory cortex suppresses synchronized input processing
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/"
    
  >Blog
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-i-met-my-partner-in-crime/"
    
  >How I Met My Partner In Crime
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-do-criminals-make-decisions/"
    
  >How Do Criminals Make Decisions?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/psychopathy/"
    
  >Psychopaths: the Good, the Bad, and the Crazy
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/"
    
  >Projects
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pandas/"
    
  >Pandas
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pytorch/"
    
  >PyTorch
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/scikit/"
    
  >scikit-learn
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/experience/"
    
  >Experience
    </a></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/"
    
  >Teaching
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/python_for_ds/"
    
  >Python for Data Science (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt2/"
    
  >Computational Models of Behavior, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt1/"
    
  >Computational Models of Behavior, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/pyforneuro/"
    
  >Python for Neuroscience
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bandit_cats/"
    
  >Bandit Cats and Exploration-Exploitation Trade-Off
    </a>
              
            </li><li class="flex flex-col open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/tutorial/eeg-preprocessing-erp/"
    
  >Intro to EEG Data Analysis
    </a>
  
    <ul class="hb-sidebar-mobile-toc"><li>
              <a
                href="#background"
                class="hb-docs-link"
              >Background</a>
            </li>
          <li>
              <a
                href="#overview-of-the-experiment"
                class="hb-docs-link"
              >Overview of the Experiment</a>
            </li>
          <li>
              <a
                href="#preprocessing"
                class="hb-docs-link"
              >Preprocessing</a>
            </li>
          <li>
              <a
                href="#event-related-potential"
                class="hb-docs-link"
              >Event-related potential</a>
            </li>
          <li>
              <a
                href="#summary"
                class="hb-docs-link"
              >Summary</a>
            </li>
          <li>
              <a
                href="#references"
                class="hb-docs-link"
              >References</a>
            </li>
          </ul>
  
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-3/"
    
  >Null Hypothesis Significance Testing, part 3
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-2/"
    
  >Null Hypothesis Significance Testing, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/roc-curve/"
    
  >ROC Curve Simulation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-1/"
    
  >Null Hypothesis Significance Testing, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/norm-binom/"
    
  >Normal Approximation to Binomial Distribution
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/how-do-cart-models-work/"
    
  >How do CART models work
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bayes_disease/"
    
  >Bayes Rule and Disease Testing
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/mab-problem/"
    
  >How to Deal with Multi-Armed Bandit Problem
    </a>
              
            </li></ul>
      </div></li>
    </ul>

    <ul class="flex flex-col gap-1 max-lg:hidden">
        
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/python_for_ds/"
    
  >Python for Data Science (in Russian)
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt2/"
    
  >Computational Models of Behavior, part 2
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt1/"
    
  >Computational Models of Behavior, part 1
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/pyforneuro/"
    
  >Python for Neuroscience
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bandit_cats/"
    
  >Bandit Cats and Exploration-Exploitation Trade-Off
    </a></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/tutorial/eeg-preprocessing-erp/"
    
  >Intro to EEG Data Analysis
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value?
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-3/"
    
  >Null Hypothesis Significance Testing, part 3
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-2/"
    
  >Null Hypothesis Significance Testing, part 2
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/roc-curve/"
    
  >ROC Curve Simulation
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-1/"
    
  >Null Hypothesis Significance Testing, part 1
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/norm-binom/"
    
  >Normal Approximation to Binomial Distribution
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/how-do-cart-models-work/"
    
  >How do CART models work
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bayes_disease/"
    
  >Bayes Rule and Disease Testing
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/mab-problem/"
    
  >How to Deal with Multi-Armed Bandit Problem
    </a></li>
        
      </ul>
    </div>

</aside>
  

<nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents">
  











  <div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#background">Background</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#overview-of-the-experiment">Overview of the Experiment</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#preprocessing">Preprocessing</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#data-import">Data Import</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#bad-channelstrials">Bad Channels/Trials</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#artifacts-removal">Artifacts Removal</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#ctl-group">CTL Group</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#dep-group">DEP Group</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#event-related-potential">Event-related potential</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#epochs">Epochs</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#resulted-erps">Resulted ERPs</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#summary">Summary</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#references">References</a>
      </li></ul>

  
  



    












  </div>
  </nav>


  <article class="flex w-full min-w-0 min-h-[calc(100vh-var(--navbar-height))] justify-center break-words pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <main class="prose prose-slate lg:prose-xl dark:prose-invert w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12">
      <div class="mb-1">
        <div class="mt-1.5 flex items-center gap-1 overflow-hidden text-sm text-gray-500 dark:text-gray-400">
      <div class="whitespace-nowrap transition-colors min-w-[24px] overflow-hidden text-ellipsis hover:text-gray-900 dark:hover:text-gray-100">
        <a href="http://localhost:4321/tutorial/">Teaching</a>
      </div><svg class="w-3.5 shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m8.25 4.5l7.5 7.5l-7.5 7.5"/></svg><div class="whitespace-nowrap font-medium text-gray-700 dark:text-gray-100">Intro to EEG Data Analysis</div>
</div>

      </div>

      <div class="content text-base">
        <h1>Intro to EEG Data Analysis</h1>
        <h2 id="background">Background</h2>
<p>Two years ago I have been working on EEG data (found at Kaggle<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>) from an object recognition task experiment that was performed to investigate the genetic predisposition to alcoholism<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>. My analysis was a pure mess since I didn&rsquo;t know a lot about EEG data processing/analysis. Time has passed, I still don&rsquo;t know much, but after finishing Mike X Cohen&rsquo;s course &ldquo;Complete neural signal processing and analysis: Zero to hero&rdquo; on Udemy<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> (which I cannot recommend highly enough), I decided to get more practice with the help of publicly available data from Cavanagh et al. (2019)<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>. I used <code>MNE</code> Python package<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup> for this and tried to do it in a bit &ldquo;tutorial&rdquo; style for two reasons. First, it will be easier for me to remember after some time what the hell was I doing here. Second, I hope that other people who also start their journey in the EEG analysis can benefit from this.</p>
<p><strong>Disclaimer</strong></p>
<p>This analysis was made for educational purposes in order to get an idea of how to work with the EEG data. I was not going to make any inference/conclusions about subjects or conditions (even if I did, they should not be taken seriously).</p>
<h2 id="overview-of-the-experiment">Overview of the Experiment</h2>
<center><img src="abstract.png" border=1></center>
<p>The original paper was published in Computational Psychiatry open source journal (the MIT Press)<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup> in 2018. One of the aims of the experiment was to investigate the association of EEG responses to reward and punishment among two groups, the control group (CTL) and the high depressive symptomatology group (DEP). Participants performed a probabilistic learning task, where a combination of two different images from the set was shown. Each image had its own probabilistic chance of being correct. The task was divided into training (participants were expected to learn the probability of being correct for each stimulus) and testing phases (experiment itself).</p>
<p>Participants:</p>
<ul>
<li>CTL: N = 75 (50 females)</li>
<li>DEP: N = 46 (34 females)</li>
<li>An average age among all participants was 18 years.</li>
</ul>
<h2 id="preprocessing">Preprocessing</h2>
<h3 id="data-import">Data Import</h3>
<p>For simplicity, I took just two data files, one subject from the DEP group (ID: 561), and one subject from the CTL group (ID: 507).</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">mne</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">pickle</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">numpy</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">np</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#81c8be">import</span> <span style="color:#ef9f76">pandas</span> <span style="color:#ca9ee6">as</span> <span style="color:#ef9f76">pd</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span><span style="color:#81c8be">from</span> <span style="color:#ef9f76">scipy.io</span> <span style="color:#81c8be">import</span> loadmat
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span><span style="color:#99d1db;font-weight:bold">%</span>matplotlib qt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># loading raw matlab files</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>CTL <span style="color:#99d1db;font-weight:bold">=</span> loadmat(<span style="color:#a6d189">&#39;depression_data/task/507.mat&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>DEP <span style="color:#99d1db;font-weight:bold">=</span> loadmat(<span style="color:#a6d189">&#39;depression_data/task/561.mat&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>EEG <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span><span style="color:#737994;font-style:italic"># data comes in a funny structure, so you have to dig deep with indexes </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span><span style="color:#737994;font-style:italic"># to extract it. `squeeze_me` argument doesn&#39;t look to help in such case</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>EEG[<span style="color:#a6d189">&#39;timevec&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> CTL[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;times&#39;</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>EEG[<span style="color:#a6d189">&#39;srate&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">int</span>(CTL[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;srate&#39;</span>]) <span style="color:#737994;font-style:italic"># 1 sample/2 ms</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span><span style="color:#737994;font-style:italic"># get the channel labels in a bit sophisticated way</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">list</span>(np<span style="color:#99d1db;font-weight:bold">.</span>hstack(CTL[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;chanlocs&#39;</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>][<span style="color:#a6d189">&#39;labels&#39;</span>][<span style="color:#ef9f76">0</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span><span style="color:#737994;font-style:italic"># mne package requires channel labels to be in a particular way, </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span><span style="color:#737994;font-style:italic"># so here I just change the cases for some channels</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span><span style="color:#ca9ee6">for</span> i <span style="color:#99d1db;font-weight:bold">in</span> <span style="color:#99d1db">range</span>(<span style="color:#99d1db">len</span>(EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>])):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>][i] <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>][i]<span style="color:#99d1db;font-weight:bold">.</span>replace(<span style="color:#a6d189">&#39;Z&#39;</span>, <span style="color:#a6d189">&#39;z&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>][i] <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>][i]<span style="color:#99d1db;font-weight:bold">.</span>replace(<span style="color:#a6d189">&#39;FP&#39;</span>, <span style="color:#a6d189">&#39;Fp&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>info <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>create_info(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    ch_names<span style="color:#99d1db;font-weight:bold">=</span>EEG[<span style="color:#a6d189">&#39;chanlabels&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>    sfreq<span style="color:#99d1db;font-weight:bold">=</span>EEG[<span style="color:#a6d189">&#39;srate&#39;</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    ch_types<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;eeg&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span><span style="color:#737994;font-style:italic"># convert raw data into mne object</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span><span style="color:#737994;font-style:italic"># also initial values were in microvolts, so convert them into volts</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>io<span style="color:#99d1db;font-weight:bold">.</span>RawArray(CTL[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;data&#39;</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>]<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">10</span><span style="color:#99d1db;font-weight:bold">**</span>(<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">6</span>), info)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>io<span style="color:#99d1db;font-weight:bold">.</span>RawArray(DEP[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;data&#39;</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>]<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#ef9f76">10</span><span style="color:#99d1db;font-weight:bold">**</span>(<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">6</span>), info)
</span></span></code></pre></div><pre><code>Creating RawArray with float64 data, n_channels=66, n_times=356405
    Range : 0 ... 356404 =      0.000 ...   712.808 secs
Ready.
Creating RawArray with float64 data, n_channels=66, n_times=575973
    Range : 0 ... 575972 =      0.000 ...  1151.944 secs
Ready.
</code></pre>
<p>Data was recorded at the 500 Hz rate. In other words, recordings were done every $\frac{1}{500} = 2 \cdot 10^{-3}$ seconds. Total duration of the recording for the CTL subject is 712.808 seconds, which is approximately 11-12 minutes. Total duration of the recording for the DEP subject is 1151.944 seconds, which is approximately 19 minutes.</p>
<p>Recordings were measured from 66 channels, including two electrooculography (EOG) electrodes placed near the eye (HEOG, VEOG), two electrodes on mastoid processes (M1, M2) and two cerebellar electrodes (CB1, CB2).</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>biosemi_montage <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>channels<span style="color:#99d1db;font-weight:bold">.</span>make_standard_montage(<span style="color:#a6d189">&#39;biosemi64&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>set_montage(biosemi_montage, on_missing<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;ignore&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>set_montage(biosemi_montage, on_missing<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;ignore&#39;</span>)
</span></span></code></pre></div><p>Some of the channels (M1, M2, PO5, PO6, CB1, CB2, HEOG, VEOG) were not recognized by the Biosemi 64 montage. It&rsquo;s &ldquo;okay&rdquo; since I would drop most of them anyway (leaving 60 electrodes). HEOG and VEOG channels were used to detect eye blinks and to compare with ICA components. M1 and M2 channels were used for reference. Cannot say much about PO5 and PO6 channels. In the original paper, they also reported that they used 60 channels plus two mastoids for the preprocessing stage.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># referencing the data</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#737994;font-style:italic"># channel_i = channel_i - mean(channel_M1, channel_M2)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>set_eeg_reference(ref_channels<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;M1&#39;</span>, <span style="color:#a6d189">&#39;M2&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>set_eeg_reference(ref_channels<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;M1&#39;</span>, <span style="color:#a6d189">&#39;M2&#39;</span>])
</span></span></code></pre></div><pre><code>EEG channel type selected for re-referencing
Applying a custom EEG reference.
EEG channel type selected for re-referencing
Applying a custom EEG reference.
</code></pre>
<p><strong>EEG data of the CTL subject</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot(n_channels<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">len</span>(EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>ch_names))
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_14_0_hu9596663366040284131.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_14_0_hu16745591642112663145.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_14_0_hu17214151286481523632.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_14_0_hu9596663366040284131.webp"
               width="760"
               height="420"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p><strong>EEG data of the DEP subject</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot(n_channels<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">len</span>(EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>ch_names))
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_16_0_hu13312018444097644870.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_16_0_hu1473289205895040520.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_16_0_hu10336347785511475751.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_16_0_hu13312018444097644870.webp"
               width="760"
               height="420"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>There was some funny business (voltage several orders higher than the rest of the signal) happening at the very of the recording, which I have removed.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>crop(tmax<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">700</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>crop(tmax<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1140</span>);
</span></span></code></pre></div><h3 id="bad-channelstrials">Bad Channels/Trials</h3>
<p>All the channels for CTL subject looked fine to me. However, for the DEP subject F2 channel looked a bit suspicious (only high-frequency fluctuations), so I marked it as &ldquo;bad&rdquo;.</p>
<p>The next step was to extract events data from the raw object and add it to the EEG data. There were lots of different event IDs, but I just used two specific ones: <code>94</code>, meaning correct trial, and <code>104</code>, meaning incorrect trial.</p>
<p>Then I annotated &ldquo;bad&rdquo; time spans. I paid attention to those that overlap with <code>94</code>/<code>104</code> events with the +/- 2 seconds interval since this time interval would be used for making epochs and all other epochs would be lost anyway. There were several time spans for both subjects that looked &ldquo;bad&rdquo; for me. An example can be seen below on the plot, with the suspiciously high-frequency signal.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># extracting events info from the raw file</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span><span style="color:#ca9ee6">for</span> data <span style="color:#99d1db;font-weight:bold">in</span> [CTL, DEP]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>    event_df <span style="color:#99d1db;font-weight:bold">=</span> pd<span style="color:#99d1db;font-weight:bold">.</span>DataFrame(data[<span style="color:#a6d189">&#39;EEG&#39;</span>][<span style="color:#a6d189">&#39;event&#39;</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>    <span style="color:#737994;font-style:italic"># fun with indexes again</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>    event_df[<span style="color:#a6d189">&#39;type&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> event_df[<span style="color:#a6d189">&#39;type&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>apply(<span style="color:#ca9ee6">lambda</span> x: x[<span style="color:#ef9f76">0</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    <span style="color:#ca9ee6">for</span> col <span style="color:#99d1db;font-weight:bold">in</span> [<span style="color:#a6d189">&#39;latency&#39;</span>, <span style="color:#a6d189">&#39;urevent&#39;</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        event_df[col] <span style="color:#99d1db;font-weight:bold">=</span> event_df[col]<span style="color:#99d1db;font-weight:bold">.</span>apply(<span style="color:#ca9ee6">lambda</span> x: x[<span style="color:#ef9f76">0</span>][<span style="color:#ef9f76">0</span>]) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>    <span style="color:#737994;font-style:italic"># convert strings to integers</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>    event_df[<span style="color:#a6d189">&#39;type&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> event_df[<span style="color:#a6d189">&#39;type&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>apply(<span style="color:#ca9ee6">lambda</span> x: <span style="color:#ef9f76">900</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;keyboard0&#39;</span> <span style="color:#ca9ee6">else</span> (
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        <span style="color:#ef9f76">1</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;keypad1&#39;</span> <span style="color:#ca9ee6">else</span> (
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>            <span style="color:#ef9f76">2</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;keypad2&#39;</span> <span style="color:#ca9ee6">else</span> (
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>                <span style="color:#ef9f76">999</span> <span style="color:#ca9ee6">if</span> x <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;boundary&#39;</span> <span style="color:#ca9ee6">else</span> <span style="color:#99d1db">int</span>(x)))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    <span style="color:#737994;font-style:italic"># mne requires events data to be in numpy array with three columns:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    <span style="color:#737994;font-style:italic"># time of occurence; second column for whatever reason which is ignored anyway; event id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    events <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>array(event_df[[<span style="color:#a6d189">&#39;latency&#39;</span>, <span style="color:#a6d189">&#39;type&#39;</span>]])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>    events <span style="color:#99d1db;font-weight:bold">=</span> np<span style="color:#99d1db;font-weight:bold">.</span>insert(events, <span style="color:#ef9f76">1</span>, values<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0</span>, axis<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>    <span style="color:#ca9ee6">if</span> data <span style="color:#99d1db;font-weight:bold">==</span> CTL:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        EEG[<span style="color:#a6d189">&#39;CTL_events&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> events
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>    <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>        EEG[<span style="color:#a6d189">&#39;DEP_events&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> events
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span><span style="color:#737994;font-style:italic"># just a fancy way to add colors and labels to the plot</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>event_color <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">dict</span>(<span style="color:#99d1db">zip</span>(event_df[<span style="color:#a6d189">&#39;type&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>unique(), [<span style="color:#a6d189">&#39;b&#39;</span>]<span style="color:#99d1db;font-weight:bold">*</span><span style="color:#99d1db">len</span>(event_df[<span style="color:#a6d189">&#39;type&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>unique())))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>event_color[<span style="color:#ef9f76">94</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;g&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>event_color[<span style="color:#ef9f76">104</span>] <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#39;r&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>event_id <span style="color:#99d1db;font-weight:bold">=</span> {<span style="color:#a6d189">&#39;COR&#39;</span>: <span style="color:#ef9f76">94</span>, <span style="color:#a6d189">&#39;INCOR&#39;</span>: <span style="color:#ef9f76">104</span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span><span style="color:#ca9ee6">del</span> event_df, events, CTL, DEP
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot(events<span style="color:#99d1db;font-weight:bold">=</span>EEG[<span style="color:#a6d189">&#39;CTL_events&#39;</span>], start<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">182</span>, event_id<span style="color:#99d1db;font-weight:bold">=</span>event_id, event_color<span style="color:#99d1db;font-weight:bold">=</span>event_color)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_21_0_hu6221210493938963488.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_21_0_hu6237967852698514127.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_21_0_hu7414522136608057647.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_21_0_hu6221210493938963488.webp"
               width="760"
               height="427"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot(events<span style="color:#99d1db;font-weight:bold">=</span>EEG[<span style="color:#a6d189">&#39;DEP_events&#39;</span>], start<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">844</span>, event_id<span style="color:#99d1db;font-weight:bold">=</span>event_id, event_color<span style="color:#99d1db;font-weight:bold">=</span>event_color)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_22_0_hu16476558694824778802.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_22_0_hu18140276111270532888.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_22_0_hu12203161922311816949.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_22_0_hu16476558694824778802.webp"
               width="760"
               height="427"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># marked bad channel</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>info[<span style="color:#a6d189">&#39;bads&#39;</span>]
</span></span></code></pre></div><pre><code>['F2']
</code></pre>
<h3 id="artifacts-removal">Artifacts Removal</h3>
<p>The next step was to remove eye blinks from the data. HEOG and VEOG electrodes were put around an eye to measure the horizontal and vertical eye movements respectively and they could be used for references. I applied an Independent Component Analysis (ICA)<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> to separate the signal sources.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># drop the redundant channels</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>drop_channels(ch_names<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;HEOG&#39;</span>, <span style="color:#a6d189">&#39;VEOG&#39;</span>, <span style="color:#a6d189">&#39;CB1&#39;</span>, <span style="color:#a6d189">&#39;CB2&#39;</span>, <span style="color:#a6d189">&#39;M1&#39;</span>, <span style="color:#a6d189">&#39;M2&#39;</span>, <span style="color:#a6d189">&#39;PO5&#39;</span>, <span style="color:#a6d189">&#39;PO6&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>drop_channels(ch_names<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#a6d189">&#39;HEOG&#39;</span>, <span style="color:#a6d189">&#39;VEOG&#39;</span>, <span style="color:#a6d189">&#39;CB1&#39;</span>, <span style="color:#a6d189">&#39;CB2&#39;</span>, <span style="color:#a6d189">&#39;M1&#39;</span>, <span style="color:#a6d189">&#39;M2&#39;</span>, <span style="color:#a6d189">&#39;PO5&#39;</span>, <span style="color:#a6d189">&#39;PO6&#39;</span>] <span style="color:#99d1db;font-weight:bold">+</span> EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>info[<span style="color:#a6d189">&#39;bads&#39;</span>])
</span></span></code></pre></div><h4 id="ctl-group">CTL Group</h4>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># mne tutorial suggests to filter the data from low frequencies (keep 1Hz+)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#737994;font-style:italic"># since they can affect ICA result</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>filt_raw <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>filt_raw<span style="color:#99d1db;font-weight:bold">.</span>load_data()<span style="color:#99d1db;font-weight:bold">.</span>filter(l_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1.</span>, h_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">None</span>)
</span></span></code></pre></div><pre><code>Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 1651 samples (3.302 sec)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>preprocessing<span style="color:#99d1db;font-weight:bold">.</span>ICA()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>fit(filt_raw)
</span></span></code></pre></div><pre><code>Fitting ICA to data using 58 channels (please be patient, this may take a while)
Inferring max_pca_components from picks
Omitting 8222 of 350001 (2.35%) samples, retaining 341779 (97.65%) samples.
Selecting all PCA components: 58 components
Fitting ICA took 80.6s.
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_sources(EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>])
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_30_0_hu16686585208421026832.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_30_0_hu4899119909988869738.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_30_0_hu4888838268806204786.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_30_0_hu16686585208421026832.webp"
               width="760"
               height="419"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_components(picks<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">range</span>(<span style="color:#ef9f76">15</span>))
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_31_0_hu15731764307559794293.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_31_0_hu18091178143428003255.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_31_0_hu10661035773903193611.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_31_0_hu15731764307559794293.webp"
               width="760"
               height="543"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># make a plot of signal without the first component</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_overlay(EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>], exclude<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>], picks<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;eeg&#39;</span>)
</span></span></code></pre></div><pre><code>Transforming to ICA space (58 components)
Zeroing out 1 ICA component
</code></pre>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_32_1_hu14697140269504582920.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_32_1_hu4316917905205640948.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_32_1_hu1522159892158187137.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_32_1_hu14697140269504582920.webp"
               width="626"
               height="473"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>THe first (ICA000) component was clearly an eye blink. The signal was stable for the whole time with some occasional drops caused by events at the front of the head.</p>
<p>Some other components, like ICA002 or ICA014, also looked weird for me, but that&rsquo;s something for me to work on.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>exclude <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>] <span style="color:#737994;font-style:italic"># exclude just first (ICA000) component</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>apply(EEG[<span style="color:#a6d189">&#39;CTL_data&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#ca9ee6">del</span> ica, filt_raw
</span></span></code></pre></div><pre><code>Transforming to ICA space (58 components)
Zeroing out 1 ICA component
</code></pre>
<h4 id="dep-group">DEP Group</h4>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>filt_raw <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>filt_raw<span style="color:#99d1db;font-weight:bold">.</span>load_data()<span style="color:#99d1db;font-weight:bold">.</span>filter(l_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">1.</span>, h_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">None</span>)
</span></span></code></pre></div><pre><code>Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 1651 samples (3.302 sec)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>preprocessing<span style="color:#99d1db;font-weight:bold">.</span>ICA()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>fit(filt_raw)
</span></span></code></pre></div><pre><code>Fitting ICA to data using 57 channels (please be patient, this may take a while)
Inferring max_pca_components from picks
Omitting 5585 of 570001 (0.98%) samples, retaining 564416 (99.02%) samples.
Selecting all PCA components: 57 components
Fitting ICA took 141.5s.
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_sources(EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>])
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_38_0_hu10767097301570425752.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_38_0_hu1988865397929701757.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_38_0_hu1205104744481882022.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_38_0_hu10767097301570425752.webp"
               width="760"
               height="419"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_components(picks<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#99d1db">range</span>(<span style="color:#ef9f76">15</span>))
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_39_0_hu9929096222062929351.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_39_0_hu15700893971239888537.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_39_0_hu15083467710023858923.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_39_0_hu9929096222062929351.webp"
               width="760"
               height="543"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>plot_overlay(EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>], exclude<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>], picks<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;eeg&#39;</span>)
</span></span></code></pre></div><pre><code>Transforming to ICA space (57 components)
Zeroing out 1 ICA component
</code></pre>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_40_1_hu12460825978552992474.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_40_1_hu3545845445675879513.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_40_1_hu1788027235860753772.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_40_1_hu12460825978552992474.webp"
               width="626"
               height="473"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>exclude <span style="color:#99d1db;font-weight:bold">=</span> [<span style="color:#ef9f76">0</span>] 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>ica<span style="color:#99d1db;font-weight:bold">.</span>apply(EEG[<span style="color:#a6d189">&#39;DEP_data&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#ca9ee6">del</span> ica, filt_raw
</span></span></code></pre></div><pre><code>Transforming to ICA space (57 components)
Zeroing out 1 ICA component
</code></pre>
<p>DEP subject got even more &ldquo;suspicious&rdquo; components, which I ignored for now.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#737994;font-style:italic"># at this stage I used to save the EEG locally to avoid repeating the same steps</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#737994;font-style:italic"># every time I rerun the notebook</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#737994;font-style:italic"># with open(&#39;EEG.pickle&#39;, &#39;wb&#39;) as f:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span><span style="color:#737994;font-style:italic">#     pickle.dump(EEG, f)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">7</span><span><span style="color:#737994;font-style:italic"># with open(&#39;EEG.pickle&#39;, &#39;rb&#39;) as f:</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">8</span><span><span style="color:#737994;font-style:italic">#     EEG = pickle.load(f)</span>
</span></span></code></pre></div><h2 id="event-related-potential">Event-related potential</h2>
<p>The final step (for this part) was to get the Event-Related Potential (ERP)<sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup> for both conditions: correct and incorrect, meaning that there were 4 ERPs: DEP&amp;COR, DEP&amp;INCOR, CTL&amp;COR, CTL&amp;INCOR.</p>
<h3 id="epochs">Epochs</h3>
<p>First signal had to be split into epochs according to the events (94/104) times. Time window is +/- 2 seconds around the feedback onset. Then signal was baseline corrected to the average signal from -0.2 to 0 seconds prefeedback. Bandpass filter (0.5-20 Hz) was applied.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#ca9ee6">for</span> g <span style="color:#99d1db;font-weight:bold">in</span> [<span style="color:#a6d189">&#39;DEP&#39;</span>, <span style="color:#a6d189">&#39;CTL&#39;</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>    <span style="color:#ca9ee6">for</span> o <span style="color:#99d1db;font-weight:bold">in</span> [<span style="color:#a6d189">&#39;correct&#39;</span>, <span style="color:#a6d189">&#39;incorrect&#39;</span>]:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>        <span style="color:#ca9ee6">if</span> o <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#39;correct&#39;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>            eid <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">94</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>        <span style="color:#ca9ee6">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>            eid <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">104</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>        <span style="color:#737994;font-style:italic"># copy of the signal to apply the bandpass filter on</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>        filt_raw <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_data&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>        filt_raw<span style="color:#99d1db;font-weight:bold">.</span>load_data()<span style="color:#99d1db;font-weight:bold">.</span>filter(l_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">0.5</span>, h_freq<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">20</span>, verbose<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">False</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>        EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_epochs_</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> mne<span style="color:#99d1db;font-weight:bold">.</span>Epochs(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>            raw<span style="color:#99d1db;font-weight:bold">=</span>filt_raw, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>            events<span style="color:#99d1db;font-weight:bold">=</span>EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_events&#39;</span>], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>            event_id<span style="color:#99d1db;font-weight:bold">=</span>eid, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>            tmin<span style="color:#99d1db;font-weight:bold">=-</span><span style="color:#ef9f76">2</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>            tmax<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>            baseline<span style="color:#99d1db;font-weight:bold">=</span>(<span style="color:#99d1db;font-weight:bold">-</span><span style="color:#ef9f76">0.2</span>, <span style="color:#ef9f76">0</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>        <span style="color:#737994;font-style:italic"># drop bad time spans</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>        EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_epochs_</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>drop_bad()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>        <span style="color:#737994;font-style:italic"># get ERP</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>        EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_erp_</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>] <span style="color:#99d1db;font-weight:bold">=</span> EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_epochs_</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>average()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>        EEG[<span style="color:#e78284">f</span><span style="color:#a6d189">&#39;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">_erp_</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>comment <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#e78284">f</span><span style="color:#a6d189">&#34;</span><span style="color:#a6d189">{</span>g<span style="color:#a6d189">}</span><span style="color:#a6d189">&amp;</span><span style="color:#a6d189">{</span>o<span style="color:#a6d189">}</span><span style="color:#a6d189">&#34;</span>
</span></span></code></pre></div><p>Total trials for each case:</p>
<ul>
<li>CTL &amp; correct: 72 total events, 7 bad events, final 55 events.</li>
<li>CTL &amp; incorrect: 48 total events, 3 bad events, final 45 events.</li>
<li>DEP &amp; correct: 169 total events, 5 bad events, final 164 events.</li>
<li>DEP &amp; incorrect: 125 total events, 4 bad events, final 121 events.</li>
</ul>
<h3 id="resulted-erps">Resulted ERPs</h3>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;CTL_erp_correct&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot_joint(times<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">0.24</span>, <span style="color:#ef9f76">0.34</span>], title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;CTL &amp; Correct&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_49_1_hu10660529570727657776.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_49_1_hu3918348981004241198.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_49_1_hu4211621436630114998.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_49_1_hu10660529570727657776.webp"
               width="760"
               height="417"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;CTL_erp_incorrect&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot_joint(times<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">0.27</span>, <span style="color:#ef9f76">0.38</span>], title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;CTL &amp; Incorrect&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_50_1_hu5251106563751892566.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_50_1_hu2905613015811647331.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_50_1_hu6018348923000025614.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_50_1_hu5251106563751892566.webp"
               width="760"
               height="413"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;DEP_erp_correct&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot_joint(times<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">0.23</span>, <span style="color:#ef9f76">0.34</span>], title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;DEP &amp; Correct&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_51_1_hu2574417189315256138.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_51_1_hu17663927456534667312.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_51_1_hu5304066290237097327.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_51_1_hu2574417189315256138.webp"
               width="760"
               height="413"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>EEG[<span style="color:#a6d189">&#39;DEP_erp_incorrect&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>plot_joint(times<span style="color:#99d1db;font-weight:bold">=</span>[<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">0.27</span>, <span style="color:#ef9f76">0.38</span>], title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;DEP &amp; Incorrect&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="png" srcset="
               /tutorial/eeg-preprocessing-erp/output_52_1_hu14783773799947217034.webp 400w,
               /tutorial/eeg-preprocessing-erp/output_52_1_hu10511431020175138122.webp 760w,
               /tutorial/eeg-preprocessing-erp/output_52_1_hu9185057364870390641.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/output_52_1_hu14783773799947217034.webp"
               width="760"
               height="413"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>In most of the cases, picks in poststimulus response were caused by the increased activity around the Fz-FCz-Cz areas. Below is the comparing ERP signal at the FCz channel for CTL and DEP group for each outcome.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>mne<span style="color:#99d1db;font-weight:bold">.</span>viz<span style="color:#99d1db;font-weight:bold">.</span>plot_compare_evokeds(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    [EEG[<span style="color:#a6d189">&#39;CTL_erp_correct&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()<span style="color:#99d1db;font-weight:bold">.</span>pick_channels([<span style="color:#a6d189">&#39;FCz&#39;</span>]), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>     EEG[<span style="color:#a6d189">&#39;DEP_erp_correct&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()<span style="color:#99d1db;font-weight:bold">.</span>pick_channels([<span style="color:#a6d189">&#39;FCz&#39;</span>])], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Correct at ch. FCz&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="" srcset="
               /tutorial/eeg-preprocessing-erp/erp_corr_fcz_hu12972282875895517379.webp 400w,
               /tutorial/eeg-preprocessing-erp/erp_corr_fcz_hu12443852528490232547.webp 760w,
               /tutorial/eeg-preprocessing-erp/erp_corr_fcz_hu5936127041250575076.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/erp_corr_fcz_hu12972282875895517379.webp"
               width="760"
               height="570"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>mne<span style="color:#99d1db;font-weight:bold">.</span>viz<span style="color:#99d1db;font-weight:bold">.</span>plot_compare_evokeds(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>    [EEG[<span style="color:#a6d189">&#39;CTL_erp_incorrect&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()<span style="color:#99d1db;font-weight:bold">.</span>pick_channels([<span style="color:#a6d189">&#39;FCz&#39;</span>]), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>     EEG[<span style="color:#a6d189">&#39;DEP_erp_incorrect&#39;</span>]<span style="color:#99d1db;font-weight:bold">.</span>copy()<span style="color:#99d1db;font-weight:bold">.</span>pick_channels([<span style="color:#a6d189">&#39;FCz&#39;</span>])], 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>    title<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#a6d189">&#39;Incorrect at ch. FCz&#39;</span>)
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="" srcset="
               /tutorial/eeg-preprocessing-erp/erp_incorr_fcz_hu5075965528815556437.webp 400w,
               /tutorial/eeg-preprocessing-erp/erp_incorr_fcz_hu14592683874270501958.webp 760w,
               /tutorial/eeg-preprocessing-erp/erp_incorr_fcz_hu5462674042292279599.webp 1200w"
               src="/tutorial/eeg-preprocessing-erp/erp_incorr_fcz_hu5075965528815556437.webp"
               width="760"
               height="570"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>The plots looked somewhat similar to the plot in the original paper (Figure 3). Prominent N2-P3 peaks for incorrect trials and two peaks at approximately the same level for correct trials.</p>
<h2 id="summary">Summary</h2>
<p>This was it for now. I learned how to perform first preprocessing steps on EEG data (referencing, eye blinks removal, baseline correction, epochs splitting). Some parts like detecting bad channels/trials and separating noise from the signal using ICA need more experience and practice from me.</p>
<p>In the next part I am going to perform a time-frequency analysis for both subjects.</p>
<h2 id="references">References</h2>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://archive.ics.uci.edu/ml/datasets/eeg&#43;database" target="_blank" rel="noopener">UCI Machine Learning Repository: EEG Database Data Set	</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Ruslan Klymentiev (2019, January 8). <em>EEG Data Analysis.</em> Kaggle. <a href="https://www.kaggle.com/code/ruslankl/eeg-data-analysis/" target="_blank" rel="noopener">https://www.kaggle.com/code/ruslankl/eeg-data-analysis/</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p><a href="https://www.udemy.com/course/solved-challenges-ants/" target="_blank" rel="noopener">Complete neural signal processing and analysis: Zero to hero | Udemy</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Cavanagh, J. F., Bismark, A. W., Frank, M. J., &amp; Allen, J. J. B. (2019). Multiple Dissociations Between Comorbid Depression and Anxiety on Reward and Punishment Processing: Evidence From Computationally Informed EEG. <em>Computational Psychiatry</em>, 3, 1–17. DOI: <a href="http://doi.org/10.1162/CPSY_a_00024" target="_blank" rel="noopener">http://doi.org/10.1162/CPSY_a_00024</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><a href="https://mne.tools/stable/index.html" target="_blank" rel="noopener">MNE — MNE 0.22.0 documentation</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p><a href="http://computationalpsychiatry.org/" target="_blank" rel="noopener">cpsy</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p><a href="https://www.sciencedirect.com/topics/neuroscience/independent-component-analysis" target="_blank" rel="noopener">Independent Component Analysis - an overview | ScienceDirect Topics ScienceDirect</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p><a href="https://www.sciencedirect.com/topics/neuroscience/event-related-potential" target="_blank" rel="noopener">Event-Related Potential - an overview | ScienceDirect Topics ScienceDirect</a>&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

      </div>

      
  <time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime="2021-02-19T00:00:00.000Z">
    <span>Last updated on</span>
    Feb 19, 2021</time>
      
      
  
    
    
    
      
      
    
<div class="pt-1 no-prose w-full">
  <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
  <div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2">
    <div class="">
      
        <a class="group flex no-underline" href="/tutorial/bandit_cats/">
          <span
            class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline rtl:hidden">&larr;</span></span>
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Bandit Cats and Exploration-Exploitation Trade-Off</span>
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                May 13, 2021
              
            </span>
          </span>
        </a>
      
    </div>
    <div class="">
      
        <a class="group flex text-right no-underline" href="/tutorial/frequentist-vs-bayesian/">
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Who would you rather date, Bayes Factor or p-value?</span
            >
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Nov 14, 2020
              
            </span>
          </span>
          <span
            class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline">&rarr;</span></span>
        </a>
      
    </div>
  </div>
</div>



      



    </main>
  </article>
</div>

    </div>
    <div class="page-footer">
      <footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200">

  












  
  
  
  
  














  
  
  

  
  
  
    
  

  

  
  <p class="powered-by text-center">
    © 2024. This work is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by text-center">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>

</footer>

    </div>

    
    











  </body>
</html>
