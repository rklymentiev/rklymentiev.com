<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: November 11, 2024 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="system">
  
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.2.0" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ruslan Klymentiev" />

  
  
  
    
  
  <meta name="description" content="How to fit reinforcement learning models to behavioral data using hierarchical Bayesian inference." />

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:4321/tutorial/computational-models-of-behavior-pt2/" />

  
  
  
  
    
    <link rel="stylesheet" href="/css/themes/emerald.min.css" />
  

  
  
    
    <link href="/dist/wc.min.css" rel="stylesheet" />
  

  
  
  

  
    
    <link href="/css/custom.min.15f6624443884362110ae1c63cfb1412c6924eea6b2373b4f708c498d4bf0f66.css" rel="stylesheet" />
  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  
  




































  
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu18111939623654241174.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu8230923372197676942.png" />

  <link rel="canonical" href="http://localhost:4321/tutorial/computational-models-of-behavior-pt2/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="RK" />
  <meta property="og:url" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt2/" />
  <meta property="og:title" content="Computational Models of Behavior, part 2 | RK" />
  <meta property="og:description" content="How to fit reinforcement learning models to behavioral data using hierarchical Bayesian inference." /><meta property="og:image" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt2/featured.png" />
    <meta property="twitter:image" content="http://localhost:4321/tutorial/computational-models-of-behavior-pt2/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-11-13T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-11-13T00:00:00&#43;00:00">
  

  



  


  <title>Computational Models of Behavior, part 2 | RK</title>

  
  
  
  
  
    
    
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(/dist/font/Inter.var.woff2) format(woff2);
    }
  </style>

  

  
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  







<link type="text/css" rel="stylesheet" href="/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css" integrity="sha256-vnZutBkxehTsdp0hbpd5v&#43;jzc3yA54D0ug2vtXpBpII=" />


<script src="/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js" integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script>


<script>window.hbb.pagefind = {"baseUrl":"/"};</script>

<style>
  html.dark {
    --pagefind-ui-primary: #eeeeee;
    --pagefind-ui-text: #eeeeee;
    --pagefind-ui-background: #152028;
    --pagefind-ui-border: #152028;
    --pagefind-ui-tag: #152028;
  }
</style>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    new PagefindUI({
      element: "#search",
      showSubResults: true,
      baseUrl: window.hbb.pagefind.baseUrl,
      bundlePath: window.hbb.pagefind.baseUrl + "pagefind/",
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    let element = document.getElementById('search');
    let trigger = document.getElementById('search_toggle');

    if (trigger) {
      trigger.addEventListener('click', () => {
        element.classList.toggle('hidden');
        element.querySelector("input").value = ""
        element.querySelector("input").focus()

        if (!element.classList.contains('hidden')) {
          let clear_trigger = document.querySelector('.pagefind-ui__search-clear');

          if (clear_trigger && !clear_trigger.hasAttribute('listenerOnClick')) {
            clear_trigger.setAttribute('listenerOnClick', 'true');

            clear_trigger.addEventListener('click', () => {
              element.classList.toggle('hidden');
            });
          }
        }

      });
    }
  });
</script>










  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js" integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="/js/hugo-blox-en.min.js"
    integrity=""
  ></script>

  
  








  
    
      
      <script async defer src="https://buttons.github.io/buttons.js"></script>

      
    
  




</head>

  <body class="dark:bg-hb-dark dark:text-white page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header sticky top-0 z-30">
      
      
      
        
        
        
          <header id="site-header" class="header">
  <nav class="navbar px-3 flex justify-left">
    <div class="order-0 h-100">
      
      <a class="navbar-brand" href="/" title="RK">
        RK
      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Open Menu</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Close Menu</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left
      ">
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/"
        >Home</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/publication/"
        >Publications</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/tutorial/"
        >Tutorials</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/post/"
        >Blog</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/event/"
        >Talks</a
        >
      </li>
      
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">

      
      
      
      <button
        aria-label="search"
        class="text-black hover:text-primary  inline-block px-3 text-xl dark:text-white"
        id="search_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentColor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
      </button>
      

      
      
      <div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
            [&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white">
        <button class="theme-toggle mt-1" accesskey="t" title="appearance">
          <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class="dark:hidden">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </div>
      

      
      

      
      
    </div>
  </nav>
</header>


<div id="search" class="hidden p-3"></div>


        
      
    </div>
    <div class="page-body  my-10">
      





<div class="mx-auto flex max-w-screen-xl">
  



<aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block">
  
  <div class="px-4 pt-4 lg:hidden">
    
    
  </div>
  <div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]">
    <ul class="flex flex-col gap-1 lg:hidden">
      
      
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/"
    
  >Recent Talks
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_cben2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/presentation_ssc2024/"
    
  >The Effect of Homophily on Co-Offending Outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/introduction-to-python/"
    
  >Introduction to Python
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value? (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/how-to-start-career-in-data/"
    
  >How to start career in Data (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/null-hypothesis-significance-testing/"
    
  >Statistical Hypothesis Testing (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/data-visualization/"
    
  >Packages for Data Visualization (in Russian)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/numpy-pandas-sympy/"
    
  >Intro to NumPy, pandas &amp; SymPy (in Russian)
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/"
    
  >Publications
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/"
    
  >Inhibiting presynaptic calcium channel motility in the auditory cortex suppresses synchronized input processing
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/"
    
  >Blog
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-i-met-my-partner-in-crime/"
    
  >How I Met My Partner In Crime
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/how-do-criminals-make-decisions/"
    
  >How Do Criminals Make Decisions?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/psychopathy/"
    
  >Psychopaths: the Good, the Bad, and the Crazy
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/"
    
  >Projects
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pandas/"
    
  >Pandas
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/pytorch/"
    
  >PyTorch
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/scikit/"
    
  >scikit-learn
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/experience/"
    
  >Experience
    </a></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/"
    
  >Teaching
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/python_for_ds/"
    
  >Python for Data Science (in Russian)
    </a>
              
            </li><li class="flex flex-col open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/tutorial/computational-models-of-behavior-pt2/"
    
  >Computational Models of Behavior, part 2
    </a>
  
    <ul class="hb-sidebar-mobile-toc"><li>
              <a
                href="#recap-on-the-previous-part"
                class="hb-docs-link"
              >Recap on the Previous Part</a>
            </li>
          <li>
              <a
                href="#intuition-behind-bayesian-analysis"
                class="hb-docs-link"
              >Intuition Behind Bayesian Analysis</a>
            </li>
          <li>
              <a
                href="#model-diagnostics"
                class="hb-docs-link"
              >Model Diagnostics</a>
            </li>
          <li>
              <a
                href="#model-comparison"
                class="hb-docs-link"
              >Model Comparison</a>
            </li>
          <li>
              <a
                href="#model-validation"
                class="hb-docs-link"
              >Model Validation</a>
            </li>
          <li>
              <a
                href="#groups-comparison"
                class="hb-docs-link"
              >Groups Comparison</a>
            </li>
          <li>
              <a
                href="#summary-and-comparison"
                class="hb-docs-link"
              >Summary and Comparison</a>
            </li>
          <li>
              <a
                href="#references"
                class="hb-docs-link"
              >References</a>
            </li>
          </ul>
  
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/computational-models-of-behavior-pt1/"
    
  >Computational Models of Behavior, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/pyforneuro/"
    
  >Python for Neuroscience
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bandit_cats/"
    
  >Bandit Cats and Exploration-Exploitation Trade-Off
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/eeg-preprocessing-erp/"
    
  >Intro to EEG Data Analysis
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/frequentist-vs-bayesian/"
    
  >Who would you rather date, Bayes Factor or p-value?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-3/"
    
  >Null Hypothesis Significance Testing, part 3
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-2/"
    
  >Null Hypothesis Significance Testing, part 2
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/roc-curve/"
    
  >ROC Curve Simulation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/null-hypothesis-significance-testing-part-1/"
    
  >Null Hypothesis Significance Testing, part 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/norm-binom/"
    
  >Normal Approximation to Binomial Distribution
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/how-do-cart-models-work/"
    
  >How do CART models work
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/bayes_disease/"
    
  >Bayes Rule and Disease Testing
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/tutorial/mab-problem/"
    
  >How to Deal with Multi-Armed Bandit Problem
    </a>
              
            </li></ul>
      </div></li>
    </ul>

    <div class="max-xl:hidden h-0 w-64 shrink-0"></div></div>

</aside>
  

<nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents">
  











  <div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#recap-on-the-previous-part">Recap on the Previous Part</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#intuition-behind-bayesian-analysis">Intuition Behind Bayesian Analysis</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#model-diagnostics">Model Diagnostics</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#model-comparison">Model Comparison</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#model-validation">Model Validation</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#groups-comparison">Groups Comparison</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#learning-rate-reward">Learning Rate (Reward)</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#learning-rate-punishment">Learning Rate (Punishment)</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#reward-sensitivity">Reward Sensitivity</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#punishment-sensitivity">Punishment Sensitivity</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#summary-and-comparison">Summary and Comparison</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#references">References</a>
      </li></ul>

  
  



    












  </div>
  </nav>


  <article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12">

      

      <h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">Computational Models of Behavior, part 2</h1>

      <div class="mt-4 mb-16">
      <div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class="mr-1">Nov 13, 2021</span><span class="mx-1">·</span>
        
          
          
          <div class="group inline-flex items-center text-current gap-x-1.5 mx-1">
            
            
            <img src="/author/ruslan-klymentiev/avatar_hu16379050607528300314.webp" alt="Ruslan Klymentiev" class="inline-block h-4 w-4 rounded-full border border-current" loading="lazy" />
            
            <div >Ruslan Klymentiev</div>
          </div>
          
        

        
        <span class="mx-1">·</span>
        <span class="mx-1">
          16 min read
        </span>
        
        </div>

        <div class="mt-3">
          





        </div>
      </div>



      
      
      
      
      

      
      
      
      
      
      
      
      
      
      
      <div class="article-header container-fluid featured-image-wrapper mt-4 mb-16" style="max-width: 1879px; max-height: 1056px;">
        <div style="position: relative">
          <img src="/tutorial/computational-models-of-behavior-pt2/featured_hu7265503310848053433.webp" width="1879" height="1056" alt="" class="featured-image">
          <span class="article-header-caption">Image credit: <a href="https://pixabay.com/users/geralt-9301/">geralt</a> from <a href="https://pixabay.com">Pixabay</a></span>
        </div>
      </div>
      

      
      

      <div class="prose prose-slate lg:prose-xl dark:prose-invert">
        <h2 id="recap-on-the-previous-part">Recap on the Previous Part</h2>
<p>In the <a href="https://rklymentiev.com/post/computational-models-of-behavior-pt1/" target="_blank" rel="noopener">previous part</a> we saw an example of fitting a model to behavioral data using maximum likelihood estimation (MLE). The original data set was artificially generated using the modification of a Q-learning model (Seymour et al., 2012<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>) for a 4-armed bandit paradigm, where each option had a unique probability of reward and punishment. We went over model comparison, model validation, and how to finally answer a research question using the fitted parameters. We have also discussed that MLE comes with its limitations, such as the possibility that the algorithm will be stuck at the local minimum, meaning that the fitted parameters may not be optimal.</p>
<p>In this part we are going to look at another approach, Bayesian inference. And particular we will use the <code>hBayesDM: hierarchical Bayesian modeling of Decision-Making tasks</code> package (Ahn et al, 2017<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>), which was built on top of the <code>RStan</code> interface (Stan Development Team, 2020<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>) for Bayesian data analysis. We are going to use the same data set and will try to answer the same question: &ldquo;<em>Does treatment affect humans’ reward sensitivity and the learning rate for a positive outcome?</em>&rdquo;.</p>
<p>Even though there is a <a href="https://hbayesdm.readthedocs.io/en/develop/" target="_blank" rel="noopener">Python version</a> of <code>hBayesDM</code> package, we will do it in R, since I personally prefer to perform &ldquo;hardcore statistical analysis&rdquo; in R.</p>
<p>And once again, these posts have been designed to show an example of <strong>how</strong> to fit the models. Reader can refer to Gelman et al. (2013)<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> for the in-depth overview of Bayesian inference.</p>
<p><strong>Objectives</strong>:</p>
<ol>
<li>How to answer research questions using modeling.</li>
<li>How to fit reinforcement learning (RL) models to behavioral data using Bayesian inference.</li>
<li>How to compare models and choose the best fitting one.</li>
<li>Compassion of MLE and Bayesian inference results.</li>
</ol>
<p>Just to remind ourselves, that&rsquo;s how the initial data set and the distribution of <strong>true</strong> parameters (which have been used to generate the data) look like:</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">library</span>(hBayesDM)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#8caaee">library</span>(tidyverse)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span><span style="color:#8caaee">library</span>(knitr)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span><span style="color:#8caaee">library</span>(kableExtra)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span><span style="color:#8caaee">library</span>(gridExtra)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">6</span><span><span style="color:#8caaee">library</span>(grid)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>agent_data <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">read.csv</span>(<span style="color:#a6d189">&#34;agent_data.csv&#34;</span>, sep <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;,&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>true_params <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">read.csv</span>(<span style="color:#a6d189">&#34;true_params.csv&#34;</span>, sep <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;,&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">head</span>(agent_data, n <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">10</span>) <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>  <span style="color:#8caaee">kable</span>(caption <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Initial data sample&#34;</span>) <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>  <span style="color:#8caaee">kable_classic_2</span>()
</span></span></code></pre></div></p>
</details>
<br>
<table class=" lightable-classic-2" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">Table 1: </span>Sample of the initial data 
</caption>
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:right;">
subjID
</th>
<th style="text-align:right;">
trial
</th>
<th style="text-align:right;">
choice
</th>
<th style="text-align:right;">
gain
</th>
<th style="text-align:right;">
loss
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>p1 <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">ggplot</span>(true_params, <span style="color:#8caaee">aes</span>(y <span style="color:#99d1db;font-weight:bold">=</span> alpha_rew, x <span style="color:#99d1db;font-weight:bold">=</span> group, fill <span style="color:#99d1db;font-weight:bold">=</span> group)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>  <span style="color:#8caaee">geom_boxplot</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>  <span style="color:#8caaee">geom_jitter</span>(position<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#8caaee">position_jitter</span>(<span style="color:#ef9f76">0.1</span>)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>  <span style="color:#8caaee">theme</span>(legend.position <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;none&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>  <span style="color:#8caaee">labs</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(alpha[rew]),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>  <span style="color:#8caaee">ylim</span>(<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">.55</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>p2 <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">ggplot</span>(true_params, <span style="color:#8caaee">aes</span>(y <span style="color:#99d1db;font-weight:bold">=</span> alpha_pun, x <span style="color:#99d1db;font-weight:bold">=</span> group, fill <span style="color:#99d1db;font-weight:bold">=</span> group)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>  <span style="color:#8caaee">geom_boxplot</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>  <span style="color:#8caaee">geom_jitter</span>(position<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#8caaee">position_jitter</span>(<span style="color:#ef9f76">0.1</span>)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>  <span style="color:#8caaee">theme</span>(legend.position <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;none&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>  <span style="color:#8caaee">labs</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(alpha[pun]),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>  <span style="color:#8caaee">ylim</span>(<span style="color:#ef9f76">0</span>, <span style="color:#ef9f76">.55</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>p3 <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">ggplot</span>(true_params, <span style="color:#8caaee">aes</span>(y <span style="color:#99d1db;font-weight:bold">=</span> R, x <span style="color:#99d1db;font-weight:bold">=</span> group, fill <span style="color:#99d1db;font-weight:bold">=</span> group)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>  <span style="color:#8caaee">geom_boxplot</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>  <span style="color:#8caaee">geom_jitter</span>(position<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#8caaee">position_jitter</span>(<span style="color:#ef9f76">0.1</span>)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>  <span style="color:#8caaee">theme</span>(legend.position <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;none&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>  <span style="color:#8caaee">labs</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(R),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Group&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>  <span style="color:#8caaee">ylim</span>(<span style="color:#ef9f76">1</span>, <span style="color:#ef9f76">8</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>p4 <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">ggplot</span>(true_params, <span style="color:#8caaee">aes</span>(y <span style="color:#99d1db;font-weight:bold">=</span> P, x <span style="color:#99d1db;font-weight:bold">=</span> group, fill <span style="color:#99d1db;font-weight:bold">=</span> group)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>  <span style="color:#8caaee">geom_boxplot</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>  <span style="color:#8caaee">geom_jitter</span>(position<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#8caaee">position_jitter</span>(<span style="color:#ef9f76">0.1</span>)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>  <span style="color:#8caaee">theme</span>(legend.position <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;none&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">32</span><span>  <span style="color:#8caaee">labs</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">33</span><span>    y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(P),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">34</span><span>    x <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Group&#34;</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">35</span><span>  <span style="color:#8caaee">ylim</span>(<span style="color:#ef9f76">1</span>, <span style="color:#ef9f76">8</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">38</span><span><span style="color:#8caaee">grid.arrange</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">39</span><span>  p1, p2, p3, p4, nrow <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">40</span><span>  top <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">textGrob</span>(<span style="color:#a6d189">&#34;True Parameters&#34;</span>, gp <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">gpar</span>(font<span style="color:#99d1db;font-weight:bold">=</span><span style="color:#ef9f76">2</span>)))
</span></span></code></pre></div></p>
</details>
<p><img src="params.png"></img></p>
<h2 id="intuition-behind-bayesian-analysis">Intuition Behind Bayesian Analysis</h2>
<p>The ideas behind MLE and Bayesian analysis (BA) are conceptually different. In MLE we are looking for a set of parameters $\hat{\Theta}$ that maximize the likelihood function given the observed data $X = \{ x_1, x_2, ..., x_T \}$ for a specific model:</p>
$$\hat{\Theta}_{ML} = \underset{\Theta}{\text{arg max}} \left \{ \mathcal{L} (\Theta | X) \right \} = \underset{\Theta}{\text{arg max}} \left \{ \prod _{i=1}^{T} P(x_i | \Theta) \right \}$$<p>$T$ - number of observations (trials).</p>
<p>In BA we are looking for a probability of the set of parameters $\hat{\Theta}$ of the model, given the data $X$. In a formal way:</p>
$$P(\Theta|X) = \frac{P(X|\Theta) \cdot P(\Theta)}{P(X)}$$<ul>
<li>$P(X|\Theta)$ is the <strong>likelihood</strong>, or probability that the observed data would happen given the set of parameters.</li>
<li>$P(\Theta)$ is the <strong>prior probability</strong> of a model.</li>
<li>$P(X)$ is the probability (or <strong>evidence</strong>) of a given data. It can be also called normalizing constant since it assures that the posterior probability function sums up to one.</li>
<li>$P(\Theta|X)$ is the <strong>posterior probability</strong> of the hypothesis given the observed data.</li>
</ul>
<p>It is difficult (or even impossible) to find the exact value of $P(X)$, that&rsquo;s why the equation above is simplified to the following equation:</p>
$$P(\Theta|X) \propto P(X|\Theta) \cdot P(\Theta)$$<p>Over the last decays, several algorithms have been developed to draw samples from the posterior distribution based on this equation. In particular, <code>rstan</code> package uses <a href="https://en.wikipedia.org/wiki/Hamiltonian_Monte_Carlo" target="_blank" rel="noopener">Hamiltonian Monte Carlo</a> algorithm, which is a part of a <a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" target="_blank" rel="noopener">Markov chain Monte Carlo</a> family of algorithms.</p>
<p>Also, as the name of the package suggests, <code>hBayesDM</code> uses the <a href="https://en.wikipedia.org/wiki/Bayesian_hierarchical_modeling" target="_blank" rel="noopener">hierarchical Bayesian approach</a> to fit the models. In our case, this means that each subject will have a unique set of parameters $\Theta$, or in other words, we allow the within-subject variation.</p>
<p>The benefit of <code>hBayesDM</code> is that there is a <a href="http://ccs-lab.github.io/hBayesDM/reference/index.html" target="_blank" rel="noopener">big variety of models</a> predefined for different paradigms, so we don&rsquo;t have to write them from scratch. Stan files with the model specifications can be found <a href="https://github.com/CCS-Lab/hBayesDM/tree/develop/commons/stan_files" target="_blank" rel="noopener">here</a>.</p>
<p>Let us fit the model introduced by Seymour et al. (2012) with the help of <code>bandit4arm_4par</code> function. Note, that we are going to fit the model separately for control and treatment groups since at the end we are interested in parameters comparison between the groups.</p>
<p>Based on the <a href="https://github.com/CCS-Lab/hBayesDM/blob/develop/commons/stan_files/bandit4arm_4par.stan" target="_blank" rel="noopener">model specification</a>, that&rsquo;s how the model structure looks like:</p>
<p><img src="hba.png"></img></p>
<ul>
<li>$m$, $\sigma$ - hyperparameters of the model that will affect the parameters $ \left \{ \alpha^{\text{reward}}, \alpha^{\text{punishment}}, R, P \right \}$ for each subject;</li>
<li>$S$ - number of subjects;</li>
<li>$y$ - choice data.</li>
</ul>
<p>Priors:</p>
$$\mu \sim \mathcal{N} (\mu = 0, \sigma=1)$$$$\sigma \sim \mathcal{N} (\mu = 0, \sigma=0.2)$$$$\alpha^{\text{reward}}_{\text{prior}} \sim \mathcal{N} (\mu = 0, \sigma=1)$$$$\alpha^{\text{punishment}}_{\text{prior}} \sim \mathcal{N} (\mu = 0, \sigma=1)$$$$R_{\text{prior}} \sim \mathcal{N} (\mu = 0, \sigma=1)$$$$P_{\text{prior}} \sim \mathcal{N} (\mu = 0, \sigma=1)$$<p>Transformation of parameters:</p>
$$\alpha^{\text{reward}} = \Phi (\mu + \sigma \alpha^{\text{reward}}_{\text{prior}}) $$$$\alpha^{\text{punishment}} = \Phi (\mu + \sigma \alpha^{\text{punishment}}_{\text{prior}}) $$$$R = \Phi (\mu + \sigma R_{\text{prior}}) \cdot 30 $$$$P = \Phi (\mu + \sigma P_{\text{prior}}) \cdot 30$$<p>$\Phi(\cdot)$ is the standard normal cumulative distribution function, which can take any value in a $ \left [ 0, 1 \right ]$ range. By multiplying $R$ and $P$ by $30$ we allow sensitivity values to be in a $ \left [ 0, 30 \right ]$ range.</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># model fit</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span><span style="color:#737994;font-style:italic"># control group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>output_ctr <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_4par</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Control&#34;</span>), <span style="color:#737994;font-style:italic"># subset of the data</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, <span style="color:#737994;font-style:italic"># amount of total itirations</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>  nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, <span style="color:#737994;font-style:italic"># amount of initial itirations. </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>  <span style="color:#737994;font-style:italic"># warmup trials will not be included in the final model</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>  nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>, <span style="color:#737994;font-style:italic"># amount of Markov chains</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>, <span style="color:#737994;font-style:italic"># amount machine&#39;s cores to use</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>  inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span> <span style="color:#737994;font-style:italic"># include simulated posterior data</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span><span style="color:#737994;font-style:italic"># treatment group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>output_trt <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_4par</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Treatment&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>, inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span></code></pre></div><h2 id="model-diagnostics">Model Diagnostics</h2>
<p>Once the models have been fitted it is important to check for convergence of MCMC algorithm. In a simple way, one could check it visually. According to the <code>hBayesDM</code> recommendations, the plot of chains&rsquo; values should look like &ldquo;furry caterpillars&rdquo;. In a bit more technical terms, we want to check whether values are centered around a stationary point without any change of pattern (e.g., increase of mean).</p>
<p><strong>Control (CTR) Group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">plot</span>(output_ctr, type <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;trace&#34;</span>, inc_warmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span></code></pre></div><p><img src="output_ctr.png"></img></p>
<p><strong>Treatment (TRT) Group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">plot</span>(output_trt, type <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;trace&#34;</span>, inc_warmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span></code></pre></div><p><img src="output_trt.png"></img></p>
<p>Note, that these plots show the chain values for parameters&rsquo; posterior distribution for the <strong>group</strong>, not the individual posterior distributions.</p>
<p>Another approach for a convergence check is the <a href="https://mc-stan.org/rstan/reference/Rhat.html" target="_blank" rel="noopener">R-hat</a> metric that compares the between- and within-chain estimates for model parameters (Vehtari et al., 2019<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>). The good value of $\hat{R}$ is considered to be under 1.05.</p>
<p><strong>CTR Group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">rhat</span>(output_ctr, less <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1.01</span>)
</span></span></code></pre></div><pre><code># TRUE: All Rhat values are less than 1.01
</code></pre>
<p><strong>TRT Group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">rhat</span>(output_trt, less <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1.01</span>)
</span></span></code></pre></div><pre><code># TRUE: All Rhat values are less than 1.01
</code></pre>
<p>As we can see, our model seems to converge for both of the groups.</p>
<h2 id="model-comparison">Model Comparison</h2>
<p>As discussed in part 1, it is always a good strategy to compare several models, since, as we know, all models are wrong. <code>hBayesDM</code> package makes model comparison really easy.</p>
<p>For simplicity we will add two models for comparison:</p>
<p><code>bandit4arm_lapse</code>: model with 4 parameters ($\alpha^{\text{reward}}$, $\alpha^{\text{punishment}}$, $R$, $P$) and noise ($\epsilon$).</p>
<p><strong>Model algorithm:</strong></p>
<ul>
<li><strong>for</strong> <em>each step $t$ in episode</em> <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)_t \leftarrow Q(a_j)^{\text{reward}}_t + Q(a_j)^{\text{punishment}}_t$</li>
<li>Select action $a_t$ using softmax policy $\scriptsize P(a_j = a_t) = \frac{e^{Q_j}}{\sum_{j}e^{Q_j}} \left( (1- \epsilon) + \frac{\epsilon}{J} \right) $</li>
<li>Observe reward $r_t$ and punishment $p_t$ values</li>
<li><strong>for</strong> <em>each action $a_j$ in possible actions</em> <strong>do</strong>
<ul>
<li><strong>if</strong> $a_j$ == $a_t$ <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} - Q(a_j)^{\text{reward}}_t + \alpha^{\text{reward}} \left( R \cdot r_t - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha^{\text{punishment}} \left( P \cdot p_t - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>else</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} \leftarrow Q(a_j)^{\text{reward}}_t + \alpha^{\text{reward}} \left( - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha^{\text{punishment}} \left( - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
<p><code>bandit4arm_singleA_lapse</code>: model with the single learning rate for both reward and punishment ($\alpha$) and noise.</p>
<p><strong>Model algorithm:</strong></p>
<ul>
<li><strong>for</strong> <em>each step $t$ in episode</em> <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)_t \leftarrow Q(a_j)^{\text{reward}}_t + Q(a_j)^{\text{punishment}}_t$</li>
<li>Select action $a_t$ using softmax policy $\scriptsize P(a_j = a_t) = \frac{e^{Q_j}}{\sum_{j}e^{Q_j}} \left( (1- \epsilon) + \frac{\epsilon}{J} \right) $</li>
<li>Observe reward $r_t$ and punishment $p_t$ values</li>
<li><strong>for</strong> <em>each action $a_j$ in possible actions</em> <strong>do</strong>
<ul>
<li><strong>if</strong> $a_j$ == $a_t$ <strong>do</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} - Q(a_j)^{\text{reward}}_t + \alpha \left( R \cdot r_t - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha \left( P \cdot p_t - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>else</strong>
<ul>
<li>$\scriptsize Q(a_j)^{\text{reward}}_{t+1} \leftarrow Q(a_j)^{\text{reward}}_t + \alpha \left( - Q(a_j)^{\text{reward}}_t \right)$</li>
<li>$\scriptsize Q(a_j)^{\text{punishment}}_{t+1} \leftarrow Q(a_j)^{\text{punishment}}_t + \alpha \left( - Q(a_j)^{\text{punishment}}_t \right)$</li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
</li>
<li><strong>end</strong></li>
</ul>
<p>Leave-one-out cross-validation information criterion (LOOIC) can be used for model selection (Vehtari et al., 2017<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>). The lower the value, the better the fit.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># control group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span><span style="color:#737994;font-style:italic"># model with noise</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>output_ctr_lapse <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_lapse</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Control&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>, inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span><span style="color:#737994;font-style:italic"># model with single learning rate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>output_ctr_singleA <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_singleA_lapse</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Control&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">2</span>, inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span><span style="color:#737994;font-style:italic"># treatment group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span><span style="color:#737994;font-style:italic"># model with noise</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>output_trt_lapse <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_lapse</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Treatment&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">3</span>, inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span><span style="color:#737994;font-style:italic"># model with single learning rate</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>output_trt_singleA <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bandit4arm_singleA_lapse</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>  data <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">filter</span>(agent_data, group <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#a6d189">&#34;Treatment&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>  niter <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4000</span>, nwarmup <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">1000</span>, nchain <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">4</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>  ncore <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">3</span>, inc_postpred <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># compare models for CTR group</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">printFit</span>(output_ctr, output_ctr_lapse, output_ctr_singleA, ic <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;looic&#34;</span>) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>df <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>  <span style="color:#8caaee">kable</span>(caption <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Model comparison for CTR group&#34;</span>) <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>  <span style="color:#8caaee">kable_classic_2</span>() <span style="color:#99d1db;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>  <span style="color:#8caaee">row_spec</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>    <span style="color:#8caaee">which</span>(df<span style="color:#99d1db;font-weight:bold">$</span>LOOIC <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#8caaee">min</span>(df<span style="color:#99d1db;font-weight:bold">$</span>LOOIC)), bold <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">T</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>    background <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;#d6f5d6&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span><span style="color:#737994;font-style:italic"># compare models for TRT group  </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">printFit</span>(output_trt, output_trt_lapse, output_trt_singleA, ic <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;looic&#34;</span>) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>df <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>  <span style="color:#8caaee">kable</span>(caption <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Model comparison for TRT group&#34;</span>) <span style="color:#99d1db;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>  <span style="color:#8caaee">kable_classic_2</span>() <span style="color:#99d1db;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>  <span style="color:#8caaee">row_spec</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>    <span style="color:#8caaee">which</span>(df<span style="color:#99d1db;font-weight:bold">$</span>LOOIC <span style="color:#99d1db;font-weight:bold">==</span> <span style="color:#8caaee">min</span>(df<span style="color:#99d1db;font-weight:bold">$</span>LOOIC)), bold <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#99d1db">T</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>    background <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;#d6f5d6&#34;</span>)
</span></span></code></pre></div></p>
</details>
<br>
<table class=" lightable-classic-2" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-14">Table 2: </span>Model comparison for CTR group
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
LOOIC
</th>
<th style="text-align:right;">
LOOIC Weights
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d6f5d6 !important;">
bandit4arm_4par
</td>
<td style="text-align:right;font-weight: bold;background-color: #d6f5d6 !important;">
3292.845
</td>
<td style="text-align:right;font-weight: bold;background-color: #d6f5d6 !important;">
0.5553943
</td>
</tr>
<tr>
<td style="text-align:left;">
bandit4arm_lapse
</td>
<td style="text-align:right;">
3295.377
</td>
<td style="text-align:right;">
0.1565749
</td>
</tr>
<tr>
<td style="text-align:left;">
bandit4arm_singleA_lapse
</td>
<td style="text-align:right;">
3294.158
</td>
<td style="text-align:right;">
0.2880308
</td>
</tr>
</tbody>
</table>
<table class=" lightable-classic-2" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-16">Table 3: </span>Model comparison for TRT group
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
LOOIC
</th>
<th style="text-align:right;">
LOOIC Weights
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d6f5d6 !important;">
bandit4arm_4par
</td>
<td style="text-align:right;font-weight: bold;background-color: #d6f5d6 !important;">
4261.820
</td>
<td style="text-align:right;font-weight: bold;background-color: #d6f5d6 !important;">
0.8337282
</td>
</tr>
<tr>
<td style="text-align:left;">
bandit4arm_lapse
</td>
<td style="text-align:right;">
4265.067
</td>
<td style="text-align:right;">
0.1644656
</td>
</tr>
<tr>
<td style="text-align:left;">
bandit4arm_singleA_lapse
</td>
<td style="text-align:right;">
4274.090
</td>
<td style="text-align:right;">
0.0018062
</td>
</tr>
</tbody>
</table>
<p><code>bandit4arm_4par</code> model showed the best results for both of the groups, so we can stick to it.</p>
<p>If the model with the single learning rate (<code>bandit4arm_singleA_lapse</code>) showed better performance, <s>that would be a bummer</s>, we wouldn&rsquo;t be able to answer our research questions and that would indicate that our initial hypothesis was not framed correctly (perhaps there is no competition between positive and negative feedback).</p>
<h2 id="model-validation">Model Validation</h2>
<p>As we did in part 1, we should also validate that model can recapture the actual behavior. You may have noticed that we had the argument <code>inc_postpred = TRUE</code> for all the model fitting functions. This included the predicted data for choice values for each of the chains. It is also called posterior predictive checks (PPC).</p>
<p>The plots below represent the actual choice data and the average of predicted values from all chains.</p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span><span style="color:#737994;font-style:italic"># code source: https://ccs-lab.github.io/hBayesDM/articles/getting_started.html#7-posterior-predictive-checks</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>y_pred_mean <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">apply</span>(output_ctr<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>y_pred, <span style="color:#8caaee">c</span>(<span style="color:#ef9f76">2</span>,<span style="color:#ef9f76">3</span>), mean)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>numSubjs <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">dim</span>(output_ctr<span style="color:#99d1db;font-weight:bold">$</span>allIndPars)[1]  <span style="color:#737994;font-style:italic"># number of subjects</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>subjList <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">unique</span>(output_ctr<span style="color:#99d1db;font-weight:bold">$</span>rawdata<span style="color:#99d1db;font-weight:bold">$</span>subjID)  <span style="color:#737994;font-style:italic"># list of subject IDs</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>maxT <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">mean</span>(<span style="color:#8caaee">table</span>(output_ctr<span style="color:#99d1db;font-weight:bold">$</span>rawdata<span style="color:#99d1db;font-weight:bold">$</span>subjID))  <span style="color:#737994;font-style:italic"># maximum number of trials</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>true_y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">array</span>(<span style="color:#ef9f76">NA</span>, <span style="color:#8caaee">c</span>(numSubjs, maxT)) <span style="color:#737994;font-style:italic"># true data (`true_y`)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span><span style="color:#737994;font-style:italic">## true data for each subject</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span><span style="color:#ca9ee6">for</span> (i <span style="color:#ca9ee6">in</span> <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span>numSubjs) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>  tmpID <span style="color:#99d1db;font-weight:bold">=</span> subjList[i]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>  tmpData <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">subset</span>(output_ctr<span style="color:#99d1db;font-weight:bold">$</span>rawdata, subjID <span style="color:#99d1db;font-weight:bold">==</span> tmpID)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>  true_y[i, ] <span style="color:#99d1db;font-weight:bold">=</span> tmpData<span style="color:#99d1db;font-weight:bold">$</span>choice  <span style="color:#737994;font-style:italic"># only for data with a &#39;choice&#39; column</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span>df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">data.frame</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span><span style="color:#ca9ee6">for</span> (i <span style="color:#ca9ee6">in</span> <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span>numSubjs) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>  choice <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(true_y[i, ], y_pred_mean[i, ])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>  type <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(<span style="color:#8caaee">rep</span>(<span style="color:#a6d189">&#34;True&#34;</span>, <span style="color:#ef9f76">200</span>), <span style="color:#8caaee">rep</span>(<span style="color:#a6d189">&#34;PPC&#34;</span>, <span style="color:#ef9f76">200</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>  trial <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span><span style="color:#ef9f76">200</span>, <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span><span style="color:#ef9f76">200</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>  subjID <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">rep</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#a6d189">&#34;Subject &#34;</span>, subjList[i]), <span style="color:#ef9f76">400</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>  temp_df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">data.frame</span>(subjID, trial, choice, type)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>  df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bind_rows</span>(df, temp_df)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span><span style="color:#8caaee">ggplot</span>(data <span style="color:#99d1db;font-weight:bold">=</span> df, <span style="color:#8caaee">aes</span>(x <span style="color:#99d1db;font-weight:bold">=</span> trial, y <span style="color:#99d1db;font-weight:bold">=</span> choice, color <span style="color:#99d1db;font-weight:bold">=</span> type)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>  <span style="color:#8caaee">geom_line</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>  <span style="color:#8caaee">facet_wrap</span>(<span style="color:#99d1db;font-weight:bold">~</span>subjID, nrow <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">5</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>  <span style="color:#8caaee">labs</span>(title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Model Validation&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>       subtitle <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;CTR Group&#34;</span>)
</span></span></code></pre></div></p>
</details>
<p><img src="valid_ctr.png"></img></p>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 1</span><span>y_pred_mean <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">apply</span>(output_trt<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>y_pred, <span style="color:#8caaee">c</span>(<span style="color:#ef9f76">2</span>,<span style="color:#ef9f76">3</span>), mean)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 3</span><span>numSubjs <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">dim</span>(output_trt<span style="color:#99d1db;font-weight:bold">$</span>allIndPars)[1]  <span style="color:#737994;font-style:italic"># number of subjects</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 5</span><span>subjList <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">unique</span>(output_trt<span style="color:#99d1db;font-weight:bold">$</span>rawdata<span style="color:#99d1db;font-weight:bold">$</span>subjID)  <span style="color:#737994;font-style:italic"># list of subject IDs</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 6</span><span>maxT <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">mean</span>(<span style="color:#8caaee">table</span>(output_trt<span style="color:#99d1db;font-weight:bold">$</span>rawdata<span style="color:#99d1db;font-weight:bold">$</span>subjID))  <span style="color:#737994;font-style:italic"># maximum number of trials</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 7</span><span>true_y <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">array</span>(<span style="color:#ef9f76">NA</span>, <span style="color:#8caaee">c</span>(numSubjs, maxT)) <span style="color:#737994;font-style:italic"># true data (`true_y`)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7"> 9</span><span><span style="color:#737994;font-style:italic">## true data for each subject</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">10</span><span><span style="color:#ca9ee6">for</span> (i <span style="color:#ca9ee6">in</span> <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span>numSubjs) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">11</span><span>  tmpID <span style="color:#99d1db;font-weight:bold">=</span> subjList[i]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">12</span><span>  tmpData <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">subset</span>(output_trt<span style="color:#99d1db;font-weight:bold">$</span>rawdata, subjID <span style="color:#99d1db;font-weight:bold">==</span> tmpID)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">13</span><span>  true_y[i, ] <span style="color:#99d1db;font-weight:bold">=</span> tmpData<span style="color:#99d1db;font-weight:bold">$</span>choice  <span style="color:#737994;font-style:italic"># only for data with a &#39;choice&#39; column</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">14</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">16</span><span>df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">data.frame</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">17</span><span><span style="color:#ca9ee6">for</span> (i <span style="color:#ca9ee6">in</span> <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span>numSubjs) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">18</span><span>  choice <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(true_y[i, ], y_pred_mean[i, ])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">19</span><span>  type <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(<span style="color:#8caaee">rep</span>(<span style="color:#a6d189">&#34;True&#34;</span>, <span style="color:#ef9f76">200</span>), <span style="color:#8caaee">rep</span>(<span style="color:#a6d189">&#34;PPC&#34;</span>, <span style="color:#ef9f76">200</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">20</span><span>  trial <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">c</span>(<span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span><span style="color:#ef9f76">200</span>, <span style="color:#ef9f76">1</span><span style="color:#99d1db;font-weight:bold">:</span><span style="color:#ef9f76">200</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">21</span><span>  subjID <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">rep</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#a6d189">&#34;Subject &#34;</span>, subjList[i]), <span style="color:#ef9f76">400</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">22</span><span>  temp_df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">data.frame</span>(subjID, trial, choice, type)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">23</span><span>  df <span style="color:#99d1db;font-weight:bold">&lt;-</span> <span style="color:#8caaee">bind_rows</span>(df, temp_df)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">24</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">27</span><span><span style="color:#8caaee">ggplot</span>(data <span style="color:#99d1db;font-weight:bold">=</span> df, <span style="color:#8caaee">aes</span>(x <span style="color:#99d1db;font-weight:bold">=</span> trial, y <span style="color:#99d1db;font-weight:bold">=</span> choice, color <span style="color:#99d1db;font-weight:bold">=</span> type)) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">28</span><span>  <span style="color:#8caaee">geom_line</span>() <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">29</span><span>  <span style="color:#8caaee">facet_wrap</span>(<span style="color:#99d1db;font-weight:bold">~</span>subjID, nrow <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#ef9f76">5</span>) <span style="color:#99d1db;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">30</span><span>  <span style="color:#8caaee">labs</span>(title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Model Validation&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">31</span><span>       subtitle <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;TRT Group&#34;</span>)
</span></span></code></pre></div></p>
</details>
<p><img src="valid_trt.png"></img></p>
<p>Since PPC represent the average value, the values are not exactly in a $[1, 2, 3, 4 ]$ set. However, we can see that trend of the PPC line follows the line of actual selected values pretty accurately.</p>
<h2 id="groups-comparison">Groups Comparison</h2>
<p>Now we can proceed to the most interesting part for us, which is the comparison of the parameter values between two groups. In the Bayesian framework, we work with the whole distribution of posterior distribution of the parameters, not just the point estimates (PE). Here is how the group posterior distributions look like:</p>
<p><strong>CTR group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">plot</span>(output_ctr)
</span></span></code></pre></div><p><img src="params_ctr.png"></img></p>
<p><strong>TRT group</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">plot</span>(output_trt)
</span></span></code></pre></div><p><img src="params_trt.png"></img></p>
<p>To compare the parameters we will look at the <strong>difference</strong> between posterior distributions (CTR - TRT). If the proportion of values in the difference distribution is much higher (or much less) than $\approx 0.5$, then the difference between the groups is credible. You can think about this in a way that if there was no effect of the treatment, then on average difference values would be centered around 0 and if not, then values would be much different than 0. We can also use the highest density interval (HDI) to address the uncertainty of the values.</p>
<h3 id="learning-rate-reward">Learning Rate (Reward)</h3>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>post_diff <span style="color:#99d1db;font-weight:bold">&lt;-</span> output_ctr<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_Arew <span style="color:#99d1db;font-weight:bold">-</span> output_trt<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_Arew
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#8caaee">plotHDI</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>  post_diff, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>  Title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Difference in posterior distributions (CTR - TRT)&#34;</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>  xLab <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(alpha[rew_diff]))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">print</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#8caaee">round</span>(<span style="color:#8caaee">mean</span>(post_diff <span style="color:#99d1db;font-weight:bold">&gt;</span> <span style="color:#ef9f76">0</span>) <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">100</span>, <span style="color:#ef9f76">1</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>             <span style="color:#a6d189">&#34;% of difference values are greater than 0.&#34;</span>))
</span></span></code></pre></div></p>
</details>
<p><img src="a_rew_diff.png" width="500"></img></p>
<p>95% HDI: Lower bound = 0.1357, Upper bound = 0.3025.</p>
<p>100% of difference values are greater than 0.</p>
<h3 id="learning-rate-punishment">Learning Rate (Punishment)</h3>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>post_diff <span style="color:#99d1db;font-weight:bold">&lt;-</span> output_ctr<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_Apun <span style="color:#99d1db;font-weight:bold">-</span> output_trt<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_Apun
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#8caaee">plotHDI</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>  post_diff, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>  Title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Difference in posterior distributions (CTR - TRT)&#34;</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>  xLab <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(alpha[pun_diff]))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">print</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#8caaee">round</span>(<span style="color:#8caaee">mean</span>(post_diff <span style="color:#99d1db;font-weight:bold">&gt;</span> <span style="color:#ef9f76">0</span>) <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">100</span>, <span style="color:#ef9f76">1</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>             <span style="color:#a6d189">&#34;% of difference values are greater than 0.&#34;</span>))
</span></span></code></pre></div></p>
</details>
<p><img src="a_pun_diff.png" width="500"></img></p>
<p>95% HDI: Lower bound = -0.1, Upper bound = 0.1408.</p>
<p>64.7% of difference values are greater than 0.</p>
<h3 id="reward-sensitivity">Reward Sensitivity</h3>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>post_diff <span style="color:#99d1db;font-weight:bold">&lt;-</span> output_ctr<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_R <span style="color:#99d1db;font-weight:bold">-</span> output_trt<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_R
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#8caaee">plotHDI</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>  post_diff, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>  Title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Difference in posterior distributions (CTR - TRT)&#34;</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>  xLab <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(R[diff]))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">print</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#8caaee">round</span>(<span style="color:#8caaee">mean</span>(post_diff <span style="color:#99d1db;font-weight:bold">&gt;</span> <span style="color:#ef9f76">0</span>) <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">100</span>, <span style="color:#ef9f76">1</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>             <span style="color:#a6d189">&#34;% of difference values are greater than 0.&#34;</span>))
</span></span></code></pre></div></p>
</details>
<p><img src="R_diff.png" width="500"></img></p>
<p>95% HDI: Lower bound = 1e-04, Upper bound = 1.8635.</p>
<p>97.1% of difference values are greater than 0.</p>
<h3 id="punishment-sensitivity">Punishment Sensitivity</h3>
<details><summary><b><font color="#ff6969">Code</font></b></summary>
<p>
<div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span>post_diff <span style="color:#99d1db;font-weight:bold">&lt;-</span> output_ctr<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_P <span style="color:#99d1db;font-weight:bold">-</span> output_trt<span style="color:#99d1db;font-weight:bold">$</span>parVals<span style="color:#99d1db;font-weight:bold">$</span>mu_P
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span><span style="color:#8caaee">plotHDI</span>(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">3</span><span>  post_diff, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">4</span><span>  Title <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#a6d189">&#34;Difference in posterior distributions (CTR - TRT)&#34;</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">5</span><span>  xLab <span style="color:#99d1db;font-weight:bold">=</span> <span style="color:#8caaee">expression</span>(P[diff]))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#c6d0f5;background-color:#303446;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">1</span><span><span style="color:#8caaee">print</span>(<span style="color:#8caaee">paste0</span>(<span style="color:#8caaee">round</span>(<span style="color:#8caaee">mean</span>(post_diff <span style="color:#99d1db;font-weight:bold">&gt;</span> <span style="color:#ef9f76">0</span>) <span style="color:#99d1db;font-weight:bold">*</span> <span style="color:#ef9f76">100</span>, <span style="color:#ef9f76">1</span>), 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#838ba7">2</span><span>             <span style="color:#a6d189">&#34;% of difference values are greater than 0.&#34;</span>))
</span></span></code></pre></div></p>
</details>
<p><img src="P_diff.png" width="500"></img></p>
<p>95% HDI: Lower bound = -2.4309, Upper bound = 1.0696.</p>
<p>22.4% of difference values are greater than 0.</p>
<p>As we can see, BA showed that there is a difference between the learning rate for positive feedback and reward sensitivity. One could argue that punishment sensitivity values also differ.</p>
<h2 id="summary-and-comparison">Summary and Comparison</h2>
<p>The downside of the BA is that it is more computationally demanding. We haven&rsquo;t spent too much time on the coding, mostly due to the help of the package, but the model fitting procedure itself can be time-consuming, depending on the computational power.</p>
<p>Another possible difficulty of BA is priors specifications. Ideally, we want to have an approximate idea of how the parameter values are distributed (based on literature, for example) and then check whether the experimental data support this hypothesis.</p>
<p>Overall MLE and BA lead to somewhat similar results. In both cases, we were able to make a conclusion that treatment affects humans’ reward sensitivity and the learning rate for a positive outcome (although for MLE approach p-value for reward sensitivity was a bit higher than 0.05).</p>
<table>
<caption>
<span id="tab:unnamed-chunk-16">Table 4: </span>Results comparison between the methods
</caption>
<thead>
<tr>
<th style="text-align:center">Parameter</th>
<th style="text-align:center">MLE</th>
<th style="text-align:center">BA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$\alpha^\text{reward}$</td>
<td style="text-align:center">PE = 0.2, 95% CI = [0.1, 0.3],<br>p-val &lt; 0.01, Effect size = 1.87</td>
<td style="text-align:center">PE = 0.22, 95% HDI = [0.15, 0.3]</td>
</tr>
<tr>
<td style="text-align:center">$\alpha^\text{punishment}$</td>
<td style="text-align:center">PE = 0.09, 95% CI = [-0.1, 0.12],<br>p-val = 0.87, Effect size = 0.08</td>
<td style="text-align:center">PE = 0.02, 95% HDI = [-0.1, 0.14]</td>
</tr>
<tr>
<td style="text-align:center">$R$</td>
<td style="text-align:center">PE = 0.87, 95% CI = [-0.05, 1.79],<br>p-val = 0.06, Effect size = 0.89</td>
<td style="text-align:center">PE = 0.91, 95% HDI = [0.01, 1.86]</td>
</tr>
<tr>
<td style="text-align:center">$P$</td>
<td style="text-align:center">PE = -0.46, 95% CI = [-1.77, 0.84],<br>p-val = 0.46, Effect size = 0.34</td>
<td style="text-align:center">PE = -0.67, 95% HDI = [-2.43, 1.07]</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<i></i>
</td>
</tr>
</tfoot>
</table>
<p>As it was mentioned at the very beginning of part 1, the purpose of these posts was to give an example of the model fitting, not to select the best approach. Both MLE and BA have their pros and cons and readers are encouraged to make their own decision which approach suits better. Readers can also visit <a href="https://ccs-lab.github.io/hBayesDM/articles/index.html" target="_blank" rel="noopener">hBayesDM articles</a> for more examples.</p>
<h2 id="references">References</h2>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Seymour, B., Daw, N. D., Roiser, J. P., Dayan, P., &amp; Dolan, R. (2012). Serotonin selectively modulates reward value in human decision-making. <em>The Journal of neuroscience : the official journal of the Society for Neuroscience, 32</em>(17), 5833–5842. <a href="https://doi.org/10.1523/JNEUROSCI.0053-12.2012" target="_blank" rel="noopener">https://doi.org/10.1523/JNEUROSCI.0053-12.2012</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Ahn, W. Y., Haines, N., &amp; Zhang, L. (2017). Revealing Neurocomputational Mechanisms of Reinforcement Learning and Decision-Making With the hBayesDM Package. <em>Computational Psychiatry, 1</em>(0), 24. <a href="https://doi.org/10.1162/cpsy_a_00002" target="_blank" rel="noopener">https://doi.org/10.1162/cpsy_a_00002</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Stan Development Team (2020). “RStan: the R interface to Stan.” R package version 2.21.2, <a href="http://mc-stan.org/" target="_blank" rel="noopener">http://mc-stan.org/</a>.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A., &amp; Rubin, D.B. (2013). Bayesian Data Analysis (3rd ed.). Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b16018" target="_blank" rel="noopener">https://doi.org/10.1201/b16018</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P. C. (2021). Rank-Normalization, Folding, and Localization: An Improved R-hat for Assessing Convergence of MCMC (with Discussion). <em>Bayesian Analysis, 16</em>(2). <a href="https://doi.org/10.1214/20-ba1221" target="_blank" rel="noopener">https://doi.org/10.1214/20-ba1221</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>Vehtari, A., Gelman, A., &amp; Gabry, J. (2016). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. <em>Statistics and Computing, 27</em>(5), 1413–1432. <a href="https://doi.org/10.1007/s11222-016-9696-4" target="_blank" rel="noopener">https://doi.org/10.1007/s11222-016-9696-4</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

      </div>

      
  <time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime="2021-11-13T00:00:00.000Z">
    <span>Last updated on</span>
    Nov 13, 2021</time>

      <div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5">
        
        <div class="max-w-prose print:hidden">
  
  

  

<div class="flex justify-center">
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/neuroscience/">Neuroscience</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/reinforcement-learning/">Reinforcement Learning</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/computational-modeling/">Computational Modeling</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/bayesian-inference/">Bayesian Inference</a>
  
  <a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href="/tags/r/">R</a>
  
</div>


  
<section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt2%2F&amp;text=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;2"
    title="X"
    aria-label="X"
    id="share-link-x"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt2%2F&amp;t=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;2"
    title="Facebook"
    aria-label="Facebook"
    id="share-link-facebook"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
  </a>
  

  
  
  
  
  
  
    
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="mailto:?subject=Computational%20Models%20of%20Behavior%2C%20part%202&amp;body=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt2%2F"
    title="Email"
    aria-label="Email"
    id="share-link-email"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt2%2F&amp;title=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;2"
    title="LinkedIn"
    aria-label="LinkedIn"
    id="share-link-linkedin"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
  </a>
  

  
  
  
  
  
  
  <a
    target="_blank" rel="noopener"
    class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
    href="whatsapp://send?text=Computational&#43;Models&#43;of&#43;Behavior%2C&#43;part&#43;2%20http%3A%2F%2Flocalhost%3A4321%2Ftutorial%2Fcomputational-models-of-behavior-pt2%2F"
    title="WhatsApp"
    aria-label="WhatsApp"
    id="share-link-whatsapp"
  >
    <svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><path d="m187.58 144.84-32-16a8 8 0 0 0-8 .5l-14.69 9.8a40.55 40.55 0 0 1-16-16l9.8-14.69a8 8 0 0 0 .5-8l-16-32A8 8 0 0 0 104 64a40 40 0 0 0-40 40 88.1 88.1 0 0 0 88 88 40 40 0 0 0 40-40 8 8 0 0 0-4.42-7.16ZM152 176a72.08 72.08 0 0 1-72-72 24 24 0 0 1 19.29-23.54l11.48 23L101 118a8 8 0 0 0-.73 7.51 56.47 56.47 0 0 0 30.15 30.15A8 8 0 0 0 138 155l14.61-9.74 23 11.48A24 24 0 0 1 152 176ZM128 24a104 104 0 0 0-91.82 152.88l-11.35 34.05a16 16 0 0 0 20.24 20.24l34.05-11.35A104 104 0 1 0 128 24Zm0 192a87.87 87.87 0 0 1-44.06-11.81 8 8 0 0 0-6.54-.67L40 216l12.47-37.4a8 8 0 0 0-.66-6.54A88 88 0 1 1 128 216Z"/></svg>
  </a>
  
</section>


  








  
  
    



  
  
  
    
  
  
  

<div class="flex pt-12 pb-4">
  
  
  <img
    class="mr-4 h-24 w-24 rounded-full"
    width="96"
    height="96"
    alt="Ruslan Klymentiev"
  src="/author/ruslan-klymentiev/avatar_hu14015720463236890778.png"
  loading="lazy"
  />
  
  <div class="place-self-center">
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Authors
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      <a href="http://localhost:4321/" class="no-underline">
      Ruslan Klymentiev
      </a>
    </div>

    
    <div class="text-sm font-bold text-neutral-700 dark:text-neutral-300">
    Data-something-scientist
    </div>
    


    

    <div class="text-2xl sm:text-lg pt-1">

      
<div class="flex flex-wrap text-neutral-500 dark:text-neutral-300">
  
    
    
    
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="mailto:rklymentiev@gmail.com"
      
      aria-label="At-Symbol"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://github.com/rklymentiev"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Github"
    ><svg style="height: 1em;" fill="currentColor" viewBox="3 3 18 18"><path d="M12 3C7.0275 3 3 7.12937 3 12.2276C3 16.3109 5.57625 19.7597 9.15374 20.9824C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441C9.77249 20.3249 9.76125 19.5982 9.76125 18.8254C7.5 19.2522 6.915 18.2602 6.735 17.7412C6.63375 17.4759 6.19499 16.6569 5.8125 16.4378C5.4975 16.2647 5.0475 15.838 5.80124 15.8264C6.51 15.8149 7.01625 16.4954 7.18499 16.7723C7.99499 18.1679 9.28875 17.7758 9.80625 17.5335C9.885 16.9337 10.1212 16.53 10.38 16.2993C8.3775 16.0687 6.285 15.2728 6.285 11.7432C6.285 10.7397 6.63375 9.9092 7.20749 9.26326C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794C7.2975 6.81794 8.05125 6.57571 9.77249 7.76377C10.4925 7.55615 11.2575 7.45234 12.0225 7.45234C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377C15.9937 6.56418 16.7475 6.81794 16.7475 6.81794C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326C17.4113 9.9092 17.76 10.7281 17.76 11.7432C17.76 15.2843 15.6563 16.0687 13.6537 16.2993C13.98 16.5877 14.2613 17.1414 14.2613 18.0065C14.2613 19.2407 14.25 20.2326 14.25 20.5441C14.25 20.7863 14.4188 21.0746 14.8688 20.9824C16.6554 20.364 18.2079 19.1866 19.3078 17.6162C20.4077 16.0457 20.9995 14.1611 21 12.2276C21 7.12937 16.9725 3 12 3Z"></path></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://scholar.google.com/citations?user=prQO0zEAAAAJ"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Google-Scholar"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M343.759 106.662V79.43L363.524 64h-213.89L20.476 176.274h85.656a82.339 82.339 0 0 0-.219 6.225c0 20.845 7.22 38.087 21.672 51.861c14.453 13.797 32.252 20.648 53.327 20.648c4.923 0 9.75-.368 14.438-1.024c-2.907 6.5-4.374 12.523-4.374 18.142c0 9.875 4.499 20.43 13.467 31.642c-39.234 2.67-68.061 9.732-86.437 21.163c-10.531 6.5-19 14.704-25.39 24.531c-6.391 9.9-9.578 20.515-9.578 31.962c0 9.648 2.062 18.336 6.219 26.062c4.156 7.726 9.578 14.07 16.312 18.984c6.718 4.968 14.469 9.101 23.219 12.469c8.734 3.344 17.406 5.718 26.061 7.062A167.052 167.052 0 0 0 180.555 448c13.469 0 26.953-1.734 40.547-5.187c13.562-3.485 26.28-8.642 38.171-15.493c11.86-6.805 21.515-16.086 28.922-27.718c7.39-11.68 11.094-24.805 11.094-39.336c0-11.016-2.25-21.039-6.75-30.14c-4.468-9.073-9.938-16.542-16.452-22.345c-6.501-5.813-13-11.155-19.516-15.968c-6.5-4.845-12-9.75-16.468-14.813c-4.485-5.046-6.735-10.054-6.735-14.984c0-4.921 1.734-9.672 5.216-14.265c3.455-4.61 7.674-9.048 12.61-13.306c4.937-4.25 9.875-8.968 14.796-14.133c4.922-5.147 9.141-11.827 12.61-20.008c3.485-8.18 5.203-17.445 5.203-27.757c0-13.453-2.547-24.46-7.547-33.314c-.594-1.022-1.218-1.803-1.875-3.022l56.907-46.672v17.119c-7.393.93-6.624 5.345-6.624 10.635V245.96c0 5.958 4.875 10.834 10.834 10.834h3.989c5.958 0 10.833-4.875 10.833-10.834V117.293c0-5.277.778-9.688-6.561-10.63zm-107.36 222.48c1.14.75 3.704 2.78 7.718 6.038c4.05 3.243 6.797 5.695 8.266 7.414a443.553 443.553 0 0 1 6.376 7.547c2.813 3.375 4.718 6.304 5.718 8.734c1 2.477 2.016 5.461 3.047 8.946a38.27 38.27 0 0 1 1.485 10.562c0 17.048-6.564 29.68-19.656 37.859c-13.125 8.18-28.767 12.274-46.938 12.274c-9.187 0-18.203-1.093-27.063-3.196c-8.843-2.116-17.311-5.336-25.39-9.601c-8.078-4.258-14.577-10.204-19.5-17.797c-4.938-7.64-7.407-16.415-7.407-26.25c0-10.32 2.797-19.29 8.422-26.906c5.594-7.625 12.938-13.391 22.032-17.315c9.063-3.946 18.25-6.742 27.562-8.398a157.865 157.865 0 0 1 28.438-2.555c4.47 0 7.936.25 10.405.696c.455.219 3.032 2.07 7.735 5.563c4.704 3.462 7.625 5.595 8.75 6.384zm-3.359-100.579c-7.406 8.86-17.734 13.288-30.953 13.288c-11.86 0-22.298-4.764-31.266-14.312c-9-9.523-15.422-20.328-19.344-32.43c-3.937-12.109-5.906-23.984-5.906-35.648c0-13.694 3.596-25.352 10.781-34.976c7.187-9.65 17.5-14.485 30.938-14.485c11.875 0 22.374 5.038 31.437 15.157c9.094 10.085 15.61 21.413 19.517 33.968c3.922 12.54 5.873 24.53 5.873 35.984c0 13.446-3.702 24.61-11.076 33.454z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://orcid.org/0000-0002-0907-0908"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Academicons/Orcid"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M336.62 194.538c-7.13-3.328-13.866-5.56-20.253-6.614c-6.365-1.095-16.574-1.612-30.71-1.612h-36.704v152.747h37.634c14.673 0 26.081-1.013 34.224-3.017c8.142-2.004 14.921-4.526 20.356-7.626a69.448 69.448 0 0 0 14.942-11.388c14.488-14.714 21.742-33.273 21.742-55.717c0-22.052-7.44-40.052-22.341-53.982c-5.498-5.166-11.822-9.444-18.89-12.793zM256 8C119.022 8 8 119.042 8 256s111.022 248 248 248s248-111.042 248-248S392.978 8 256 8Zm-82.336 357.513h-29.389V160.148h29.389zM158.95 138.696c-11.14 0-20.213-9.01-20.213-20.212c0-11.118 9.052-20.191 20.213-20.191c11.18 0 20.232 9.052 20.232 20.191a20.194 20.194 0 0 1-20.232 20.212zm241.386 163.597c-5.29 12.545-12.834 23.581-22.65 33.088c-9.982 9.837-21.597 17.194-34.844 22.196c-7.75 3.017-14.839 5.063-21.307 6.117c-6.49 1.013-18.828 1.509-37.076 1.509h-64.956V160.148h69.233c27.962 0 50.034 4.154 66.32 12.545c16.265 8.37 29.181 20.728 38.792 36.972c9.61 16.265 14.425 34.018 14.425 53.196c.023 13.765-2.666 26.908-7.936 39.432z"/></svg></a>
  
    
    
    
    
      
    
    <a
      class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
      style="will-change:transform;"
      href="https://www.instagram.com/rklymentiev/"
      target="_blank" rel="noopener" rel="me noopener noreferrer"
      aria-label="Brands/Instagram"
    ><svg style="height: 1em;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15"><path fill="currentColor" fill-rule="evenodd" d="M12.91 12.909c.326-.327.582-.72.749-1.151c.16-.414.27-.886.302-1.578c.032-.693.04-.915.04-2.68c0-1.765-.008-1.987-.04-2.68c-.032-.692-.142-1.164-.302-1.578a3.185 3.185 0 0 0-.75-1.151a3.187 3.187 0 0 0-1.151-.75c-.414-.16-.886-.27-1.578-.302C9.487 1.007 9.265 1 7.5 1c-1.765 0-1.987.007-2.68.04c-.692.03-1.164.14-1.578.301a3.2 3.2 0 0 0-1.151.75a3.2 3.2 0 0 0-.75 1.151c-.16.414-.27.886-.302 1.578C1.007 5.513 1 5.735 1 7.5c0 1.765.007 1.987.04 2.68c.03.692.14 1.164.301 1.578c.164.434.42.826.75 1.151c.325.33.718.586 1.151.75c.414.16.886.27 1.578.302c.693.031.915.039 2.68.039c1.765 0 1.987-.008 2.68-.04c.692-.03 1.164-.14 1.578-.301a3.323 3.323 0 0 0 1.151-.75ZM2 6.735v1.53c-.002.821-.002 1.034.02 1.5c.026.586.058 1.016.156 1.34c.094.312.199.63.543 1.012c.344.383.675.556 1.097.684c.423.127.954.154 1.415.175c.522.024.73.024 1.826.024H8.24c.842.001 1.054.002 1.526-.02c.585-.027 1.015-.059 1.34-.156c.311-.094.629-.2 1.011-.543c.383-.344.556-.676.684-1.098c.127-.422.155-.953.176-1.414C13 9.247 13 9.04 13 7.947v-.89c0-1.096 0-1.303-.023-1.826c-.021-.461-.049-.992-.176-1.414c-.127-.423-.3-.754-.684-1.098c-.383-.344-.7-.449-1.011-.543c-.325-.097-.755-.13-1.34-.156A27.29 27.29 0 0 0 8.24 2H7.057c-1.096 0-1.304 0-1.826.023c-.461.021-.992.049-1.415.176c-.422.128-.753.301-1.097.684c-.344.383-.45.7-.543 1.012c-.098.324-.13.754-.156 1.34c-.022.466-.022.679-.02 1.5ZM7.5 5.25a2.25 2.25 0 1 0 0 4.5a2.25 2.25 0 0 0 0-4.5ZM4.25 7.5a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0Zm6.72-2.72a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"/></svg></a>
  
</div>



    </div>
  </div>
</div>



  




  
  
    
    
    
      
      
    
<div class="pt-1 no-prose w-full">
  <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
  <div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2">
    <div class="">
      
        <a class="group flex no-underline" href="/tutorial/python_for_ds/">
          <span
            class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline rtl:hidden">&larr;</span></span>
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Python for Data Science (in Russian)</span>
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Jun 1, 2022
              
            </span>
          </span>
        </a>
      
    </div>
    <div class="">
      
        <a class="group flex text-right no-underline" href="/tutorial/computational-models-of-behavior-pt1/">
          <span class="flex flex-col">
            <span
              class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
            >Computational Models of Behavior, part 1</span
            >
            <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
              
                Oct 25, 2021
              
            </span>
          </span>
          <span
            class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
          ><span class="ltr:inline">&rarr;</span></span>
        </a>
      
    </div>
  </div>
</div>



  


  



</div>

      </div>

    </main>
  </article>
</div>

    </div>
    <div class="page-footer">
      <footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200">

  












  
  
  
  
  














  
  
  

  
  
  
    
  

  

  
  <p class="powered-by text-center">
    © 2024. This work is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by text-center">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>

</footer>

    </div>

    
    











  </body>
</html>
